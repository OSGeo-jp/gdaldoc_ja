<!DOCTYPE html>
<html class="writer-html5" lang="ja" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Compiling the C# bindings - CMake Scripts &mdash; GDAL  ドキュメント</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d10597a4" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/gdal.css?v=e152ac3b" />

  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="canonical" href="https://gdal.org/api/csharp/csharp_compile_cmake.html"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=c033477b"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/translations.js?v=4dbe4bdc"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="このドキュメントについて" href="../../about.html" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="検索" href="../../search.html" />
    <link rel="next" title="C# Raster Interface" href="csharp_raster.html" />
    <link rel="prev" title="Compiling the C# bindings - Legacy Scripts" href="csharp_compile_legacy.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/gdalicon.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../download.html">ダウンロード</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../programs/index.html">プログラム</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../drivers/raster/index.html">ラスタードライバー</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../drivers/vector/index.html">ベクタードライバー</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">ユーザー</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">チュートリアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">開発</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">コミュニティ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sponsors/index.html">スポンサー</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">どのように貢献できますか?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">ライセンス</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GDAL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html"> GDAL  ドキュメント </a> &raquo;</li>
      
          <li><a href="../index.html">API</a> &raquo;</li>
      
          <li><a href="index.html">C# bindings</a> &raquo;</li>
      
      <li>Compiling the C# bindings - CMake Scripts</li>
    

    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/OSGeo/gdal/edit/master/doc/source/api/csharp/csharp_compile_cmake.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="csharp_raster.html" class="btn btn-neutral float-right" title="C# Raster Interface" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="csharp_compile_legacy.html" class="btn btn-neutral float-left" title="Compiling the C# bindings - Legacy Scripts" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="compiling-the-c-bindings-cmake-scripts">
<span id="csharp-compile-cmake"></span><h1>Compiling the C# bindings - CMake Scripts<a class="headerlink" href="#compiling-the-c-bindings-cmake-scripts" title="Link to this heading"></a></h1>
<p>This page describes the primary steps when creating the GDAL/OGR C# binaries from the source using the new CMake scripts.</p>
<p>In most cases this is not necessary and it is better to use one of the pre-compiled sources, such as <a class="reference external" href="https://gisinternals.com/">GisInternals</a> or Conda.</p>
<p>You can either build the bindings as part of a full GDAL build - or standalone on top of an existing installation.</p>
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading"></a></h2>
<p>The build environment has the following dependencies:</p>
<ul class="simple">
<li><p>CMake 3.10 or later</p></li>
<li><p>the appropriate C++ build environment (i.e. gcc or Visual Studio etc).</p></li>
<li><p>SWIG 4</p></li>
<li><p>.NET 5.0 or Mono</p></li>
</ul>
</section>
<section id="net-build-toolchain">
<h2>.NET Build Toolchain<a class="headerlink" href="#net-build-toolchain" title="Link to this heading"></a></h2>
<p>The build scripts can use either .NET 5.0 and  <code class="file docutils literal notranslate"><span class="pre">dotnet.exe</span></code> or Mono and <code class="file docutils literal notranslate"><span class="pre">msc.exe</span></code> to compile the bindings.</p>
<p>.NET is used for preference if it found on all platforms but the use of Mono can be forced using a command line variable.</p>
</section>
<section id="building-as-part-of-a-gdal-build">
<h2>Building as part of a GDAL Build<a class="headerlink" href="#building-as-part-of-a-gdal-build" title="Link to this heading"></a></h2>
<p>The build environment uses the following variables:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>CSHARP_MONO</p></td>
<td><p>Boolean</p></td>
<td><p>Forces the use of Mono</p></td>
</tr>
<tr class="row-even"><td><p>CSHARP_LIBRARY_VERSION</p></td>
<td><p>String</p></td>
<td><p>Set the .NET version for the shared libraries</p></td>
</tr>
<tr class="row-odd"><td><p>CSHARP_APPLICATION_VERSION</p></td>
<td><p>String</p></td>
<td><p>Set the .NET version for the sample apps</p></td>
</tr>
<tr class="row-even"><td><p>GDAL_CSHARP_ONLY</p></td>
<td><p>Boolean</p></td>
<td><p>Build standalone on GDAL binaries</p></td>
</tr>
<tr class="row-odd"><td><p>BUILD_CSHARP_BINDINGS</p></td>
<td><p>Boolean</p></td>
<td><p>Build the C# bindings DEFAULT ON</p></td>
</tr>
</tbody>
</table>
<section id="building-with-net">
<h3>Building with .NET<a class="headerlink" href="#building-with-net" title="Link to this heading"></a></h3>
<p>If the build environment has .NET 5.0 installed and GDAL is built, then the c# bindings will be built using .NET by default.</p>
<p>The details of building GDAL are documented elsewhere, but there are likely to be variants of the following commands run from the root directory of the gdal repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_INSTALL_PREFIX</span> <span class="o">../</span><span class="n">install</span> <span class="o">-</span><span class="n">B</span> <span class="o">../</span><span class="n">build</span> <span class="o">-</span><span class="n">S</span> <span class="o">.</span>
<span class="n">cmake</span> <span class="o">--</span><span class="n">build</span> <span class="o">../</span><span class="n">build</span> <span class="o">--</span><span class="n">config</span> <span class="n">Release</span>
<span class="n">cmake</span> <span class="o">--</span><span class="n">build</span> <span class="o">../</span><span class="n">build</span> <span class="o">--</span><span class="n">config</span> <span class="n">Release</span> <span class="o">--</span><span class="n">target</span> <span class="n">install</span>
</pre></div>
</div>
<p>The C# bindings and sample apps are installed in the install directory (in the above case that would be <cite>../install</cite>, in the <cite>share/csharp</cite> sub folder. There would be the following files:</p>
<ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">gdal_csharp.dll</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">ogr_csharp.dll</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">osr_csharp.dll</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">gdalconst_csharp.dll</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">gdal_wrap.dll</span></code> or <code class="file docutils literal notranslate"><span class="pre">libgdal_wrap.so</span></code> or <code class="file docutils literal notranslate"><span class="pre">libgdal_wrap.dylib</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">ogr_wrap.dll</span></code> or <code class="file docutils literal notranslate"><span class="pre">libogr_wrap.so</span></code> or <code class="file docutils literal notranslate"><span class="pre">libogr_wrap.dylib</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">osr_wrap.dll</span></code> or <code class="file docutils literal notranslate"><span class="pre">libosr_wrap.so</span></code> or <code class="file docutils literal notranslate"><span class="pre">libosr_wrap.dylib</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">osr_wrap.dll</span></code> or <code class="file docutils literal notranslate"><span class="pre">libosr_wrap.so</span></code> or <code class="file docutils literal notranslate"><span class="pre">libosr_wrap.dylib</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">gdalconst_wrap.dll</span></code> or <code class="file docutils literal notranslate"><span class="pre">libgdalconst_wrap.so</span></code> or <code class="file docutils literal notranslate"><span class="pre">libgdalconst_wrap.dylib</span></code></p></li>
<li><p>various sample applications - as *.exe on Windows, or just as * on Unix, along with *.dll for each app and the runtime config files.</p></li>
</ul>
<p>There are also subdirectories for each of the sample apps, holding the config files.</p>
<p>There are also the following NuGET packages:</p>
<ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">OSGeo.GDAL</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">OSGeo.OGR</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">OSgeo.OSR</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">OSGeo.GDAL.CONST</span></code></p></li>
<li><p>various sample application</p></li>
</ul>
</section>
<section id="using-the-net-bindings">
<h3>Using the .NET Bindings<a class="headerlink" href="#using-the-net-bindings" title="Link to this heading"></a></h3>
<p>The easiest way to use the bindings in development would be use the NuGET packages created.</p>
<p>To do this you need to add a local repistory pointing to the GDAL install directory. <a class="reference external" href="https://docs.microsoft.com/en-us/nuget/hosting-packages/local-feeds">This is explained here</a> .</p>
<p>Once this is done, you add the GDAL packages into your project as normal.</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>These packages only install the bindings and do not install core GDAL. It is for you as the developer to make sure that the GDAL binaries are available in the search path.</p>
</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>The NuGET packages are created with the same version number as the version of GDAL in the build system.
If you are building in a GIT repository, then the build system automatically makes the version with a x.y.z-dev pre-release tag.
This means that to load the package into Visual Studio (for instance), you have to tick the pre-release box.
This is all intentional and not a bug.</p>
</div>
</section>
<section id="building-on-mono">
<h3>Building on Mono<a class="headerlink" href="#building-on-mono" title="Link to this heading"></a></h3>
<p>If the build environment does not have .NET 5.0 or msbuild installed and GDAL is built, then the c# bindings will be built using Mono by default. Mono building can also be forced
by setting CSHARP_MONO.</p>
<p>The details of building GDAL are documented elsewhere, but the there are likely to be variants of the following commands run from the root directory of the gdal repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_INSTALL_PREFIX</span> <span class="o">../</span><span class="n">install</span> <span class="o">-</span><span class="n">DCSHARP_MONO</span><span class="o">=</span><span class="n">ON</span> <span class="o">-</span><span class="n">B</span> <span class="o">../</span><span class="n">build</span> <span class="o">-</span><span class="n">S</span> <span class="o">.</span>
<span class="n">cmake</span> <span class="o">--</span><span class="n">build</span> <span class="o">../</span><span class="n">build</span> <span class="o">--</span><span class="n">config</span> <span class="n">Release</span>
<span class="n">cmake</span> <span class="o">--</span><span class="n">build</span> <span class="o">../</span><span class="n">build</span> <span class="o">--</span><span class="n">config</span> <span class="n">Release</span> <span class="o">--</span><span class="n">target</span> <span class="n">install</span>
</pre></div>
</div>
<p>The C# bindings and sample apps are installed in the install directory (in the above case that would be <cite>../install</cite>, in the <cite>share/csharp</cite> sub folder. There would be the following files:</p>
<ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">gdal_csharp.dll</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">ogr_csharp.dll</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">osr_csharp.dll</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">gdalconst_csharp.dll</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">gdal_wrap.dll</span></code> or <code class="file docutils literal notranslate"><span class="pre">libgdal_wrap.so</span></code> or <code class="file docutils literal notranslate"><span class="pre">libgdal_wrap.dylib</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">ogr_wrap.dll</span></code> or <code class="file docutils literal notranslate"><span class="pre">libogr_wrap.so</span></code> or <code class="file docutils literal notranslate"><span class="pre">libogr_wrap.dylib</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">osr_wrap.dll</span></code> or <code class="file docutils literal notranslate"><span class="pre">libosr_wrap.so</span></code> or <code class="file docutils literal notranslate"><span class="pre">libosr_wrap.dylib</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">osr_wrap.dll</span></code> or <code class="file docutils literal notranslate"><span class="pre">libosr_wrap.so</span></code> or <code class="file docutils literal notranslate"><span class="pre">libosr_wrap.dylib</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">gdalconst_wrap.dll</span></code> or <code class="file docutils literal notranslate"><span class="pre">libgdalconst_wrap.so</span></code> or <code class="file docutils literal notranslate"><span class="pre">libgdalconst_wrap.dylib</span></code></p></li>
<li><p>various sample applications as *.exe on all platforms.</p></li>
</ul>
</section>
<section id="using-the-mono-bindings">
<h3>Using the Mono Bindings<a class="headerlink" href="#using-the-mono-bindings" title="Link to this heading"></a></h3>
<p>Note that the bindings created by this process will only work with Mono.</p>
<p>To run one of the prebuilt executables - you can run them with Mono as follows :</p>
<p><strong class="program">mono GDALInfo.exe</strong></p>
<p>Both the managed libraries (i.e. the DLLs) and the unmanaged libraries must be available to Mono.
This is in more detail in <a class="reference external" href="https://www.mono-project.com/docs/advanced/pinvoke/">the Mono documentation</a></p>
</section>
</section>
<section id="building-standalone">
<h2>Building Standalone<a class="headerlink" href="#building-standalone" title="Link to this heading"></a></h2>
<p>The Bindings using both the .NET or Mono toolchains can be build on top of an existing implementation of GDAL
that includes the include files and libs - for instance the Conda distribution.</p>
<p>To do this, Cmake must be run with the GDAL_CSHARP_ONLY flag set and only one of the following targets should be built:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>csharp_binding</p></td>
<td><p>Just the bindings</p></td>
</tr>
<tr class="row-even"><td><p>csharp_samples</p></td>
<td><p>The bindings and the sample apps</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>Do not build the install target when running standalone, it will fail!</p>
</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>Do not run a bare ctest command on this build, it will likely fail! Use something like <cite>ctest -R &quot;^csharp.*&quot;</cite> instead.</p>
</div>
<p>As an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">-</span><span class="n">DGDAL_CSHARP_ONLY</span><span class="o">=</span><span class="n">ON</span> <span class="o">-</span><span class="n">B</span> <span class="o">../</span><span class="n">build</span> <span class="o">-</span><span class="n">S</span> <span class="o">.</span>
<span class="n">cmake</span> <span class="o">--</span><span class="n">build</span> <span class="o">../</span><span class="n">build</span> <span class="o">--</span><span class="n">config</span> <span class="n">Release</span> <span class="o">--</span><span class="n">target</span> <span class="n">csharp_samples</span>
</pre></div>
</div>
<p>The output from this build is axactly the same as documented as above, except that the outputs will be in <cite>../build/swig/csharp</cite> and some of the sub folders.</p>
</section>
<section id="signing-of-build-artifacts">
<h2>Signing of build artifacts<a class="headerlink" href="#signing-of-build-artifacts" title="Link to this heading"></a></h2>
<p>The CSharp assemblies are strong name signed by default with the provided key file in <a class="reference external" href="https://github.com/OSGeo/gdal/blob/master/swig/csharp/gdal.snk">gdal.snk</a>.
If authenticode signing of the assemblies is wished, it should be done in a post-build
manual step, for example with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">signtool</span> <span class="n">sign</span> <span class="o">/</span><span class="n">f</span> <span class="s2">&quot;path</span><span class="se">\t</span><span class="s2">o\your\certificate.pfx&quot;</span> <span class="o">/</span><span class="n">p</span> <span class="s2">&quot;password&quot;</span> <span class="o">/</span><span class="n">tr</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">timestamp</span><span class="o">.</span><span class="n">digicert</span><span class="o">.</span><span class="n">com</span> <span class="o">/</span><span class="n">td</span> <span class="n">sha256</span> <span class="s2">&quot;path</span><span class="se">\t</span><span class="s2">o\your\gdal_csharp.dll&quot;</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="csharp_raster.html" class="btn btn-neutral float-right" title="C# Raster Interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="csharp_compile_legacy.html" class="btn btn-neutral float-left" title="Compiling the C# bindings - Legacy Scripts" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <div class="info">
      <a class="logo-link" href="https://osgeo.org">
        <div class="osgeo-logo"></div>
      </a>
      <div class="copyright">
      

      &copy; 1998-2024 <a href="https://github.com/warmerdam">Frank Warmerdam</a>,
      <a href="https://github.com/rouault">Even Rouault</a>, and
      <a href="https://github.com/OSGeo/gdal/graphs/contributors">others</a>


      
      </div>
    </div>
  </div>
</footer>
        </div>
      </div>
    </section>
  </div>
  
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>