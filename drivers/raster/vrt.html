<!DOCTYPE html>
<html class="writer-html5" lang="ja" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VRT -- GDAL Virtual Format &mdash; GDAL  ドキュメント</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d10597a4" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/gdal.css?v=e152ac3b" />

  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="canonical" href="https://gdal.org/drivers/raster/vrt.html"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=c033477b"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/translations.js?v=4dbe4bdc"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="このドキュメントについて" href="../../about.html" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="検索" href="../../search.html" />
    <link rel="next" title="Multidimensional VRT" href="vrt_multidimensional.html" />
    <link rel="prev" title="VICAR -- VICAR" href="vicar.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/gdalicon.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../download.html">ダウンロード</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../programs/index.html">プログラム</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ラスタードライバー</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="aaigrid.html">AAIGrid -- Arc/Info ASCII Grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="ace2.html">ACE2 -- ACE2</a></li>
<li class="toctree-l2"><a class="reference internal" href="adrg.html">ADRG -- ADRG/ARC Digitized Raster Graphics (.gen/.thf)</a></li>
<li class="toctree-l2"><a class="reference internal" href="aig.html">AIG -- Arc/Info Binary Grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="airsar.html">AIRSAR -- AIRSAR Polarimetric Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="bag.html">BAG -- Bathymetry Attributed Grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="basisu.html">BASISU -- Basis Universal</a></li>
<li class="toctree-l2"><a class="reference internal" href="blx.html">BLX -- Magellan BLX Topo File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="bmp.html">BMP -- Microsoft Windows Device Independent Bitmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="bsb.html">BSB -- Maptech/NOAA BSB Nautical Chart Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="bt.html">BT -- VTP .bt Binary Terrain Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="byn.html">BYN - Natural Resources Canada's Geoid file format (.byn)</a></li>
<li class="toctree-l2"><a class="reference internal" href="cad.html">CAD -- AutoCAD DWG raster layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="cals.html">CALS -- CALS Type 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="ceos.html">CEOS -- CEOS Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="coasp.html">COASP --  DRDC COASP SAR Processor Raster</a></li>
<li class="toctree-l2"><a class="reference internal" href="cog.html">COG -- Cloud Optimized GeoTIFF generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="cosar.html">COSAR -- TerraSAR-X Complex SAR Data Product</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpg.html">CPG -- Convair PolGASP data</a></li>
<li class="toctree-l2"><a class="reference internal" href="ctable2.html">CTable2 -- CTable2 Datum Grid Shift</a></li>
<li class="toctree-l2"><a class="reference internal" href="ctg.html">CTG -- USGS LULC Composite Theme Grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="daas.html">DAAS (Airbus DS Intelligence Data As A Service driver)</a></li>
<li class="toctree-l2"><a class="reference internal" href="dds.html">DDS -- DirectDraw Surface</a></li>
<li class="toctree-l2"><a class="reference internal" href="derived.html">DERIVED -- Derived subdatasets driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="dimap.html">DIMAP -- Spot DIMAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="dipex.html">DIPEx -- ELAS DIPEx</a></li>
<li class="toctree-l2"><a class="reference internal" href="doq1.html">DOQ1 -- First Generation USGS DOQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="doq2.html">DOQ2 -- New Labelled USGS DOQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="dted.html">DTED -- Military Elevation Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="ecrgtoc.html">ECRGTOC -- ECRG Table Of Contents (TOC.xml)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ecw.html">ECW -- Enhanced Compressed Wavelets (.ecw)</a></li>
<li class="toctree-l2"><a class="reference internal" href="eedai.html">EEDAI - Google Earth Engine Data API Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="ehdr.html">EHdr -- ESRI .hdr Labelled</a></li>
<li class="toctree-l2"><a class="reference internal" href="eir.html">EIR -- Erdas Imagine Raw</a></li>
<li class="toctree-l2"><a class="reference internal" href="elas.html">ELAS - Earth Resources Laboratory Applications Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="envi.html">ENVI -- ENVI .hdr Labelled Raster</a></li>
<li class="toctree-l2"><a class="reference internal" href="esat.html">ESAT -- Envisat Image Product</a></li>
<li class="toctree-l2"><a class="reference internal" href="esric.html">ESRIC -- Esri Compact Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="ers.html">ERS -- ERMapper .ERS</a></li>
<li class="toctree-l2"><a class="reference internal" href="exr.html">EXR -- Extended Dynamic Range Image File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="fast.html">FAST -- EOSAT FAST Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="fit.html">FIT -- FIT</a></li>
<li class="toctree-l2"><a class="reference internal" href="fits.html">FITS -- Flexible Image Transport System</a></li>
<li class="toctree-l2"><a class="reference internal" href="genbin.html">GenBin -- Generic Binary (.hdr labelled)</a></li>
<li class="toctree-l2"><a class="reference internal" href="georaster.html">Oracle Spatial GeoRaster</a></li>
<li class="toctree-l2"><a class="reference internal" href="gff.html">GFF -- Sandia National Laboratories GSAT File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="gif.html">GIF -- Graphics Interchange Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpkg.html">GPKG -- GeoPackage raster</a></li>
<li class="toctree-l2"><a class="reference internal" href="grass.html">GRASS Raster Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="grassasciigrid.html">GRASSASCIIGrid -- GRASS ASCII Grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="grib.html">GRIB -- WMO General Regularly-distributed Information in Binary form</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs7bg.html">GS7BG -- Golden Software Surfer 7 Binary Grid File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="gsag.html">GSAG -- Golden Software ASCII Grid File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="gsbg.html">GSBG -- Golden Software Binary Grid File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="gsc.html">GSC -- GSC Geogrid</a></li>
<li class="toctree-l2"><a class="reference internal" href="gta.html">GTA - Generic Tagged Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="gti.html">GTI -- GDAL Raster Tile Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="gtiff.html">GTiff -- GeoTIFF File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="gxf.html">GXF -- Grid eXchange File</a></li>
<li class="toctree-l2"><a class="reference internal" href="hdf4.html">HDF4 -- Hierarchical Data Format Release 4 (HDF4)</a></li>
<li class="toctree-l2"><a class="reference internal" href="hdf5.html">HDF5 -- Hierarchical Data Format Release 5 (HDF5)</a></li>
<li class="toctree-l2"><a class="reference internal" href="heif.html">HEIF / HEIC -- ISO/IEC 23008-12:2017 High Efficiency Image File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="hf2.html">HF2 -- HF2/HFZ heightfield raster</a></li>
<li class="toctree-l2"><a class="reference internal" href="hfa.html">HFA -- Erdas Imagine .img</a></li>
<li class="toctree-l2"><a class="reference internal" href="Idrisi.html">RST -- Idrisi Raster Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="ilwis.html">ILWIS -- Raster Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="iris.html">IRIS -- Vaisala's weather radar software format</a></li>
<li class="toctree-l2"><a class="reference internal" href="isce.html">ISCE -- ISCE</a></li>
<li class="toctree-l2"><a class="reference internal" href="isg.html">ISG -- International Service for the Geoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="isis2.html">ISIS2 -- USGS Astrogeology ISIS Cube (Version 2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="isis3.html">ISIS3 -- USGS Astrogeology ISIS Cube (Version 3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="jdem.html">JDEM -- Japanese DEM (.mem)</a></li>
<li class="toctree-l2"><a class="reference internal" href="jp2ecw.html">JP2ECW -- ERDAS JPEG2000 (.jp2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="jp2kak.html">JP2KAK -- JPEG 2000 (based on Kakadu SDK)</a></li>
<li class="toctree-l2"><a class="reference internal" href="jp2lura.html">JP2Lura -- JPEG2000 driver based on Lurawave library</a></li>
<li class="toctree-l2"><a class="reference internal" href="jp2mrsid.html">JP2MrSID -- JPEG2000 via MrSID SDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="jp2openjpeg.html">JP2OpenJPEG -- JPEG2000 driver based on OpenJPEG library</a></li>
<li class="toctree-l2"><a class="reference internal" href="jpeg.html">JPEG -- JPEG JFIF File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="jpegxl.html">JPEGXL -- JPEG-XL File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="jpipkak.html">JPIPKAK - JPIP Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="kea.html">KEA</a></li>
<li class="toctree-l2"><a class="reference internal" href="kmlsuperoverlay.html">KMLSuperoverlay -- KMLSuperoverlay</a></li>
<li class="toctree-l2"><a class="reference internal" href="kro.html">KRO -- KOLOR Raw format</a></li>
<li class="toctree-l2"><a class="reference internal" href="ktx2.html">KTX2</a></li>
<li class="toctree-l2"><a class="reference internal" href="lan.html">LAN -- Erdas 7.x .LAN and .GIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="l1b.html">L1B -- NOAA Polar Orbiter Level 1b Data Set (AVHRR)</a></li>
<li class="toctree-l2"><a class="reference internal" href="lcp.html">LCP -- FARSITE v.4 LCP Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="leveller.html">Leveller -- Daylon Leveller Heightfield</a></li>
<li class="toctree-l2"><a class="reference internal" href="loslas.html">LOSLAS -- NADCON .los/.las Datum Grid Shift</a></li>
<li class="toctree-l2"><a class="reference internal" href="map.html">MAP -- OziExplorer .MAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="marfa.html">MRF -- Meta Raster Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbtiles.html">MBTiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="mem.html">MEM -- In Memory Raster</a></li>
<li class="toctree-l2"><a class="reference internal" href="mff.html">MFF -- Vexcel MFF Raster</a></li>
<li class="toctree-l2"><a class="reference internal" href="mff2.html">MFF2 -- Vexcel MFF2 Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="mrsid.html">MrSID -- Multi-resolution Seamless Image Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="msg.html">MSG -- Meteosat Second Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="msgn.html">MSGN -- Meteosat Second Generation (MSG) Native Archive Format (.nat)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ndf.html">NDF -- NLAPS Data Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="netcdf.html">NetCDF: Network Common Data Form</a></li>
<li class="toctree-l2"><a class="reference internal" href="ngsgeoid.html">NGSGEOID - NOAA NGS Geoid Height Grids</a></li>
<li class="toctree-l2"><a class="reference internal" href="ngw.html">NGW -- NextGIS Web</a></li>
<li class="toctree-l2"><a class="reference internal" href="nitf.html">NITF -- National Imagery Transmission Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="noaa_b.html">NOAA_B -- NOAA GEOCON/NADCON5 .b format</a></li>
<li class="toctree-l2"><a class="reference internal" href="nsidcbin.html">NSIDCbin -- National Snow and Ice Data Centre Sea Ice Concentrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ntv2.html">NTv2 -- NTv2 Datum Grid Shift</a></li>
<li class="toctree-l2"><a class="reference internal" href="nwtgrd.html">NWT_GRD/NWT_GRC -- Northwood/Vertical Mapper File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="ogcapi.html">OGCAPI -- OGC API Tiles / Maps / Coverage</a></li>
<li class="toctree-l2"><a class="reference internal" href="openfilegdb.html">ESRI File Geodatabase raster (OpenFileGDB)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ozi.html">OZI -- OZF2/OZFX3 raster</a></li>
<li class="toctree-l2"><a class="reference internal" href="palsar.html">JAXA PALSAR Processed Products</a></li>
<li class="toctree-l2"><a class="reference internal" href="paux.html">PAux -- PCI .aux Labelled Raw Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="pcidsk.html">PCIDSK -- PCI Geomatics Database File</a></li>
<li class="toctree-l2"><a class="reference internal" href="pcraster.html">PCRaster -- PCRaster raster file format</a></li>
<li class="toctree-l2"><a class="reference internal" href="pdf.html">PDF -- Geospatial PDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="pds.html">PDS -- Planetary Data System v3</a></li>
<li class="toctree-l2"><a class="reference internal" href="pds4.html">PDS4 -- NASA Planetary Data System (Version 4)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plmosaic.html">PLMosaic (Planet Labs Mosaics API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="png.html">PNG -- Portable Network Graphics</a></li>
<li class="toctree-l2"><a class="reference internal" href="pnm.html">PNM -- Netpbm (.pgm, .ppm)</a></li>
<li class="toctree-l2"><a class="reference internal" href="postgisraster.html">PostGISRaster -- PostGIS Raster driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="prf.html">PHOTOMOD Raster File</a></li>
<li class="toctree-l2"><a class="reference internal" href="rasterlite.html">Rasterlite - Rasters in SQLite DB</a></li>
<li class="toctree-l2"><a class="reference internal" href="rasterlite2.html">RasterLite2 - Rasters in SQLite DB</a></li>
<li class="toctree-l2"><a class="reference internal" href="r.html">R -- R Object Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="rdb.html">RDB - <em>RIEGL</em> Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="rik.html">RIK -- Swedish Grid Maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="rmf.html">RMF -- Raster Matrix Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="roi_pac.html">ROI_PAC -- ROI_PAC</a></li>
<li class="toctree-l2"><a class="reference internal" href="rpftoc.html">RPFTOC -- Raster Product Format/RPF (a.toc)</a></li>
<li class="toctree-l2"><a class="reference internal" href="rraster.html">RRASTER -- R Raster</a></li>
<li class="toctree-l2"><a class="reference internal" href="rs2.html">RS2 -- RadarSat 2 XML Product</a></li>
<li class="toctree-l2"><a class="reference internal" href="s102.html">S102 -- S-102 Bathymetric Surface Product</a></li>
<li class="toctree-l2"><a class="reference internal" href="s104.html">S104 -- S-104 Water Level Information for Surface Navigation Product</a></li>
<li class="toctree-l2"><a class="reference internal" href="s111.html">S111 -- S-111 Surface Currents Product</a></li>
<li class="toctree-l2"><a class="reference internal" href="safe.html">SAFE -- Sentinel-1 SAFE XML Product</a></li>
<li class="toctree-l2"><a class="reference internal" href="sar_ceos.html">SAR_CEOS -- CEOS SAR Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdat.html">SAGA -- SAGA GIS Binary Grid File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdts.html">SDTS -- USGS SDTS DEM</a></li>
<li class="toctree-l2"><a class="reference internal" href="sentinel2.html">SENTINEL2 -- Sentinel-2 Products</a></li>
<li class="toctree-l2"><a class="reference internal" href="sgi.html">SGI -- SGI Image Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="sigdem.html">SIGDEM -- Scaled Integer Gridded DEM</a></li>
<li class="toctree-l2"><a class="reference internal" href="snodas.html">SNODAS -- Snow Data Assimilation System</a></li>
<li class="toctree-l2"><a class="reference internal" href="srp.html">SRP -- Standard Product Format (ASRP/USRP) (.gen)</a></li>
<li class="toctree-l2"><a class="reference internal" href="srtmhgt.html">SRTMHGT -- SRTM HGT Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="stacit.html">STACIT - Spatio-Temporal Asset Catalog Items</a></li>
<li class="toctree-l2"><a class="reference internal" href="stacta.html">STACTA - Spatio-Temporal Asset Catalog Tiled Assets</a></li>
<li class="toctree-l2"><a class="reference internal" href="terragen.html">Terragen -- Terragen™ Terrain File</a></li>
<li class="toctree-l2"><a class="reference internal" href="tga.html">TGA -- TARGA Image File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="til.html">TIL -- EarthWatch/DigitalGlobe .TIL</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiledb.html">TileDB - TileDB raster</a></li>
<li class="toctree-l2"><a class="reference internal" href="tsx.html">TSX --  TerraSAR-X Product</a></li>
<li class="toctree-l2"><a class="reference internal" href="usgsdem.html">USGSDEM -- USGS ASCII DEM (and CDED)</a></li>
<li class="toctree-l2"><a class="reference internal" href="vicar.html">VICAR -- VICAR</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">VRT -- GDAL Virtual Format</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creation-options">Creation options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vrt-format">.vrt Format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vrtdataset">VRTDataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vrtrasterband">VRTRasterBand</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#overviews">Overviews</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vrt-descriptions-for-raw-files">.vrt Descriptions for Raw Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creation-of-vrt-datasets">Creation of VRT Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-derived-bands-with-pixel-functions-in-c-c">Using Derived Bands (with pixel functions in C/C++)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#default-pixel-functions">Default Pixel Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#writing-pixel-functions">Writing Pixel Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#using-derived-bands-with-pixel-functions-in-python">Using Derived Bands (with pixel functions in Python)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#python-module-path">Python module path</a></li>
<li class="toctree-l4"><a class="reference internal" href="#just-in-time-compilation">Just-in-time compilation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#warped-vrt">Warped VRT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pansharpened-vrt">Pansharpened VRT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multidimensional-vrt">Multidimensional VRT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="vrt_multidimensional.html">Multidimensional VRT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#processed-dataset-vrt">Processed dataset VRT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="vrt_processed_dataset.html">VRT processed dataset</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vrt-connection-string">vrt:// connection string</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multi-threading-optimizations">Multi-threading optimizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multi-threading-issues">Multi-threading issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="#performance-considerations">Performance considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#driver-capabilities">Driver capabilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="wcs.html">WCS -- OGC Web Coverage Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="webp.html">WEBP - WEBP</a></li>
<li class="toctree-l2"><a class="reference internal" href="wms.html">WMS -- Web Map Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="wmts.html">WMTS -- OGC Web Map Tile Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="xpm.html">XPM -- X11 Pixmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="xyz.html">XYZ -- ASCII Gridded XYZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="zarr.html">Zarr</a></li>
<li class="toctree-l2"><a class="reference internal" href="zmap.html">ZMap -- ZMap Plus Grid</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../vector/index.html">ベクタードライバー</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">ユーザー</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">チュートリアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">開発</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">コミュニティ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sponsors/index.html">スポンサー</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">貢献する方法は?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">ライセンス</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GDAL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html"> GDAL  ドキュメント </a> &raquo;</li>
      
          <li><a href="index.html">ラスタードライバー</a> &raquo;</li>
      
      <li>VRT -- GDAL Virtual Format</li>
    

    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/OSGeo/gdal/edit/master/doc/source/drivers/raster/vrt.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="vrt_multidimensional.html" class="btn btn-neutral float-right" title="Multidimensional VRT" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="vicar.html" class="btn btn-neutral float-left" title="VICAR -- VICAR" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="vrt-gdal-virtual-format">
<span id="raster-vrt"></span><h1>VRT -- GDAL Virtual Format<a class="headerlink" href="#vrt-gdal-virtual-format" title="Link to this heading"></a></h1>
<div class="admonition shortname" id="shortname-0">
<p class="admonition-title">Driver short name</p>
<p>VRT</p>
</div>
<div class="admonition built_in_by_default" id="built_in_by_default-0">
<p class="admonition-title">Driver built-in by default</p>
<p>This driver is built-in by default</p>
</div>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>The VRT driver is a format driver for GDAL that allows a virtual GDAL dataset
to be composed from other GDAL datasets with repositioning, and algorithms
potentially applied as well as various kinds of metadata altered or added.
VRT descriptions of datasets can be saved in an XML format normally given the
extension .vrt.</p>
<p>Note .vrt files starting with</p>
<ul class="simple">
<li><p>&lt;OGRVRTDataSource&gt; open with <a class="reference internal" href="../../programs/ogrinfo.html#ogrinfo"><span class="std std-ref">ogrinfo</span></a>, etc.</p></li>
<li><p>&lt;VRTDataset&gt; open with <a class="reference internal" href="../../programs/gdalinfo.html#gdalinfo"><span class="std std-ref">gdalinfo</span></a>, etc.</p></li>
</ul>
<p>The VRT format can also describe <a class="reference internal" href="#gdal-vrttut-warped"><span class="std std-ref">Warped VRT</span></a>
and <a class="reference internal" href="#gdal-vrttut-pansharpen"><span class="std std-ref">Pansharpened VRT</span></a></p>
<p>For mosaic with a very large number of tiles (tens of thousands or mores),
the <a class="reference internal" href="gti.html#raster-gti"><span class="std std-ref">GTI</span></a> driver may be used starting with GDAL 3.9.</p>
<p>An example of a simple .vrt file referring to a 512x512 dataset with one band
loaded from <code class="file docutils literal notranslate"><span class="pre">utm.tif</span></code> might look like this:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VRTDataset</span><span class="w"> </span><span class="na">rasterXSize=</span><span class="s">&quot;512&quot;</span><span class="w"> </span><span class="na">rasterYSize=</span><span class="s">&quot;512&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;GeoTransform&gt;</span>440720.0,<span class="w"> </span>60.0,<span class="w"> </span>0.0,<span class="w"> </span>3751320.0,<span class="w"> </span>0.0,<span class="w"> </span>-60.0<span class="nt">&lt;/GeoTransform&gt;</span>
<span class="w">    </span><span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;Byte&quot;</span><span class="w"> </span><span class="na">band=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ColorInterp&gt;</span>Gray<span class="nt">&lt;/ColorInterp&gt;</span>
<span class="w">        </span><span class="nt">&lt;SimpleSource&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>utm.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceBand&gt;</span>1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;SrcRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;512&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;512&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;DstRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;512&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;512&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SimpleSource&gt;</span>
<span class="w">    </span><span class="nt">&lt;/VRTRasterBand&gt;</span>
<span class="nt">&lt;/VRTDataset&gt;</span>
</pre></div>
</div>
<p>Many aspects of the VRT file are a direct XML encoding of the
<a class="reference internal" href="../../user/raster_data_model.html#raster-data-model"><span class="std std-ref">Raster Data Model</span></a> which should be reviewed
for understanding of the semantics of various elements.</p>
<p>VRT files can be produced by translating to VRT format.  The resulting file can
then be edited to modify mappings, add metadata or other purposes.  VRT files
can also be produced programmatically by various means.</p>
<p>This tutorial will cover the .vrt file format (suitable for users editing
.vrt files), and how .vrt files may be created and manipulated programmatically
for developers.</p>
</section>
<section id="creation-options">
<h2>Creation options<a class="headerlink" href="#creation-options" title="Link to this heading"></a></h2>
<p><a href="#id1"><span class="problematic" id="id2">|about-creation-options|</span></a>
The following creation options are supported:</p>
<ul class="simple">
<li><p id="drivers/raster/vrt-oo-BLOCKXSIZE"><strong>BLOCKXSIZE=value: </strong> (GDAL &gt;= 3.7) Sets block width.</p>
</li>
<li><p id="drivers/raster/vrt-oo-BLOCKYSIZE"><strong>BLOCKYSIZE=value: </strong> (GDAL &gt;= 3.7) Sets block height.<p>Setting explicitly the block size is an advanced setting that should only be
used when the user has determined that it is needed. By default the block size
is set to:</p>
<ul>
<li><p>128x128 for a source-based VRT raster band. Unless the VRT is made of a single
source and this single source is not subsetted, in which case the block size of
the unique source will be set as the VRT raster band block size)</p></li>
<li><p>512x128 for a warped VRT.</p></li>
</ul>
</p>
</li>
</ul>
</section>
<section id="vrt-format">
<h2>.vrt Format<a class="headerlink" href="#vrt-format" title="Link to this heading"></a></h2>
<p>A <a class="reference external" href="https://raw.githubusercontent.com/OSGeo/gdal/master/frmts/vrt/data/gdalvrt.xsd">XML schema of the GDAL VRT format</a>
is available.</p>
<p>Note, .vrt files starting with
- &lt;OGRVRTDataSource&gt; open with ogrinfo, etc.
- &lt;VRTDataset&gt; open with gdalinfo, etc.</p>
<p>Virtual files stored on disk are kept in an XML format with the following
elements.</p>
<p><strong>VRTDataset</strong>: This is the root element for the whole GDAL dataset. It must have the attributes rasterXSize and rasterYSize describing the width and height of the dataset in pixels. It may have a subClass attributes with values VRTWarpedDataset (<a class="reference internal" href="#gdal-vrttut-warped"><span class="std std-ref">Warped VRT</span></a>) or VRTPansharpenedDataset (<a class="reference internal" href="#gdal-vrttut-pansharpen"><span class="std std-ref">Pansharpened VRT</span></a>). It may have SRS, GeoTransform, GCPList, Metadata, MaskBand and VRTRasterBand subelements.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VRTDataset</span><span class="w"> </span><span class="na">rasterXSize=</span><span class="s">&quot;512&quot;</span><span class="w"> </span><span class="na">rasterYSize=</span><span class="s">&quot;512&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<section id="vrtdataset">
<h3>VRTDataset<a class="headerlink" href="#vrtdataset" title="Link to this heading"></a></h3>
<p>The allowed subelements for VRTDataset are :</p>
<ul class="simple">
<li><p><strong>SRS</strong>: This element contains the spatial reference system (coordinate system) in OGC WKT format.  Note that this must be appropriately escaped for XML, so items like quotes will have the ampersand escape sequences substituted. As well as WKT, valid input to the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">OGRSpatialReference::SetFromUserInput()</span></code> method (such as well known GEOGCS names, and PROJ.4 format) is also allowed in the SRS element.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;SRS</span><span class="w"> </span><span class="na">dataAxisToSRSAxisMapping=</span><span class="s">&quot;1,2&quot;</span><span class="nt">&gt;</span>PROJCS[<span class="ni">&amp;quot;</span>NAD27<span class="w"> </span>/<span class="w"> </span>UTM<span class="w"> </span>zone<span class="w"> </span>11N<span class="ni">&amp;quot;</span>,GEOGCS[<span class="ni">&amp;quot;</span>NAD27<span class="ni">&amp;quot;</span>,DATUM[<span class="ni">&amp;quot;</span>North_American_Datum_1927<span class="ni">&amp;quot;</span>,SPHEROID[<span class="ni">&amp;quot;</span>Clarke<span class="w"> </span>1866<span class="ni">&amp;quot;</span>,6378206.4,294.9786982139006,AUTHORITY[<span class="ni">&amp;quot;</span>EPSG<span class="ni">&amp;quot;</span>,<span class="ni">&amp;quot;</span>7008<span class="ni">&amp;quot;</span>]],AUTHORITY[<span class="ni">&amp;quot;</span>EPSG<span class="ni">&amp;quot;</span>,<span class="ni">&amp;quot;</span>6267<span class="ni">&amp;quot;</span>]],PRIMEM[<span class="ni">&amp;quot;</span>Greenwich<span class="ni">&amp;quot;</span>,0],UNIT[<span class="ni">&amp;quot;</span>degree<span class="ni">&amp;quot;</span>,0.0174532925199433],AUTHORITY[<span class="ni">&amp;quot;</span>EPSG<span class="ni">&amp;quot;</span>,<span class="ni">&amp;quot;</span>4267<span class="ni">&amp;quot;</span>]],PROJECTION[<span class="ni">&amp;quot;</span>Transverse_Mercator<span class="ni">&amp;quot;</span>],PARAMETER[<span class="ni">&amp;quot;</span>latitude_of_origin<span class="ni">&amp;quot;</span>,0],PARAMETER[<span class="ni">&amp;quot;</span>central_meridian<span class="ni">&amp;quot;</span>,-117],PARAMETER[<span class="ni">&amp;quot;</span>scale_factor<span class="ni">&amp;quot;</span>,0.9996],PARAMETER[<span class="ni">&amp;quot;</span>false_easting<span class="ni">&amp;quot;</span>,500000],PARAMETER[<span class="ni">&amp;quot;</span>false_northing<span class="ni">&amp;quot;</span>,0],UNIT[<span class="ni">&amp;quot;</span>metre<span class="ni">&amp;quot;</span>,1,AUTHORITY[<span class="ni">&amp;quot;</span>EPSG<span class="ni">&amp;quot;</span>,<span class="ni">&amp;quot;</span>9001<span class="ni">&amp;quot;</span>]],AUTHORITY[<span class="ni">&amp;quot;</span>EPSG<span class="ni">&amp;quot;</span>,<span class="ni">&amp;quot;</span>26711<span class="ni">&amp;quot;</span>]]<span class="nt">&lt;/SRS&gt;</span>
</pre></div>
</div>
<p>The <strong>dataAxisToSRSAxisMapping</strong> attribute is allowed since GDAL 3.0 to describe the relationship between the axis indicated in the CRS definition and the axis of the GeoTransform or GCP metadata. The value of the attribute is a comma separated list of integers. The number of elements of this list must be the number of axis of the CRS. Values start at 1. If m denotes the array values of this attribute, then m[0] is the data axis number for the first axis of the CRS. If the attribute is missing, then the OAMS_TRADITIONAL_GIS_ORDER data axis to CRS axis mapping strategy is implied.</p>
<ul class="simple">
<li><p><strong>GeoTransform</strong>: This element contains a six value affine geotransformation for the dataset, mapping between pixel/line coordinates and georeferenced coordinates. Typically (geotransform[0], geotransform[3]) will be the (easting, northing) of the upper-left corner of the raster, geotransform[1] the horizontal resolution in geospatial coordinates/pixel, and geotransform[5] the vertical resolution in geospatial coordinates/pixel, as a negative value if the image is north-up oriented. See <a class="reference internal" href="../../user/raster_data_model.html#raster-data-model-geotransform"><span class="std std-ref">Affine GeoTransform</span></a> for more details about that mapping.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;GeoTransform&gt;</span>440720.0,<span class="w">  </span>60,<span class="w">  </span>0.0,<span class="w">  </span>3751320.0,<span class="w">  </span>0.0,<span class="w"> </span>-60.0<span class="nt">&lt;/GeoTransform&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>GCPList</strong>: This element contains a list of Ground Control Points for the dataset, mapping between pixel/line coordinates and georeferenced coordinates. The Projection attribute should contain the SRS of the georeferenced coordinates in the same format as the SRS element. The dataAxisToSRSAxisMapping attribute is the same as in the SRS element.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;GCPList</span><span class="w"> </span><span class="na">Projection=</span><span class="s">&quot;EPSG:4326&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;GCP</span><span class="w"> </span><span class="na">Id=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">Info=</span><span class="s">&quot;a&quot;</span><span class="w"> </span><span class="na">Pixel=</span><span class="s">&quot;0.5&quot;</span><span class="w"> </span><span class="na">Line=</span><span class="s">&quot;0.5&quot;</span><span class="w"> </span><span class="na">X=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">Y=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">Z=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;GCP</span><span class="w"> </span><span class="na">Id=</span><span class="s">&quot;2&quot;</span><span class="w"> </span><span class="na">Info=</span><span class="s">&quot;b&quot;</span><span class="w"> </span><span class="na">Pixel=</span><span class="s">&quot;13.5&quot;</span><span class="w"> </span><span class="na">Line=</span><span class="s">&quot;23.5&quot;</span><span class="w"> </span><span class="na">X=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">Y=</span><span class="s">&quot;2.0&quot;</span><span class="w"> </span><span class="na">Z=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/GCPList&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Metadata</strong>: This element contains a list of metadata name/value pairs associated with the VRTDataset as a whole, or a VRTRasterBand. It has &lt;MDI&gt; (metadata item) subelements which have a &quot;key&quot; attribute and the value as the data of the element. The Metadata element can be repeated multiple times, in which case it must be accompanied with a &quot;domain&quot; attribute to indicate the name of the metadata domain.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Metadata&gt;</span>
<span class="w">  </span><span class="nt">&lt;MDI</span><span class="w"> </span><span class="na">key=</span><span class="s">&quot;md_key&quot;</span><span class="nt">&gt;</span>Metadata<span class="w"> </span>value<span class="nt">&lt;/MDI&gt;</span>
<span class="nt">&lt;/Metadata&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>MaskBand</strong>: This element represents a mask band that is shared between all bands on the dataset (see GMF_PER_DATASET in RFC 15). It must contain a single VRTRasterBand child element, that is the description of the mask band itself.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;MaskBand&gt;</span>
<span class="w">  </span><span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;Byte&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;SimpleSource&gt;</span>
<span class="w">      </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>utm.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">      </span><span class="nt">&lt;SourceBand&gt;</span>mask,1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">      </span><span class="nt">&lt;SrcRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;512&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;512&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;DstRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;512&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;512&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/SimpleSource&gt;</span>
<span class="w">  </span><span class="nt">&lt;/VRTRasterBand&gt;</span>
<span class="nt">&lt;/MaskBand&gt;</span>
</pre></div>
</div>
<ul>
<li><p><strong>OverviewList</strong>: (GDAL &gt;= 3.2.0, not valid for VRTPansharpenedDataset)
This elements contains a list of overview factors, separated by space, to
create &quot;virtual overviews&quot;. For example <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">4</span></code>. It can be used so that bands
of the VRT datasets declare overviews. This only makes sense to use if the
sources added in those bands have themselves overviews compatible with the
declared factor. It is generally not necessary to use this mechanism, since
downsampling pixel requests on a VRT dataset/band are able to use overviews of the
sources, even when the VRT bands do not declare them. One situation where
explicit overviews are needed at the VRT level is the warping of a VRT
to a lower resolution.
This element can also be used with an existing VRT dataset by running
<code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALDataset::BuildOverviews()</span></code> or <strong class="program">gdaladdo</strong> with the
<a class="reference internal" href="#config-VRT_VIRTUAL_OVERVIEWS"><code class="docutils literal notranslate"><span class="pre">VRT_VIRTUAL_OVERVIEWS</span></code></a> configuration option set to <code class="docutils literal notranslate"><span class="pre">YES</span></code>:</p>
<p id="config-VRT_VIRTUAL_OVERVIEWS"><strong>VRT_VIRTUAL_OVERVIEWS=[YES/NO]: </strong> Defaults to <code class="docutils literal notranslate"><span class="pre">NO</span></code>. </p>
<p>Virtual overviews have the least priority compared to the <strong>Overview</strong> element
at the <strong>VRTRasterBand</strong> level, or to materialized .vrt.ovr files.</p>
</li>
<li><p><strong>VRTRasterBand</strong>: This represents one band of a dataset.</p></li>
</ul>
</section>
<section id="vrtrasterband">
<h3>VRTRasterBand<a class="headerlink" href="#vrtrasterband" title="Link to this heading"></a></h3>
<p>The attributes for VRTRasterBand are:</p>
<ul class="simple">
<li><p><strong>dataType</strong> (optional): type of the pixel data associated with this band (use
names Byte, UInt16, Int16, UInt32, Int32, Float32, Float64, CInt16, CInt32, CFloat32 or CFloat64).
If not specified, defaults to 1</p></li>
<li><p><strong>band</strong> (optional): band number this element represents (1 based).</p></li>
<li><p><strong>blockXSize</strong> (optional, GDAL &gt;= 3.3): block width.
If not specified, defaults to the minimum of the raster width and 128.</p></li>
<li><p><strong>blockYSize</strong> (optional, GDAL &gt;= 3.3): block height.
If not specified, defaults to the minimum of the raster height and 128.</p></li>
</ul>
<p>This element may have Metadata, ColorInterp, NoDataValue, HideNoDataValue, ColorTable, GDALRasterAttributeTable, Description and MaskBand subelements as well as the various kinds of source elements such as SimpleSource, ComplexSource, AveragedSource, NoDataFromMaskSource, KernelFilteredSource and ArraySource.  A raster band may have many &quot;sources&quot; indicating where the actual raster data should be fetched from, and how it should be mapped into the raster bands pixel space.</p>
<p>The allowed subelements for VRTRasterBand are :</p>
<ul class="simple">
<li><p><strong>ColorInterp</strong>: The data of this element should be the name of a color interpretation type.  One of Gray, Palette, Red, Green, Blue, Alpha, Hue, Saturation, Lightness, Cyan, Magenta, Yellow, Black, or Unknown.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ColorInterp&gt;</span>Gray<span class="nt">&lt;/ColorInterp&gt;</span>:
</pre></div>
</div>
<ul class="simple">
<li><p><strong>NoDataValue</strong>: If the input datasets to be composed have a nodata value for this raster band, set this element's value to that nodata value for it to be reflected in the VRT. This must not be confused with the NODATA element of a VRTComplexSource element.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;NoDataValue&gt;</span>-100.0<span class="nt">&lt;/NoDataValue&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>HideNoDataValue</strong>: If this value is 1, the nodata value will not be reported.  Essentially, the caller will not be aware of a nodata pixel when it reads one.  Any datasets copied/translated from this will not have a nodata value.  This is useful when you want to specify a fixed background value for the dataset.  The background will be the value specified by the NoDataValue element. Default value is 0 when this element is absent.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;HideNoDataValue&gt;</span>1<span class="nt">&lt;/HideNoDataValue&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>ColorTable</strong>: This element is parent to a set of Entry elements defining the entries in a color table.  Currently only RGBA color tables are supported with c1 being red, c2 being green, c3 being blue and c4 being alpha.  The entries are ordered and will be assumed to start from color table entry 0.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ColorTable&gt;</span>
<span class="w">  </span><span class="nt">&lt;Entry</span><span class="w"> </span><span class="na">c1=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">c2=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">c3=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">c4=</span><span class="s">&quot;255&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Entry</span><span class="w"> </span><span class="na">c1=</span><span class="s">&quot;145&quot;</span><span class="w"> </span><span class="na">c2=</span><span class="s">&quot;78&quot;</span><span class="w"> </span><span class="na">c3=</span><span class="s">&quot;224&quot;</span><span class="w"> </span><span class="na">c4=</span><span class="s">&quot;255&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ColorTable&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>GDALRasterAttributeTable</strong>: (GDAL &gt;=2.3) This element is parent to a set of FieldDefn elements defining the columns of a raster attribute table, followed by a set of Row elements defining the values of the columns of each row.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;GDALRasterAttributeTable&gt;</span>
<span class="w">  </span><span class="nt">&lt;FieldDefn</span><span class="w"> </span><span class="na">index=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Name&gt;</span>Value<span class="nt">&lt;/Name&gt;</span>
<span class="w">    </span><span class="nt">&lt;Type&gt;</span>0<span class="nt">&lt;/Type&gt;</span>
<span class="w">    </span><span class="nt">&lt;Usage&gt;</span>0<span class="nt">&lt;/Usage&gt;</span>
<span class="w">  </span><span class="nt">&lt;/FieldDefn&gt;</span>
<span class="w">  </span><span class="nt">&lt;FieldDefn</span><span class="w"> </span><span class="na">index=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Name&gt;</span>Red<span class="nt">&lt;/Name&gt;</span>
<span class="w">    </span><span class="nt">&lt;Type&gt;</span>0<span class="nt">&lt;/Type&gt;</span>
<span class="w">    </span><span class="nt">&lt;Usage&gt;</span>6<span class="nt">&lt;/Usage&gt;</span>
<span class="w">  </span><span class="nt">&lt;/FieldDefn&gt;</span>
<span class="w">  </span><span class="nt">&lt;FieldDefn</span><span class="w"> </span><span class="na">index=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Name&gt;</span>Green<span class="nt">&lt;/Name&gt;</span>
<span class="w">    </span><span class="nt">&lt;Type&gt;</span>0<span class="nt">&lt;/Type&gt;</span>
<span class="w">    </span><span class="nt">&lt;Usage&gt;</span>7<span class="nt">&lt;/Usage&gt;</span>
<span class="w">  </span><span class="nt">&lt;/FieldDefn&gt;</span>
<span class="w">  </span><span class="nt">&lt;FieldDefn</span><span class="w"> </span><span class="na">index=</span><span class="s">&quot;3&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Name&gt;</span>Blue<span class="nt">&lt;/Name&gt;</span>
<span class="w">    </span><span class="nt">&lt;Type&gt;</span>0<span class="nt">&lt;/Type&gt;</span>
<span class="w">    </span><span class="nt">&lt;Usage&gt;</span>8<span class="nt">&lt;/Usage&gt;</span>
<span class="w">  </span><span class="nt">&lt;/FieldDefn&gt;</span>
<span class="w">  </span><span class="nt">&lt;Row</span><span class="w"> </span><span class="na">index=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;F&gt;</span>-500<span class="nt">&lt;/F&gt;</span>
<span class="w">    </span><span class="nt">&lt;F&gt;</span>127<span class="nt">&lt;/F&gt;</span>
<span class="w">    </span><span class="nt">&lt;F&gt;</span>40<span class="nt">&lt;/F&gt;</span>
<span class="w">    </span><span class="nt">&lt;F&gt;</span>65<span class="nt">&lt;/F&gt;</span>
<span class="w">  </span><span class="nt">&lt;/Row&gt;</span>
<span class="w">  </span><span class="nt">&lt;Row</span><span class="w"> </span><span class="na">index=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;F&gt;</span>-400<span class="nt">&lt;/F&gt;</span>
<span class="w">    </span><span class="nt">&lt;F&gt;</span>154<span class="nt">&lt;/F&gt;</span>
<span class="w">    </span><span class="nt">&lt;F&gt;</span>168<span class="nt">&lt;/F&gt;</span>
<span class="w">    </span><span class="nt">&lt;F&gt;</span>118<span class="nt">&lt;/F&gt;</span>
<span class="w">  </span><span class="nt">&lt;/Row&gt;</span>
<span class="nt">&lt;/GDALRasterAttributeTable&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Description</strong>: This element contains the optional description of a raster band as its text value.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Description&gt;</span>Crop<span class="w"> </span>Classification<span class="w"> </span>Layer<span class="nt">&lt;/Description&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>UnitType</strong>: This optional element contains the vertical units for elevation band data.  One of &quot;m&quot; for meters or &quot;ft&quot; for feet. Default assumption is meters.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;UnitType&gt;</span>ft<span class="nt">&lt;/UnitType&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Offset</strong>: This optional element contains the offset that should be applied when computing &quot;real&quot; pixel values from scaled pixel values on a raster band.   The default is 0.0.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Offset&gt;</span>0.0<span class="nt">&lt;/Offset&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Scale</strong>: This optional element contains the scale that should be applied when computing &quot;real&quot; pixel values from scaled pixel values on a raster band.   The default is 1.0.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Scale&gt;</span>0.0<span class="nt">&lt;/Scale&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Overview</strong>: This optional element describes one overview level for the band.  It should have a child SourceFilename and SourceBand element.  The SourceFilename may have a relativeToVRT boolean attribute.  Multiple elements may be used to describe multiple overviews.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Overview&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>yellowstone_2.1.ntf.r2<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceBand&gt;</span>1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="nt">&lt;/Overview&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>CategoryNames</strong>: This optional element contains a list of Category subelements with the names of the categories for classified raster band.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;CategoryNames&gt;</span>
<span class="w">  </span><span class="nt">&lt;Category&gt;</span>Missing<span class="nt">&lt;/Category&gt;</span>
<span class="w">  </span><span class="nt">&lt;Category&gt;</span>Non-Crop<span class="nt">&lt;/Category&gt;</span>
<span class="w">  </span><span class="nt">&lt;Category&gt;</span>Wheat<span class="nt">&lt;/Category&gt;</span>
<span class="w">  </span><span class="nt">&lt;Category&gt;</span>Corn<span class="nt">&lt;/Category&gt;</span>
<span class="w">  </span><span class="nt">&lt;Category&gt;</span>Soybeans<span class="nt">&lt;/Category&gt;</span>
<span class="nt">&lt;/CategoryNames&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>SimpleSource</strong>: The <a class="reference internal" href="#simplesource">SimpleSource</a> indicates that raster data should be read from a separate dataset, indicating the dataset, and band to be read from, and how the data should map into this band's raster space.</p></li>
<li><p><strong>AveragedSource</strong>: The AveragedSource is derived from the SimpleSource and shares the same properties except that it uses an averaging resampling instead of a nearest neighbour algorithm as in SimpleSource, when the size of the destination rectangle is not the same as the size of the source rectangle. Note: a more general mechanism to specify resampling algorithms can be used. See above paragraph about the 'resampling' attribute.</p></li>
<li><p><strong>NoDataFromMaskSource</strong>: (GDAL &gt;= 3.9) The NoDataFromMaskSource is derived from the SimpleSource and shares the same properties except that it replaces the value of the source with the value of the NODATA child element when the value of the mask band of the source is less or equal to the MaskValueThreshold child element. This is typically used to transform a R,G,B,A image into a R,G,B one with a NoData value.</p></li>
<li><p><strong>ComplexSource</strong>: The <a class="reference internal" href="#complexsource">ComplexSource</a> is derived from the SimpleSource (so it shares the SourceFilename, SourceBand, SrcRect and DstRect elements), but it provides support to rescale and offset the range of the source values. Certain regions of the source can be masked by specifying the NODATA value, or starting with GDAL 3.3, with the &lt;UseMaskBand&gt;true&lt;/UseMaskBand&gt; element.</p></li>
<li><p><strong>KernelFilteredSource</strong>: The <a class="reference internal" href="#kernelfilteredsource">KernelFilteredSource</a> is a pixel source derived from the Simple Source (so it shares the SourceFilename, SourceBand, SrcRect and DstRect elements, but it also passes the data through a simple filtering kernel specified with the Kernel element.</p></li>
<li><p><strong>ArraySource</strong>: The <a class="reference internal" href="#arraysource">ArraySource</a> indicates that raster data should be read from a 2D array using the multidimensional API.</p></li>
<li><p><strong>MaskBand</strong>: This element represents a mask band that is specific to the VRTRasterBand it contains. It must contain a single VRTRasterBand child element, that is the description of the mask band itself.</p></li>
</ul>
<section id="sources">
<h4>Sources<a class="headerlink" href="#sources" title="Link to this heading"></a></h4>
<section id="simplesource">
<h5>SimpleSource<a class="headerlink" href="#simplesource" title="Link to this heading"></a></h5>
<p>The SimpleSource may have the SourceFilename, SourceBand, SrcRect, and DstRect
subelements.  The SrcRect element will indicate what rectangle on the indicated
source file should be read, and the DstRect element indicates how that
rectangle of source data should be mapped into the VRTRasterBands space.</p>
<p>SrcRect and DstRect are expressed in pixel/line coordinate space. Their
relationship with the geospatial coordinate space is given by the geotransform
matrix of the source for SrcRect, and of the VRT itself (<strong>GeoTransform</strong>
element) for DstRect.
See <a class="reference internal" href="../../user/raster_data_model.html#raster-data-model-geotransform"><span class="std std-ref">Affine GeoTransform</span></a> for more details about that mapping.</p>
<p>The relativeToVRT attribute on the SourceFilename indicates whether the
filename should be interpreted as relative to the .vrt file (value is 1)
or not relative to the .vrt file (value is 0).  The default is 0.</p>
<p>Some characteristics of the source band can be specified in the optional
<code class="docutils literal notranslate"><span class="pre">SourceProperties</span></code> element to enable the VRT driver to defer the opening of the source
dataset until it really needs to read data from it. This is particularly useful
when building VRTs with a big number of source datasets. The needed parameters are the
raster dimensions, the size of the blocks and the data type. If the SourceProperties
tag is not present, the source dataset will be opened at the same time as the VRT itself.</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>Starting with GDAL 3.4, the <code class="docutils literal notranslate"><span class="pre">SourceProperties</span></code> element is no longer necessary
for deferred opening of the source datasets.</p>
</div>
<p>The content of the SourceBand subelement can refer to
a mask band. For example mask,1 means the mask band of the first band of the source.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;SimpleSource&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>utm.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceBand&gt;</span>1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceProperties</span><span class="w"> </span><span class="na">RasterXSize=</span><span class="s">&quot;512&quot;</span><span class="w"> </span><span class="na">RasterYSize=</span><span class="s">&quot;512&quot;</span><span class="w"> </span><span class="na">DataType=</span><span class="s">&quot;Byte&quot;</span><span class="w"> </span><span class="na">BlockXSize=</span><span class="s">&quot;128&quot;</span><span class="w"> </span><span class="na">BlockYSize=</span><span class="s">&quot;128&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;SrcRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;512&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;512&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;DstRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;512&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;512&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/SimpleSource&gt;</span>
</pre></div>
</div>
<p>A OpenOptions subelement can be added to specify
the open options to apply when opening the source dataset. It has &lt;OOI&gt; (open option item)
subelements which have a &quot;key&quot; attribute and the value as the data of the element.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;SimpleSource&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>utm.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">  </span><span class="nt">&lt;OpenOptions&gt;</span>
<span class="w">      </span><span class="nt">&lt;OOI</span><span class="w"> </span><span class="na">key=</span><span class="s">&quot;OVERVIEW_LEVEL&quot;</span><span class="nt">&gt;</span>0<span class="nt">&lt;/OOI&gt;</span>
<span class="w">  </span><span class="nt">&lt;/OpenOptions&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceBand&gt;</span>1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceProperties</span><span class="w"> </span><span class="na">RasterXSize=</span><span class="s">&quot;256&quot;</span><span class="w"> </span><span class="na">RasterYSize=</span><span class="s">&quot;256&quot;</span><span class="w"> </span><span class="na">DataType=</span><span class="s">&quot;Byte&quot;</span><span class="w"> </span><span class="na">BlockXSize=</span><span class="s">&quot;128&quot;</span><span class="w"> </span><span class="na">BlockYSize=</span><span class="s">&quot;128&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;SrcRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;256&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;256&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;DstRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;256&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;256&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/SimpleSource&gt;</span>
</pre></div>
</div>
<p>A resampling attribute can be specified on a SimpleSource
or ComplexSource element to specified the resampling algorithm used when the
size of the destination rectangle is not the same as the size of the source
rectangle. The values allowed for that attribute are : nearest,bilinear,cubic,
cubicspline,lanczos,average,mode.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;SimpleSource</span><span class="w"> </span><span class="na">resampling=</span><span class="s">&quot;cubic&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>utm.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceBand&gt;</span>1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceProperties</span><span class="w"> </span><span class="na">RasterXSize=</span><span class="s">&quot;256&quot;</span><span class="w"> </span><span class="na">RasterYSize=</span><span class="s">&quot;256&quot;</span><span class="w"> </span><span class="na">DataType=</span><span class="s">&quot;Byte&quot;</span><span class="w"> </span><span class="na">BlockXSize=</span><span class="s">&quot;128&quot;</span><span class="w"> </span><span class="na">BlockYSize=</span><span class="s">&quot;128&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;SrcRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;256&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;256&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;DstRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;128&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;128&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/SimpleSource&gt;</span>
</pre></div>
</div>
</section>
<section id="complexsource">
<h5>ComplexSource<a class="headerlink" href="#complexsource" title="Link to this heading"></a></h5>
<p>Alternatively to linear scaling, non-linear
scaling using a power function can be used by specifying the Exponent,
SrcMin, SrcMax, DstMin and DstMax elements. If SrcMin and SrcMax are
not specified, they are computed from the source minimum and maximum
value (which might require analyzing the whole source dataset). Exponent
must be positive. (Those 5 values can be set with the -exponent and -scale
options of gdal_translate.)</p>
<p>The ComplexSource supports adding a custom lookup table to transform
the source values to the destination. The LUT can be specified using
the following form:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;LUT&gt;</span>[src<span class="w"> </span>value<span class="w"> </span>1]:[dest<span class="w"> </span>value<span class="w"> </span>1],[src<span class="w"> </span>value<span class="w"> </span>2]:[dest<span class="w"> </span>value<span class="w"> </span>2],...<span class="nt">&lt;/LUT&gt;</span>
</pre></div>
</div>
<p>The intermediary values are calculated using a linear interpolation
between the bounding destination values of the corresponding range.
Source values should be listed in a monotonically non-decreasing order.
If there is a Not-A-Number (NaN) source value, it should be the first one.
Clamping is performed for input pixel values outside of the range specified by the LUT. That is, if an
input pixel value is lower than the minimum source value, then the destination
value corresponding to that minimum source value is used as the output pixel value.
And similarly for an input pixel value that is greater than the maximum source value.</p>
<p>The ComplexSource supports fetching a color component from a source raster
band that has a color table. The ColorTableComponent value is the index of the
color component to extract : 1 for the red band, 2 for the green band, 3 for
the blue band or 4 for the alpha band.</p>
<p>When transforming the source values the operations are executed
in the following order:</p>
<ul class="simple">
<li><p>Masking, if the NODATA element is set or, starting with GDAL 3.3,
if the UseMaskBand is set to true and the source band has a mask band.
Note that this is binary masking only, so no alpha blending is done if the
mask band is actually an alpha band with non-0 or non-255 values.</p></li>
<li><p>Color table expansion</p></li>
<li><p>For linear scaling, applying the scale ratio, then scale offset</p></li>
<li><p>For non-linear scaling, apply (DstMax-DstMin) * pow( (SrcValue-SrcMin) / (SrcMax-SrcMin), Exponent) + DstMin</p></li>
<li><p>Table lookup</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ComplexSource&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>utm.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceBand&gt;</span>1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">  </span><span class="nt">&lt;ScaleOffset&gt;</span>0<span class="nt">&lt;/ScaleOffset&gt;</span>
<span class="w">  </span><span class="nt">&lt;ScaleRatio&gt;</span>1<span class="nt">&lt;/ScaleRatio&gt;</span>
<span class="w">  </span><span class="nt">&lt;ColorTableComponent&gt;</span>1<span class="nt">&lt;/ColorTableComponent&gt;</span>
<span class="w">  </span><span class="nt">&lt;LUT&gt;</span>0:0,2345.12:64,56789.5:128,2364753.02:255<span class="nt">&lt;/LUT&gt;</span>
<span class="w">  </span><span class="nt">&lt;NODATA&gt;</span>0<span class="nt">&lt;/NODATA&gt;</span><span class="w">  </span><span class="cm">&lt;!-- if the mask is a mask or alpha band, use &lt;UseMaskBand&gt;true&lt;/UseMaskBand&gt; --&gt;</span>
<span class="w">  </span><span class="nt">&lt;SrcRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;512&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;512&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;DstRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;512&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;512&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ComplexSource&gt;</span>
</pre></div>
</div>
<p>Non-linear scaling:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ComplexSource&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>16bit.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceBand&gt;</span>1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">  </span><span class="nt">&lt;Exponent&gt;</span>0.75<span class="nt">&lt;/Exponent&gt;</span>
<span class="w">  </span><span class="nt">&lt;SrcMin&gt;</span>0<span class="nt">&lt;/SrcMin&gt;</span>
<span class="w">  </span><span class="nt">&lt;SrcMax&gt;</span>65535<span class="nt">&lt;/SrcMax&gt;</span>
<span class="w">  </span><span class="nt">&lt;DstMin&gt;</span>0<span class="nt">&lt;/DstMin&gt;</span>
<span class="w">  </span><span class="nt">&lt;DstMax&gt;</span>255<span class="nt">&lt;/DstMax&gt;</span>
<span class="w">  </span><span class="nt">&lt;SrcRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;512&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;512&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;DstRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;512&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;512&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ComplexSource&gt;</span>
</pre></div>
</div>
</section>
<section id="kernelfilteredsource">
<h5>KernelFilteredSource<a class="headerlink" href="#kernelfilteredsource" title="Link to this heading"></a></h5>
<p>The Kernel element should have
two child elements, Size and Coefs and optionally the boolean attribute
normalized (defaults to false=0).  The size must always be an odd number,
and the Coefs must have Size * Size entries separated by spaces.  For now
kernel is not applied to sub-sampled or over-sampled data.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;KernelFilteredSource&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceFilename&gt;</span>/debian/home/warmerda/openev/utm.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceBand&gt;</span>1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">  </span><span class="nt">&lt;Kernel</span><span class="w"> </span><span class="na">normalized=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Size&gt;</span>3<span class="nt">&lt;/Size&gt;</span>
<span class="w">    </span><span class="nt">&lt;Coefs&gt;</span>0.11111111<span class="w"> </span>0.11111111<span class="w"> </span>0.11111111<span class="w"> </span>0.11111111<span class="w"> </span>0.11111111<span class="w"> </span>0.11111111<span class="w"> </span>0.11111111<span class="w"> </span>0.11111111<span class="w"> </span>0.11111111<span class="nt">&lt;/Coefs&gt;</span>
<span class="w">  </span><span class="nt">&lt;/Kernel&gt;</span>
<span class="nt">&lt;/KernelFilteredSource&gt;</span>
</pre></div>
</div>
<p>Starting with GDAL 2.3, a separable kernel may also be used.  In this case the
number of Coefs entries should correspond to the Size.  The Coefs specify a
one-dimensional kernel which is applied along each axis in succession, resulting
in far quicker execution. Many common image-processing filters are separable.
For example, a Gaussian blur:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;KernelFilteredSource&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceFilename&gt;</span>/debian/home/warmerda/openev/utm.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceBand&gt;</span>1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">  </span><span class="nt">&lt;Kernel</span><span class="w"> </span><span class="na">normalized=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Size&gt;</span>13<span class="nt">&lt;/Size&gt;</span>
<span class="w">    </span><span class="nt">&lt;Coefs&gt;</span>0.01111<span class="w"> </span>0.04394<span class="w"> </span>0.13534<span class="w"> </span>0.32465<span class="w"> </span>0.60653<span class="w"> </span>0.8825<span class="w"> </span>1.0<span class="w"> </span>0.8825<span class="w"> </span>0.60653<span class="w"> </span>0.32465<span class="w"> </span>0.13534<span class="w"> </span>0.04394<span class="w"> </span>0.01111<span class="nt">&lt;/Coefs&gt;</span>
<span class="w">  </span><span class="nt">&lt;/Kernel&gt;</span>
<span class="nt">&lt;/KernelFilteredSource&gt;</span>
</pre></div>
</div>
</section>
<section id="nodatafrommasksource">
<h5>NoDataFromMaskSource<a class="headerlink" href="#nodatafrommasksource" title="Link to this heading"></a></h5>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.9.</span></p>
</div>
<p>The NoDataFromMaskSource is derived from the SimpleSource and shares the same properties except that it replaces the value of the source with the value of the NODATA child element when the value of the mask band of the source is less or equal to the MaskValueThreshold child element.
This is typically used to transform a R,G,B,A image into a R,G,B one with a NoData value.
An optional RemappedValue element can be set to specify the value onto which valid pixels whose value is the one of NODATA should be remapped to. When RemappedValue is not explicitly specified, for Byte bands, if NODATA=255, it is implicitly set to 254, otherwise it is set to NODATA+1.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;NoDataFromMaskSource&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>in.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">  </span><span class="nt">&lt;SourceBand&gt;</span>1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">  </span><span class="nt">&lt;MaskValueThreshold&gt;</span>128<span class="nt">&lt;/MaskValueThreshold&gt;</span><span class="w"> </span><span class="cm">&lt;!-- if the mask value is &amp;lt;= 128, pixels are set to NODATA=0 --&gt;</span>
<span class="w">  </span><span class="nt">&lt;NODATA&gt;</span>0<span class="nt">&lt;/NODATA&gt;</span>
<span class="w">  </span><span class="nt">&lt;RemappedValue&gt;</span>1<span class="nt">&lt;/RemappedValue&gt;</span><span class="w"> </span><span class="cm">&lt;!-- valid/unmasked pixels at NODATA=0 are remapped to 1 --&gt;</span>
<span class="nt">&lt;/NoDataFromMaskSource&gt;</span>
</pre></div>
</div>
</section>
<section id="arraysource">
<h5>ArraySource<a class="headerlink" href="#arraysource" title="Link to this heading"></a></h5>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.8.</span></p>
</div>
<p>The <a class="reference internal" href="#arraysource">ArraySource</a> indicates that raster data should be read from a 2D array using
the multidimensional API. If the original array is not a 3D array, a DerivedArray
with a View step must be typically used to create a 2D slice.</p>
<p>ArraySource can have the following child elements:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SingleSourceArray</span></code>, <code class="docutils literal notranslate"><span class="pre">DerivedArray</span></code> or <code class="docutils literal notranslate"><span class="pre">Array</span></code>: required as first child element</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SrcRect</span></code> (same syntax and semantics as in SimpleSource): optional</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DstRect</span></code> (same syntax and semantics as in SimpleSource): optional</p></li>
</ul>
<section id="singlesourcearray">
<h6>SingleSourceArray<a class="headerlink" href="#singlesourcearray" title="Link to this heading"></a></h6>
<p>SingleSourceArray references a multidimensional raster through a SourceFilename
element and an array through its full path within it with SourceArray. When
SingleSourceArray is used as a direct child of ArraySource, it must be a 2-dimensional
array.</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ArraySource&gt;</span>
<span class="w">  </span><span class="nt">&lt;SingleSourceArray&gt;</span>
<span class="w">    </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>byte.nc<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">    </span><span class="nt">&lt;SourceArray&gt;</span>/my_array<span class="nt">&lt;/SourceArray&gt;</span>
<span class="w">  </span><span class="nt">&lt;/SingleSourceArray&gt;</span>
<span class="nt">&lt;/ArraySource&gt;</span>
</pre></div>
</div>
<p>Be careful that quite often arrays in the multidimensional API use a &quot;bottom-up&quot;
approach, and it might thus be needed to reverse the Y axis, with a View expression
with a DerivedArray (cf below example)</p>
</section>
<section id="derivedarray">
<h6>DerivedArray<a class="headerlink" href="#derivedarray" title="Link to this heading"></a></h6>
<p>A DerivedArray starts with an array coming from a SingleSourceArray
(but it could also be a DerivedArray or a Array), which must be the first
child element, and applies different processing steps wrapped in zero or more
Step elements.</p>
<ul class="simple">
<li><p>View step: applies the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALMDArray::GetView()</span></code> method</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">View</span></code> element must have an <code class="docutils literal notranslate"><span class="pre">expr</span></code> attribute, which is the argument of
<code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALMDArray::GetView()</span></code> method</p>
<p>The following example slices the 3D dimension at index 0 and flips the vertical
axis (assuming 1st dimension is a non-spatial one, 2nd dimension is the Y
dimension and 3rd dimension is the X dimension)</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ArraySource&gt;</span>
<span class="w">  </span><span class="nt">&lt;DerivedArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;SingleSourceArray&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>3d_array.nc<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceArray&gt;</span>/my_array<span class="nt">&lt;/SourceArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;/SingleSourceArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;Step&gt;</span>
<span class="w">          </span><span class="nt">&lt;View</span><span class="w"> </span><span class="na">expr=</span><span class="s">&quot;[0,::-1,...]&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/Step&gt;</span>
<span class="w">   </span><span class="nt">&lt;/DerivedArray&gt;</span>
<span class="nt">&lt;/ArraySource&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Transpose</span></code> step: applies the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALMDArray::Transpose()</span></code> method</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">Transpose</span></code> element must have a <code class="docutils literal notranslate"><span class="pre">newOrder</span></code> attribute, which is the argument of
<code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALMDArray::Transpose()</span></code> method</p>
<p>The following example transposes the 2 axis of a 2D array</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ArraySource&gt;</span>
<span class="w">  </span><span class="nt">&lt;DerivedArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;SingleSourceArray&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>2d_array.nc<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceArray&gt;</span>/my_array<span class="nt">&lt;/SourceArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;/SingleSourceArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;Step&gt;</span>
<span class="w">          </span><span class="nt">&lt;Transpose</span><span class="w"> </span><span class="na">newOrder=</span><span class="s">&quot;[1,0]&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/Step&gt;</span>
<span class="w">   </span><span class="nt">&lt;/DerivedArray&gt;</span>
<span class="nt">&lt;/ArraySource&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Resample step: applies the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALMDArray::GetResampled()</span></code> method</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">Resample</span></code> element may have the following child elements, which correspond
to the arguments of the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALMDArray::GetResampled()</span></code> method:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Dimension</span></code>: with a <code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">size</span></code> attribute. This element may be repeated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ResampleAlg</span></code>: whose value is <code class="docutils literal notranslate"><span class="pre">NearestNeighbour</span></code> (default), <code class="docutils literal notranslate"><span class="pre">Cubic</span></code>, <code class="docutils literal notranslate"><span class="pre">CubicSpline</span></code>, <code class="docutils literal notranslate"><span class="pre">Bilinear</span></code>, <code class="docutils literal notranslate"><span class="pre">Lanczos</span></code>, <code class="docutils literal notranslate"><span class="pre">Average</span></code>, <code class="docutils literal notranslate"><span class="pre">RMS</span></code> or <code class="docutils literal notranslate"><span class="pre">Mode</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SRS</span></code>: target SRS (string recognized by <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">OGRSpatialReference::SetFromUserInput()</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Option</span></code> with a <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute and the value as the content of the element. This element may be repeated.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ArraySource&gt;</span>
<span class="w">  </span><span class="nt">&lt;DerivedArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;SingleSourceArray&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>test.nc<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceArray&gt;</span>/Band1<span class="nt">&lt;/SourceArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;/SingleSourceArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;Step&gt;</span>
<span class="w">          </span><span class="nt">&lt;Resample&gt;</span>
<span class="w">            </span><span class="nt">&lt;Dimension</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Y&quot;</span><span class="w"> </span><span class="na">size=</span><span class="s">&quot;40&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;Dimension</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;X&quot;</span><span class="w"> </span><span class="na">size=</span><span class="s">&quot;40&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;ResampleAlg&gt;</span>Bilinear<span class="nt">&lt;/ResampleAlg&gt;</span>
<span class="w">            </span><span class="nt">&lt;SRS&gt;</span>EPSG:4267<span class="nt">&lt;/SRS&gt;</span>
<span class="w">            </span><span class="nt">&lt;Option</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;IGNORED&quot;</span><span class="nt">&gt;</span>YES<span class="nt">&lt;/Option&gt;</span>
<span class="w">          </span><span class="nt">&lt;/Resample&gt;</span>
<span class="w">      </span><span class="nt">&lt;/Step&gt;</span>
<span class="w">   </span><span class="nt">&lt;/DerivedArray&gt;</span>
<span class="nt">&lt;/ArraySource&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Grid step: applies the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALMDArray::GetGridded()</span></code> method</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">Grid</span></code> element may have the following child elements, which correspond
to the arguments of the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALMDArray::GetGridded()</span></code> method:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GridOptions</span></code> (required): name and options of the gridding algorithm</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">XArray</span></code> (optional): its child value should be a SingleSourceArray, DerivedArray or Array pointing to the array to use for the X dimension. This is needed if the source array does not have a <code class="docutils literal notranslate"><span class="pre">coordinates</span></code> attribute.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">YArray</span></code> (optional): its child value should be a SingleSourceArray, DerivedArray or Array pointing to the array to use for the Y dimension. This is needed if the source array does not have a <code class="docutils literal notranslate"><span class="pre">coordinates</span></code> attribute.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Option</span></code> with a <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute and the value as the content of the element. This element may be repeated.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ArraySource&gt;</span>
<span class="w">  </span><span class="nt">&lt;DerivedArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;SingleSourceArray&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>test.nc<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceArray&gt;</span>/Band1<span class="nt">&lt;/SourceArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;/SingleSourceArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;Step&gt;</span>
<span class="w">          </span><span class="nt">&lt;Grid&gt;</span>
<span class="w">              </span><span class="nt">&lt;GridOptions&gt;</span>invdist<span class="nt">&lt;/GridOptions&gt;</span>
<span class="w">              </span><span class="nt">&lt;XArray&gt;</span>
<span class="w">                  </span><span class="nt">&lt;SingleSourceArray&gt;</span>
<span class="w">                    </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>test.nc<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">                    </span><span class="nt">&lt;SourceArray&gt;</span>/varX<span class="nt">&lt;/SourceArray&gt;</span>
<span class="w">                  </span><span class="nt">&lt;/SingleSourceArray&gt;</span>
<span class="w">              </span><span class="nt">&lt;/XArray&gt;</span>
<span class="w">              </span><span class="nt">&lt;YArray&gt;</span>
<span class="w">                  </span><span class="nt">&lt;SingleSourceArray&gt;</span>
<span class="w">                    </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>test.nc<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">                    </span><span class="nt">&lt;SourceArray&gt;</span>/varY<span class="nt">&lt;/SourceArray&gt;</span>
<span class="w">                  </span><span class="nt">&lt;/SingleSourceArray&gt;</span>
<span class="w">              </span><span class="nt">&lt;/YArray&gt;</span>
<span class="w">              </span><span class="nt">&lt;Option</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;IGNORED&quot;</span><span class="nt">&gt;</span>YES<span class="nt">&lt;/Option&gt;</span>
<span class="w">          </span><span class="nt">&lt;/Grid&gt;</span>
<span class="w">      </span><span class="nt">&lt;/Step&gt;</span>
<span class="w">   </span><span class="nt">&lt;/DerivedArray&gt;</span>
<span class="nt">&lt;/ArraySource&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GetUnscaled</span></code> step: applies the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALMDArray::GetUnscaled()</span></code> method</p></li>
</ul>
<p>It does not have any child elements.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ArraySource&gt;</span>
<span class="w">  </span><span class="nt">&lt;DerivedArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;SingleSourceArray&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>2d_array.nc<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceArray&gt;</span>/my_array<span class="nt">&lt;/SourceArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;/SingleSourceArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;Step&gt;</span>
<span class="w">          </span><span class="nt">&lt;GetUnscaled/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/Step&gt;</span>
<span class="w">   </span><span class="nt">&lt;/DerivedArray&gt;</span>
<span class="nt">&lt;/ArraySource&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GetMask</span></code> step: applies the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALMDArray::GetMask()</span></code> method</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">GetMask</span></code> element may have the following child elements, which correspond
to the arguments of the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALMDArray::GetMask()</span></code> method:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Option</span></code> with a <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute and the value as the content of the element. This element may be repeated.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ArraySource&gt;</span>
<span class="w">  </span><span class="nt">&lt;DerivedArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;SingleSourceArray&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>2d_array.nc<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceArray&gt;</span>/my_array<span class="nt">&lt;/SourceArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;/SingleSourceArray&gt;</span>
<span class="w">      </span><span class="nt">&lt;Step&gt;</span>
<span class="w">          </span><span class="nt">&lt;GetMask&gt;</span>
<span class="w">              </span><span class="nt">&lt;Option</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;UNMASK_FLAGS&quot;</span><span class="nt">&gt;</span>microwave,land<span class="nt">&lt;/Option&gt;</span>
<span class="w">          </span><span class="nt">&lt;/GetMask&gt;</span>
<span class="w">      </span><span class="nt">&lt;/Step&gt;</span>
<span class="w">   </span><span class="nt">&lt;/DerivedArray&gt;</span>
<span class="nt">&lt;/ArraySource&gt;</span>
</pre></div>
</div>
</section>
<section id="array">
<h6>Array<a class="headerlink" href="#array" title="Link to this heading"></a></h6>
<p><a class="reference internal" href="vrt_multidimensional.html#vrt-multidimensional"><span class="std std-ref">Array</span></a> can be used to mosaic several multidimensional arrays.</p>
</section>
</section>
</section>
</section>
</section>
<section id="overviews">
<h2>Overviews<a class="headerlink" href="#overviews" title="Link to this heading"></a></h2>
<p>GDAL can make efficient use of overviews available in the sources that compose
the bands when dealing with RasterIO() requests that involve downsampling.
But in the general case, the VRT bands themselves will not expose overviews.</p>
<p>Except if (from top priority to lesser priority) :</p>
<ul class="simple">
<li><p>The <strong>Overview</strong> element is present in the VRTRasterBand element. See above.</p></li>
<li><p>or external .vrt.ovr overviews are built</p></li>
<li><p>(starting with GDAL 3.2) explicit virtual overviews, if a <strong>OverviewList</strong> element
is declared in the VRTDataset element (see above).
Those virtual overviews will be hidden by external .vrt.ovr overviews that might be built later.</p></li>
<li><p>(starting with GDAL 2.1) implicit virtual overviews, if the VRTRasterBand are made of
a single SimpleSource or ComplexSource that has overviews.
Those virtual overviews will be hidden by external .vrt.ovr overviews that might be built later.</p></li>
</ul>
</section>
<section id="vrt-descriptions-for-raw-files">
<h2>.vrt Descriptions for Raw Files<a class="headerlink" href="#vrt-descriptions-for-raw-files" title="Link to this heading"></a></h2>
<p>So far we have described how to derive new virtual datasets from existing
files supported by GDAL.  However, it is also common to need to utilize
raw binary raster files for which the regular layout of the data is known
but for which no format specific driver exists.  This can be accomplished
by writing a .vrt file describing the raw file.</p>
<p>For example, the following .vrt describes a raw raster file containing
floating point complex pixels in a file called <em>l2p3hhsso.img</em>.  The
image data starts from the first byte (ImageOffset=0).  The byte offset
between pixels is 8 (PixelOffset=8), the size of a CFloat32.  The byte offset
from the start of one line to the start of the next is 9376 bytes
(LineOffset=9376) which is the width (1172) times the size of a pixel (8).</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VRTDataset</span><span class="w"> </span><span class="na">rasterXSize=</span><span class="s">&quot;1172&quot;</span><span class="w"> </span><span class="na">rasterYSize=</span><span class="s">&quot;1864&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;CFloat32&quot;</span><span class="w"> </span><span class="na">band=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTRawRasterBand&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativetoVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>l2p3hhsso.img<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">        </span><span class="nt">&lt;ImageOffset&gt;</span>0<span class="nt">&lt;/ImageOffset&gt;</span>
<span class="w">        </span><span class="nt">&lt;PixelOffset&gt;</span>8<span class="nt">&lt;/PixelOffset&gt;</span>
<span class="w">        </span><span class="nt">&lt;LineOffset&gt;</span>9376<span class="nt">&lt;/LineOffset&gt;</span>
<span class="w">        </span><span class="nt">&lt;ByteOrder&gt;</span>MSB<span class="nt">&lt;/ByteOrder&gt;</span>
<span class="w">    </span><span class="nt">&lt;/VRTRasterBand&gt;</span>
<span class="nt">&lt;/VRTDataset&gt;</span>
</pre></div>
</div>
<p>Some things to note are that the VRTRasterBand has a subClass specifier
of &quot;VRTRawRasterBand&quot;.  Also, the VRTRawRasterBand contains a number of
previously unseen elements but no &quot;source&quot; information.  VRTRawRasterBands
may never have sources (i.e. SimpleSource), but should contain the following
elements in addition to all the normal &quot;metadata&quot; elements previously
described which are still supported.</p>
<ul class="simple">
<li><p><strong>SourceFilename</strong>: The name of the raw file containing the data for this band.  The relativeToVRT attribute can be used to indicate if the SourceFilename is relative to the .vrt file (1) or not (0).</p></li>
<li><p><strong>ImageOffset</strong>: The offset in bytes to the beginning of the first pixel of data of this image band.   Defaults to zero.</p></li>
<li><p><strong>PixelOffset</strong>: The offset in bytes from the beginning of one pixel and the next on the same line.  In packed single band data this will be the size of the <strong>dataType</strong> in bytes.</p></li>
<li><p><strong>LineOffset</strong>: The offset in bytes from the beginning of one scanline of data and the next scanline of data.  In packed single band data this will be PixelOffset * rasterXSize.</p></li>
<li><p><strong>ByteOrder</strong>: Defines the byte order of the data on disk. Either LSB (Least Significant Byte first) such as the natural byte order on Intel x86 systems or MSB (Most Significant Byte first) such as the natural byte order on Motorola or Sparc systems.  Defaults to being the local machine order.</p></li>
</ul>
<p>A few other notes:</p>
<ul class="simple">
<li><p>The image data on disk is assumed to be of the same data type as the band <strong>dataType</strong> of the VRTRawRasterBand.</p></li>
<li><p>All the non-source attributes of the VRTRasterBand are supported, including color tables, metadata, nodata values, and color interpretation.</p></li>
<li><p>The VRTRawRasterBand supports in place update of the raster, whereas the source based VRTRasterBand is always read-only.</p></li>
<li><p>The OpenEV tool includes a File menu option to input parameters describing a raw raster file in a GUI and create the corresponding .vrt file.</p></li>
<li><p>Multiple bands in the one .vrt file can come from the same raw file. Just ensure that the ImageOffset, PixelOffset, and LineOffset definition for each band is appropriate for the pixels of that particular band.</p></li>
</ul>
<p>Another example, in this case a 400x300 RGB pixel interleaved image.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VRTDataset</span><span class="w"> </span><span class="na">rasterXSize=</span><span class="s">&quot;400&quot;</span><span class="w"> </span><span class="na">rasterYSize=</span><span class="s">&quot;300&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;Byte&quot;</span><span class="w"> </span><span class="na">band=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTRawRasterBand&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ColorInterp&gt;</span>Red<span class="nt">&lt;/ColorInterp&gt;</span>
<span class="w">    </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativetoVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>rgb.raw<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">    </span><span class="nt">&lt;ImageOffset&gt;</span>0<span class="nt">&lt;/ImageOffset&gt;</span>
<span class="w">    </span><span class="nt">&lt;PixelOffset&gt;</span>3<span class="nt">&lt;/PixelOffset&gt;</span>
<span class="w">    </span><span class="nt">&lt;LineOffset&gt;</span>1200<span class="nt">&lt;/LineOffset&gt;</span>
<span class="nt">&lt;/VRTRasterBand&gt;</span>
<span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;Byte&quot;</span><span class="w"> </span><span class="na">band=</span><span class="s">&quot;2&quot;</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTRawRasterBand&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ColorInterp&gt;</span>Green<span class="nt">&lt;/ColorInterp&gt;</span>
<span class="w">    </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativetoVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>rgb.raw<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">    </span><span class="nt">&lt;ImageOffset&gt;</span>1<span class="nt">&lt;/ImageOffset&gt;</span>
<span class="w">    </span><span class="nt">&lt;PixelOffset&gt;</span>3<span class="nt">&lt;/PixelOffset&gt;</span>
<span class="w">    </span><span class="nt">&lt;LineOffset&gt;</span>1200<span class="nt">&lt;/LineOffset&gt;</span>
<span class="nt">&lt;/VRTRasterBand&gt;</span>
<span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;Byte&quot;</span><span class="w"> </span><span class="na">band=</span><span class="s">&quot;3&quot;</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTRawRasterBand&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ColorInterp&gt;</span>Blue<span class="nt">&lt;/ColorInterp&gt;</span>
<span class="w">    </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativetoVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>rgb.raw<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">    </span><span class="nt">&lt;ImageOffset&gt;</span>2<span class="nt">&lt;/ImageOffset&gt;</span>
<span class="w">    </span><span class="nt">&lt;PixelOffset&gt;</span>3<span class="nt">&lt;/PixelOffset&gt;</span>
<span class="w">    </span><span class="nt">&lt;LineOffset&gt;</span>1200<span class="nt">&lt;/LineOffset&gt;</span>
<span class="nt">&lt;/VRTRasterBand&gt;</span>
<span class="nt">&lt;/VRTDataset&gt;</span>
</pre></div>
</div>
</section>
<section id="creation-of-vrt-datasets">
<h2>Creation of VRT Datasets<a class="headerlink" href="#creation-of-vrt-datasets" title="Link to this heading"></a></h2>
<p>The VRT driver supports several methods of creating VRT datasets.
The <code class="file docutils literal notranslate"><span class="pre">vrtdataset.h</span></code> include file should be installed with the core
GDAL include files, allowing direct access to the VRT classes.  However,
even without that most capabilities remain available through standard GDAL
interfaces.</p>
<p>To create a VRT dataset that is a clone of an existing dataset use the
<code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALDriver::CreateCopy()</span></code> method.  For example to clone
<code class="file docutils literal notranslate"><span class="pre">utm.tif</span></code> into a <code class="file docutils literal notranslate"><span class="pre">wrk.vrt</span></code> file in C++ the following could be used:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">GDALDriver</span><span class="w"> </span><span class="o">*</span><span class="n">poDriver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">GDALDriver</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">GDALGetDriverByName</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;VRT&quot;</span><span class="w"> </span><span class="p">);</span>
<span class="n">GDALDataset</span><span class="w"> </span><span class="o">*</span><span class="n">poSrcDS</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">poVRTDS</span><span class="p">;</span>

<span class="n">poSrcDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">GDALDataset</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">GDALOpenShared</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;utm.tif&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">GA_ReadOnly</span><span class="w"> </span><span class="p">);</span>

<span class="n">poVRTDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poDriver</span><span class="o">-&gt;</span><span class="n">CreateCopy</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;wrk.vrt&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">poSrcDS</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">);</span>

<span class="n">GDALClose</span><span class="p">((</span><span class="n">GDALDatasetH</span><span class="p">)</span><span class="w"> </span><span class="n">poVRTDS</span><span class="p">);</span>
<span class="n">GDALClose</span><span class="p">((</span><span class="n">GDALDatasetH</span><span class="p">)</span><span class="w"> </span><span class="n">poSrcDS</span><span class="p">);</span>
</pre></div>
</div>
<p>Note the use of <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALOpenShared()</span></code> when opening the source dataset. It is advised
to use <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALOpenShared()</span></code> in this situation so that you are able to release
the explicit reference to it before closing the VRT dataset itself. In other
words, in the previous example, you could also invert the 2 last lines, whereas
if you open the source dataset with <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALOpen()</span></code>, you'd need to close the VRT dataset
before closing the source dataset.</p>
<p>To obtain the resulting VRT XML of <code class="file docutils literal notranslate"><span class="pre">wrk.vrt</span></code> without having to read the text from an actual file,
you can modify the above code to open the new dataset with an empty filename and use the &quot;xml:VRT&quot;
metadata domain.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// no filename</span>
<span class="n">poVRTDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poDriver</span><span class="o">-&gt;</span><span class="n">CreateCopy</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">poSrcDS</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">);</span>

<span class="c1">// obtain the actual XML text that a VRT file would contain</span>
<span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">xmlvrt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poVRTDS</span><span class="o">-&gt;</span><span class="n">GetMetadata</span><span class="p">(</span><span class="s">&quot;xml:VRT&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
</pre></div>
</div>
<p>To create a virtual copy of a dataset with some attributes added or changed
such as metadata or coordinate system that are often hard to change on other
formats, you might do the following.  In this case, the virtual dataset is
created &quot;in memory&quot; only by virtual of creating it with an empty filename, and
then used as a modified source to pass to a <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALDriver::CreateCopy()</span></code> written out in TIFF
format.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">poVRTDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poDriver</span><span class="o">-&gt;</span><span class="n">CreateCopy</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">poSrcDS</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">);</span>

<span class="n">poVRTDS</span><span class="o">-&gt;</span><span class="n">SetMetadataItem</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;SourceAgency&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;United States Geological Survey&quot;</span><span class="p">);</span>
<span class="n">poVRTDS</span><span class="o">-&gt;</span><span class="n">SetMetadataItem</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;SourceDate&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;July 21, 2003&quot;</span><span class="w"> </span><span class="p">);</span>

<span class="n">poVRTDS</span><span class="o">-&gt;</span><span class="n">GetRasterBand</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="o">-&gt;</span><span class="n">SetNoDataValue</span><span class="p">(</span><span class="w"> </span><span class="mf">-999.0</span><span class="w"> </span><span class="p">);</span>

<span class="n">GDALDriver</span><span class="w"> </span><span class="o">*</span><span class="n">poTIFFDriver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">GDALDriver</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">GDALGetDriverByName</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;GTiff&quot;</span><span class="w"> </span><span class="p">);</span>
<span class="n">GDALDataset</span><span class="w"> </span><span class="o">*</span><span class="n">poTiffDS</span><span class="p">;</span>

<span class="n">poTiffDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poTIFFDriver</span><span class="o">-&gt;</span><span class="n">CreateCopy</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;wrk.tif&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">poVRTDS</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">);</span>

<span class="n">GDALClose</span><span class="p">((</span><span class="n">GDALDatasetH</span><span class="p">)</span><span class="w"> </span><span class="n">poTiffDS</span><span class="p">);</span>
</pre></div>
</div>
<p>In the above example the nodata value is set as -999. You can set the
HideNoDataValue element in the VRT dataset's band using <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALRasterBand::SetMetadataItem()</span></code> on
that band.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">poVRTDS</span><span class="o">-&gt;</span><span class="n">GetRasterBand</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="o">-&gt;</span><span class="n">SetMetadataItem</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;HideNoDataValue&quot;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="p">);</span>
</pre></div>
</div>
<p>In this example a virtual dataset is created with the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALDriver::Create()</span></code> method, and
adding bands and sources programmatically, but still via the &quot;generic&quot; API.
A special attribute of VRT datasets is that sources can be added to the VRTRasterBand
(but not to VRTRawRasterBand) by passing the XML describing the source into <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALRasterBand::SetMetadataItem()</span></code> on the special
domain target &quot;new_vrt_sources&quot;.  The domain target &quot;vrt_sources&quot; may also be
used, in which case any existing sources will be discarded before adding the
new ones.  In this example we construct a simple averaging filter source
instead of using the simple source.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// construct XML for simple 3x3 average filter kernel source.</span>
<span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">pszFilterSourceXML</span><span class="w">  </span><span class="o">=</span>
<span class="s">&quot;&lt;KernelFilteredSource&gt;&quot;</span>
<span class="s">&quot;  &lt;SourceFilename&gt;utm.tif&lt;/SourceFilename&gt;&lt;SourceBand&gt;1&lt;/SourceBand&gt;&quot;</span>
<span class="s">&quot;  &lt;Kernel&gt;&quot;</span>
<span class="s">&quot;    &lt;Size&gt;3&lt;/Size&gt;&quot;</span>
<span class="s">&quot;    &lt;Coefs&gt;0.111 0.111 0.111 0.111 0.111 0.111 0.111 0.111 0.111&lt;/Coefs&gt;&quot;</span>
<span class="s">&quot;  &lt;/Kernel&gt;&quot;</span>
<span class="s">&quot;&lt;/KernelFilteredSource&gt;&quot;</span><span class="p">;</span>

<span class="c1">// Create the virtual dataset.</span>
<span class="n">poVRTDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poDriver</span><span class="o">-&gt;</span><span class="n">Create</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">512</span><span class="p">,</span><span class="w"> </span><span class="mi">512</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">GDT_Byte</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">);</span>
<span class="n">poVRTDS</span><span class="o">-&gt;</span><span class="n">GetRasterBand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">SetMetadataItem</span><span class="p">(</span><span class="s">&quot;source_0&quot;</span><span class="p">,</span><span class="n">pszFilterSourceXML</span><span class="p">,</span>
<span class="w">                                            </span><span class="s">&quot;new_vrt_sources&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>A more general form of this that will produce a 3x3 average filtered clone
of any input datasource might look like the following.  In this case we
deliberately set the filtered datasource as in the &quot;vrt_sources&quot; domain
to override the SimpleSource created by the <cite>cpp:func:`GDALDriver::CreateCopy</cite> method.  The fact
that we used <cite>cpp:func:GDALDriver::CreateCopy</cite> ensures that all the other metadata, georeferencing
and so forth is preserved from the source dataset ... the only thing we are
changing is the data source for each band.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w">   </span><span class="n">nBand</span><span class="p">;</span>
<span class="n">GDALDriver</span><span class="w"> </span><span class="o">*</span><span class="n">poDriver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">GDALDriver</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">GDALGetDriverByName</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;VRT&quot;</span><span class="w"> </span><span class="p">);</span>
<span class="n">GDALDataset</span><span class="w"> </span><span class="o">*</span><span class="n">poSrcDS</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">poVRTDS</span><span class="p">;</span>

<span class="n">poSrcDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">GDALDataset</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">GDALOpenShared</span><span class="p">(</span><span class="w"> </span><span class="n">pszSourceFilename</span><span class="p">,</span><span class="w"> </span><span class="n">GA_ReadOnly</span><span class="w"> </span><span class="p">);</span>

<span class="n">poVRTDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poDriver</span><span class="o">-&gt;</span><span class="n">CreateCopy</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">poSrcDS</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">);</span>

<span class="k">for</span><span class="p">(</span><span class="w"> </span><span class="n">nBand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">nBand</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">poVRTDS</span><span class="o">-&gt;</span><span class="n">GetRasterCount</span><span class="p">();</span><span class="w"> </span><span class="n">nBand</span><span class="o">++</span><span class="w"> </span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">szFilterSourceXML</span><span class="p">[</span><span class="mi">10000</span><span class="p">];</span>

<span class="w">    </span><span class="n">GDALRasterBand</span><span class="w"> </span><span class="o">*</span><span class="n">poBand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poVRTDS</span><span class="o">-&gt;</span><span class="n">GetRasterBand</span><span class="p">(</span><span class="w"> </span><span class="n">nBand</span><span class="w"> </span><span class="p">);</span>

<span class="w">    </span><span class="n">sprintf</span><span class="p">(</span><span class="w"> </span><span class="n">szFilterSourceXML</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;&lt;KernelFilteredSource&gt;&quot;</span>
<span class="w">        </span><span class="s">&quot;  &lt;SourceFilename&gt;%s&lt;/SourceFilename&gt;&lt;SourceBand&gt;%d&lt;/SourceBand&gt;&quot;</span>
<span class="w">        </span><span class="s">&quot;  &lt;Kernel&gt;&quot;</span>
<span class="w">        </span><span class="s">&quot;    &lt;Size&gt;3&lt;/Size&gt;&quot;</span>
<span class="w">        </span><span class="s">&quot;    &lt;Coefs&gt;0.111 0.111 0.111 0.111 0.111 0.111 0.111 0.111 0.111&lt;/Coefs&gt;&quot;</span>
<span class="w">        </span><span class="s">&quot;  &lt;/Kernel&gt;&quot;</span>
<span class="w">        </span><span class="s">&quot;&lt;/KernelFilteredSource&gt;&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">pszSourceFilename</span><span class="p">,</span><span class="w"> </span><span class="n">nBand</span><span class="w"> </span><span class="p">);</span>

<span class="w">    </span><span class="n">poBand</span><span class="o">-&gt;</span><span class="n">SetMetadataItem</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;source_0&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">szFilterSourceXML</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;vrt_sources&quot;</span><span class="w"> </span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">VRTDataset</span></code> class is one of the few dataset implementations that supports the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALDataset::AddBand()</span></code>
method. The options passed to the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALDataset::AddBand()</span></code> method can be used to control the type of the
band created (VRTRasterBand, VRTRawRasterBand, VRTDerivedRasterBand), and in the case of
the VRTRawRasterBand to set its various parameters. For standard VRTRasterBand, sources
should be specified with the above <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALRasterBand::SetMetadataItem()</span></code> examples.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">GDALDriver</span><span class="w"> </span><span class="o">*</span><span class="n">poDriver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">GDALDriver</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">GDALGetDriverByName</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;VRT&quot;</span><span class="w"> </span><span class="p">);</span>
<span class="n">GDALDataset</span><span class="w"> </span><span class="o">*</span><span class="n">poVRTDS</span><span class="p">;</span>

<span class="n">poVRTDS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poDriver</span><span class="o">-&gt;</span><span class="n">Create</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;out.vrt&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">512</span><span class="p">,</span><span class="w"> </span><span class="mi">512</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">GDT_Byte</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">);</span>
<span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">papszOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="n">papszOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CSLAddNameValue</span><span class="p">(</span><span class="n">papszOptions</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;subclass&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;VRTRawRasterBand&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// if not specified, default to VRTRasterBand</span>
<span class="n">papszOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CSLAddNameValue</span><span class="p">(</span><span class="n">papszOptions</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SourceFilename&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;src.tif&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// mandatory</span>
<span class="n">papszOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CSLAddNameValue</span><span class="p">(</span><span class="n">papszOptions</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ImageOffset&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;156&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// optional. default = 0</span>
<span class="n">papszOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CSLAddNameValue</span><span class="p">(</span><span class="n">papszOptions</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;PixelOffset&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// optional. default = size of band type</span>
<span class="n">papszOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CSLAddNameValue</span><span class="p">(</span><span class="n">papszOptions</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;LineOffset&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;1024&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// optional. default = size of band type * width</span>
<span class="n">papszOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CSLAddNameValue</span><span class="p">(</span><span class="n">papszOptions</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ByteOrder&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;LSB&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// optional. default = machine order</span>
<span class="n">papszOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CSLAddNameValue</span><span class="p">(</span><span class="n">papszOptions</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;relativeToVRT&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// optional. default = false</span>
<span class="n">poVRTDS</span><span class="o">-&gt;</span><span class="n">AddBand</span><span class="p">(</span><span class="n">GDT_Byte</span><span class="p">,</span><span class="w"> </span><span class="n">papszOptions</span><span class="p">);</span>
<span class="n">CSLDestroy</span><span class="p">(</span><span class="n">papszOptions</span><span class="p">);</span>

<span class="k">delete</span><span class="w"> </span><span class="n">poVRTDS</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="using-derived-bands-with-pixel-functions-in-c-c">
<span id="vrt-derived-bands"></span><h2>Using Derived Bands (with pixel functions in C/C++)<a class="headerlink" href="#using-derived-bands-with-pixel-functions-in-c-c" title="Link to this heading"></a></h2>
<p>A specialized type of band is a 'derived' band which derives its pixel
information from its source bands.  With this type of band you must also
specify a pixel function, which has the responsibility of generating the
output raster.  Pixel functions are created by an application and then
registered with GDAL using a unique key.</p>
<p>Using derived bands you can create VRT datasets that manipulate bands on
the fly without having to create new band files on disk.  For example, you
might want to generate a band using four source bands from a nine band input
dataset (x0, x3, x4, and x8) and some constant y:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">band_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">((</span><span class="n">x3</span><span class="o">*</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="o">*</span><span class="n">x4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x0</span><span class="o">*</span><span class="n">x8</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
</pre></div>
</div>
<p>You could write the pixel function to compute this value and then register
it with GDAL with the name &quot;MyFirstFunction&quot;.  Then, the following VRT XML
could be used to display this derived band:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VRTDataset</span><span class="w"> </span><span class="na">rasterXSize=</span><span class="s">&quot;1000&quot;</span><span class="w"> </span><span class="na">rasterYSize=</span><span class="s">&quot;1000&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;Float32&quot;</span><span class="w"> </span><span class="na">band=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTDerivedRasterBand&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Description&gt;</span>Magnitude<span class="nt">&lt;/Description&gt;</span>
<span class="w">        </span><span class="nt">&lt;PixelFunctionType&gt;</span>MyFirstFunction<span class="nt">&lt;/PixelFunctionType&gt;</span>
<span class="w">        </span><span class="nt">&lt;PixelFunctionArguments</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;4&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;SimpleSource&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>nine_band.dat<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceBand&gt;</span>1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">            </span><span class="nt">&lt;SrcRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;1000&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;1000&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;DstRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;1000&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;1000&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SimpleSource&gt;</span>
<span class="w">        </span><span class="nt">&lt;SimpleSource&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>nine_band.dat<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceBand&gt;</span>4<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">            </span><span class="nt">&lt;SrcRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;1000&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;1000&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;DstRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;1000&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;1000&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SimpleSource&gt;</span>
<span class="w">        </span><span class="nt">&lt;SimpleSource&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>nine_band.dat<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceBand&gt;</span>5<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">            </span><span class="nt">&lt;SrcRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;1000&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;1000&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;DstRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;1000&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;1000&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SimpleSource&gt;</span>
<span class="w">        </span><span class="nt">&lt;SimpleSource&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>nine_band.dat<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceBand&gt;</span>9<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">            </span><span class="nt">&lt;SrcRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;1000&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;1000&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;DstRect</span><span class="w"> </span><span class="na">xOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">yOff=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">xSize=</span><span class="s">&quot;1000&quot;</span><span class="w"> </span><span class="na">ySize=</span><span class="s">&quot;1000&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SimpleSource&gt;</span>
<span class="w">    </span><span class="nt">&lt;/VRTRasterBand&gt;</span>
<span class="nt">&lt;/VRTDataset&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>PixelFunctionArguments can only be used with C++ pixel functions in GDAL versions 3.4 and greater.</p>
</div>
<p>In addition to the subclass specification (VRTDerivedRasterBand) and
the PixelFunctionType value, there is another new parameter that can come
in handy: SourceTransferType.  Typically the source rasters are obtained
using the data type of the derived band.  There might be times,
however, when you want the pixel function to have access to
higher resolution source data than the data type being generated.
For example, you might have a derived band of type &quot;Float&quot;, which takes
a single source of type &quot;CFloat32&quot; or &quot;CFloat64&quot;, and returns the imaginary
portion.  To accomplish this, set the SourceTransferType to &quot;CFloat64&quot;.
Otherwise the source would be converted to &quot;Float&quot; prior to
calling the pixel function, and the imaginary portion would be lost.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VRTDataset</span><span class="w"> </span><span class="na">rasterXSize=</span><span class="s">&quot;1000&quot;</span><span class="w"> </span><span class="na">rasterYSize=</span><span class="s">&quot;1000&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;Float32&quot;</span><span class="w"> </span><span class="na">band=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTDerivedRasterBand&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Description&gt;</span>Magnitude<span class="nt">&lt;/Description&gt;</span>
<span class="w">        </span><span class="nt">&lt;PixelFunctionType&gt;</span>MyFirstFunction<span class="nt">&lt;/PixelFunctionType&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceTransferType&gt;</span>CFloat64<span class="nt">&lt;/SourceTransferType&gt;</span>
<span class="w">        </span>...
</pre></div>
</div>
<section id="default-pixel-functions">
<h3>Default Pixel Functions<a class="headerlink" href="#default-pixel-functions" title="Link to this heading"></a></h3>
<p>GDAL provides a set of default pixel functions that can be used without writing new code:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15.0%" />
<col style="width: 10.0%" />
<col style="width: 20.0%" />
<col style="width: 55.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>PixelFunctionType</p></th>
<th class="head"><p>Number of input sources</p></th>
<th class="head"><p>PixelFunctionArguments</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>cmul</strong></p></td>
<td><p>2</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>multiply the first band for the complex conjugate of the second</p></td>
</tr>
<tr class="row-odd"><td><p><strong>complex</strong></p></td>
<td><p>2</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>make a complex band merging two bands used as real and imag values</p></td>
</tr>
<tr class="row-even"><td><p><strong>conj</strong></p></td>
<td><p>1</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>computes the complex conjugate of a single raster band (just a copy if the input is non-complex)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>dB</strong></p></td>
<td><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fact</span></code> (optional)</p></td>
<td><p>perform conversion to dB of the abs of a single raster band (real or complex): <code class="docutils literal notranslate"><span class="pre">20.</span> <span class="pre">*</span> <span class="pre">log10(</span> <span class="pre">abs(</span> <span class="pre">x</span> <span class="pre">)</span> <span class="pre">)</span></code>. The optional <code class="docutils literal notranslate"><span class="pre">fact</span></code> parameter can be set to <code class="docutils literal notranslate"><span class="pre">10</span></code> to get the alternative formula: <code class="docutils literal notranslate"><span class="pre">10.</span> <span class="pre">*</span> <span class="pre">log10(</span> <span class="pre">abs(</span> <span class="pre">x</span> <span class="pre">)</span> <span class="pre">)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>dB2amp</strong></p></td>
<td><p>1</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>perform scale conversion from logarithmic to linear (amplitude) (i.e. <code class="docutils literal notranslate"><span class="pre">10</span> <span class="pre">^</span> <span class="pre">(</span> <span class="pre">x</span> <span class="pre">/</span> <span class="pre">20</span> <span class="pre">)</span></code> ) of a single raster band (real only). Deprecated in GDAL v3.5. Please use the <code class="docutils literal notranslate"><span class="pre">exp</span></code> pixel function with <code class="docutils literal notranslate"><span class="pre">base</span> <span class="pre">=</span> <span class="pre">10.</span></code> and <code class="docutils literal notranslate"><span class="pre">fact</span> <span class="pre">=</span> <span class="pre">0.05</span></code> i.e. <code class="docutils literal notranslate"><span class="pre">1./20</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>dB2pow</strong></p></td>
<td><p>1</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>perform scale conversion from logarithmic to linear (power) (i.e. <code class="docutils literal notranslate"><span class="pre">10</span> <span class="pre">^</span> <span class="pre">(</span> <span class="pre">x</span> <span class="pre">/</span> <span class="pre">10</span> <span class="pre">)</span></code> ) of a single raster band (real only). Deprecated in GDAL v3.5. Please use the <code class="docutils literal notranslate"><span class="pre">exp</span></code> pixel function with <code class="docutils literal notranslate"><span class="pre">base</span> <span class="pre">=</span> <span class="pre">10.</span></code> and <code class="docutils literal notranslate"><span class="pre">fact</span> <span class="pre">=</span> <span class="pre">0.1</span></code> i.e. <code class="docutils literal notranslate"><span class="pre">1./10</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>diff</strong></p></td>
<td><p>2</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>computes the difference between 2 raster bands (<code class="docutils literal notranslate"><span class="pre">b1</span> <span class="pre">-</span> <span class="pre">b2</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>div</strong></p></td>
<td><p>2</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>divide one raster band by another (<code class="docutils literal notranslate"><span class="pre">b1</span> <span class="pre">/</span> <span class="pre">b2</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><strong>norm_diff</strong></p></td>
<td><p>2</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>computes the normalized difference between two raster bands: <code class="docutils literal notranslate"><span class="pre">(b1</span> <span class="pre">-</span> <span class="pre">b2)/(b1</span> <span class="pre">+</span> <span class="pre">b2)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>exp</strong></p></td>
<td><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">base</span></code> (optional), <code class="docutils literal notranslate"><span class="pre">fact</span></code> (optional)</p></td>
<td><p>computes the exponential of each element in the input band <code class="docutils literal notranslate"><span class="pre">x</span></code> (of real values): <code class="docutils literal notranslate"><span class="pre">e</span> <span class="pre">^</span> <span class="pre">x</span></code>. The function also accepts two optional parameters: <code class="docutils literal notranslate"><span class="pre">base</span></code> and <code class="docutils literal notranslate"><span class="pre">fact</span></code> that allow to compute the generalized formula: <code class="docutils literal notranslate"><span class="pre">base</span> <span class="pre">^</span> <span class="pre">(</span> <span class="pre">fact</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">)</span></code>. Note: this function is the recommended one to perform conversion form logarithmic scale (dB): `` 10. ^ (x / 20.)``, in this case <code class="docutils literal notranslate"><span class="pre">base</span> <span class="pre">=</span> <span class="pre">10.</span></code> and <code class="docutils literal notranslate"><span class="pre">fact</span> <span class="pre">=</span> <span class="pre">0.05</span></code> i.e. <code class="docutils literal notranslate"><span class="pre">1.</span> <span class="pre">/</span> <span class="pre">20</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>imag</strong></p></td>
<td><p>1</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>extract imaginary part from a single raster band (0 for non-complex)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>intensity</strong></p></td>
<td><p>1</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>computes the intensity <code class="docutils literal notranslate"><span class="pre">Re(</span> <span class="pre">x</span> <span class="pre">*</span> <span class="pre">conj(x)</span> <span class="pre">)</span></code> of a single raster band (real or complex)</p></td>
</tr>
<tr class="row-even"><td><p><strong>interpolate_exp</strong></p></td>
<td><p>&gt;= 2</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">t0</span></code>, <code class="docutils literal notranslate"><span class="pre">dt</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code></p></td>
<td><p>interpolate a value at time (or position) <code class="docutils literal notranslate"><span class="pre">t</span></code> given input sources beginning at position <code class="docutils literal notranslate"><span class="pre">t0</span></code> with spacing <code class="docutils literal notranslate"><span class="pre">dt</span></code> using exponential interpolation</p></td>
</tr>
<tr class="row-odd"><td><p><strong>interpolate_linear</strong></p></td>
<td><p>&gt;= 2</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">t0</span></code>, <code class="docutils literal notranslate"><span class="pre">dt</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code></p></td>
<td><p>interpolate a value at time (or position) <code class="docutils literal notranslate"><span class="pre">t</span></code> given input sources beginning at <code class="docutils literal notranslate"><span class="pre">t0</span></code> with spacing <code class="docutils literal notranslate"><span class="pre">dt</span></code> using linear interpolation</p></td>
</tr>
<tr class="row-even"><td><p><strong>inv</strong></p></td>
<td><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">k</span></code> (optional)</p></td>
<td><p>inverse (<code class="docutils literal notranslate"><span class="pre">1./x</span></code>). If the optional <code class="docutils literal notranslate"><span class="pre">k</span></code> parameter is set then the result is multiplied by <code class="docutils literal notranslate"><span class="pre">k</span></code> (<code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">/</span> <span class="pre">x</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>log10</strong></p></td>
<td><p>1</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>compute the logarithm (base 10) of the abs of a single raster band (real or complex): <code class="docutils literal notranslate"><span class="pre">log10(</span> <span class="pre">abs(</span> <span class="pre">x</span> <span class="pre">)</span> <span class="pre">)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>max</strong></p></td>
<td><p>&gt;= 2</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">propagateNoData</span></code> (optional)</p></td>
<td><p>(GDAL &gt;= 3.8) maximum of 2 or more raster bands, ignoring by default pixels at nodata. If the optional <code class="docutils literal notranslate"><span class="pre">propagateNoData</span></code> parameter is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, then if a nodata pixel is found in one of the bands, if will be propagated to the output value.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>min</strong></p></td>
<td><p>&gt;= 2</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">propagateNoData</span></code> (optional)</p></td>
<td><p>(GDAL &gt;= 3.8) minimum of 2 or more raster bands, ignoring by default pixels at nodata. If the optional <code class="docutils literal notranslate"><span class="pre">propagateNoData</span></code> parameter is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, then if a nodata pixel is found in one of the bands, if will be propagated to the output value.</p></td>
</tr>
<tr class="row-even"><td><p><strong>mod</strong></p></td>
<td><p>1</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>extract module from a single raster band (real or complex)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>mul</strong></p></td>
<td><p>&gt;= 2</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">k</span></code> (optional)</p></td>
<td><p>multiply 2 or more raster bands. If the optional <code class="docutils literal notranslate"><span class="pre">k</span></code> parameter is provided then the result is multiplied by the scalar <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>phase</strong></p></td>
<td><p>1</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>extract phase from a single raster band [-PI,PI] (0 or PI for non-complex)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>polar</strong></p></td>
<td><p>2</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">amplitude_type</span></code> (optional)</p></td>
<td><p>make a complex band using input bands for amplitude and phase values <code class="docutils literal notranslate"><span class="pre">b1</span> <span class="pre">*</span> <span class="pre">exp(</span> <span class="pre">j</span> <span class="pre">*</span> <span class="pre">b2</span> <span class="pre">)</span></code>. The optional (string) parameter <code class="docutils literal notranslate"><span class="pre">amplitude_type</span></code> can be <code class="docutils literal notranslate"><span class="pre">AMPLITUDE</span></code> (default) <code class="docutils literal notranslate"><span class="pre">INTENSITY</span></code> or <code class="docutils literal notranslate"><span class="pre">dB</span></code>. Note: if <code class="docutils literal notranslate"><span class="pre">amplitude_type</span></code> is set to <code class="docutils literal notranslate"><span class="pre">INTENSITY</span></code> then negative values are clipped to zero.</p></td>
</tr>
<tr class="row-even"><td><p><strong>pow</strong></p></td>
<td><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">power</span></code></p></td>
<td><p>raise a single raster band to a constant power, specified with argument <code class="docutils literal notranslate"><span class="pre">power</span></code> (real only)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>real</strong></p></td>
<td><p>1</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>extract real part from a single raster band (just a copy if the input is non-complex)</p></td>
</tr>
<tr class="row-even"><td><p><strong>sqrt</strong></p></td>
<td><p>1</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>perform the square root of a single raster band (real only)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>sum</strong></p></td>
<td><p>&gt;= 2</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">k</span></code> (optional)</p></td>
<td><p>sum 2 or more raster bands. If the optional <code class="docutils literal notranslate"><span class="pre">k</span></code> parameter is provided then it is added to each element of the result</p></td>
</tr>
<tr class="row-even"><td><p><strong>replace_nodata</strong></p></td>
<td><p>= 1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">to</span></code> (optional)</p></td>
<td><p>convert incoming <code class="docutils literal notranslate"><span class="pre">NoData</span></code> values to a new value, IEEE 754 <cite>nan</cite> by default</p></td>
</tr>
<tr class="row-odd"><td><p><strong>scale</strong></p></td>
<td><p>= 1</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>perform scaling according to the <code class="docutils literal notranslate"><span class="pre">offset</span></code> and <code class="docutils literal notranslate"><span class="pre">scale</span></code> values of the raster band</p></td>
</tr>
</tbody>
</table>
</section>
<section id="writing-pixel-functions">
<h3>Writing Pixel Functions<a class="headerlink" href="#writing-pixel-functions" title="Link to this heading"></a></h3>
<p>To register this function with GDAL (prior to accessing any VRT datasets
with derived bands that use this function), an application calls
<code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALAddDerivedBandPixelFuncWithArgs()</span></code> with a key and a <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">GDALDerivedPixelFuncWithArgs</span></code>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">pszMetadata</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span>
<span class="s">&quot;&lt;PixelFunctionArgumentsList&gt;&quot;</span>
<span class="s">&quot;   &lt;Argument name=&#39;y&#39; description=&#39;y&#39; type=&#39;double&#39; mandatory=&#39;1&#39; /&gt;&quot;</span>
<span class="s">&quot;   &lt;Argument type=&#39;builtin&#39; value=&#39;offset&#39; /&gt;&quot;</span>
<span class="s">&quot;   &lt;Argument type=&#39;builtin&#39; value=&#39;scale&#39; /&gt;&quot;</span>
<span class="s">&quot;   &lt;Argument type=&#39;builtin&#39; value=&#39;NoData&#39; /&gt;&quot;</span>
<span class="s">&quot;   &lt;Argument name=&#39;customConstant&#39; type=&#39;constant&#39; value=&#39;42&#39;&gt;&quot;</span>
<span class="s">&quot;&lt;/PixelFunctionArgumentsList&gt;&quot;</span><span class="p">;</span>
<span class="n">GDALAddDerivedBandPixelFuncWithArgs</span><span class="p">(</span><span class="s">&quot;MyFirstFunction&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">TestFunction</span><span class="p">,</span><span class="w"> </span><span class="n">pszMetadata</span><span class="p">);</span>
</pre></div>
</div>
<p>A good time to do this is at the beginning of an application when the
GDAL drivers are registered. <code class="docutils literal notranslate"><span class="pre">pszMetadata</span></code> is optional and can be <code class="docutils literal notranslate"><span class="pre">nullptr</span></code>.
It can be used to declare the function signature to the user and to request additional
parameters aside from the ones from the Dataset.</p>
<p>A <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">GDALDerivedPixelFuncWithArgs</span></code> is defined with a signature similar to <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALRasterBand::IRasterIO()</span></code>:</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412TestFunctionPPviPvii12GDALDataType12GDALDataTypeii12CSLConstList">
<span id="_CPPv312TestFunctionPPviPvii12GDALDataType12GDALDataTypeii12CSLConstList"></span><span id="_CPPv212TestFunctionPPviPvii12GDALDataType12GDALDataTypeii12CSLConstList"></span><span id="TestFunction__voidPP.i.voidP.i.i.GDALDataType.GDALDataType.i.i.CSLConstList"></span><span class="n"><span class="pre">CPLErr</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TestFunction</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">papoSources</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nSources</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pData</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nBufXSize</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nBufYSize</span></span>, <span class="n"><span class="pre">GDALDataType</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">eSrcType</span></span>, <span class="n"><span class="pre">GDALDataType</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">eBufType</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nPixelSpace</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nLineSpace</span></span>, <span class="n"><span class="pre">CSLConstList</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">papszArgs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412TestFunctionPPviPvii12GDALDataType12GDALDataTypeii12CSLConstList" title="Link to this definition"></a><br /></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">パラメータ<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>papoSources</strong> -- A pointer to packed rasters; one per source.  The
datatype of all will be the same, specified in the <code class="docutils literal notranslate"><span class="pre">eSrcType</span></code> parameter.</p></li>
<li><p><strong>nSources</strong> -- The number of source rasters.</p></li>
<li><p><strong>pData</strong> -- The buffer into which the data should be read, or from which
it should be written.  This buffer must contain at least <code class="docutils literal notranslate"><span class="pre">nBufXSize</span> <span class="pre">*</span>
<span class="pre">nBufYSize</span></code> words of type eBufType.  It is organized in left to right, top
to bottom pixel order.  Spacing is controlled by the <code class="docutils literal notranslate"><span class="pre">nPixelSpace</span></code> and
<code class="docutils literal notranslate"><span class="pre">nLineSpace</span></code> parameters.</p></li>
<li><p><strong>nBufXSize</strong> -- The width of the buffer image into which the desired
region is to be read, or from which it is to be written.</p></li>
<li><p><strong>nBufYSize</strong> -- The height of the buffer image into which the desired
region is to be read, or from which it is to be written.</p></li>
<li><p><strong>eSrcType</strong> -- The type of the pixel values in the <code class="docutils literal notranslate"><span class="pre">papoSources</span></code> raster
array.</p></li>
<li><p><strong>eBufType</strong> -- The type of the pixel values that the pixel function must
generate in the <code class="docutils literal notranslate"><span class="pre">pData</span></code> data buffer.</p></li>
<li><p><strong>nPixelSpace</strong> -- The byte offset from the start of one pixel value in
<code class="docutils literal notranslate"><span class="pre">pData</span></code> to the start of the next pixel value within a scanline.  If
defaulted (0) the size of the datatype eBufType is used.</p></li>
<li><p><strong>nLineSpace</strong> -- The byte offset from the start of one scanline in
pData to the start of the next.</p></li>
<li><p><strong>papszArgs</strong> -- An optional string list of named function arguments (e.g. <code class="docutils literal notranslate"><span class="pre">y=4</span></code>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p>It is also possible to register a <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">GDALDerivedPixelFunc</span></code> (which omits the final <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">CSLConstList</span></code> argument) using <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALAddDerivedBandPixelFunc()</span></code>.</p>
<p>The following is an implementation of the pixel function:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;gdal.h&quot;</span>

<span class="n">CPLErr</span><span class="w"> </span><span class="nf">TestFunction</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">**</span><span class="n">papoSources</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">nSources</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pData</span><span class="p">,</span>
<span class="w">                    </span><span class="kt">int</span><span class="w"> </span><span class="n">nXSize</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">nYSize</span><span class="p">,</span>
<span class="w">                    </span><span class="n">GDALDataType</span><span class="w"> </span><span class="n">eSrcType</span><span class="p">,</span><span class="w"> </span><span class="n">GDALDataType</span><span class="w"> </span><span class="n">eBufType</span><span class="p">,</span>
<span class="w">                    </span><span class="kt">int</span><span class="w"> </span><span class="n">nPixelSpace</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">nLineSpace</span><span class="p">,</span>
<span class="w">                    </span><span class="n">CSLConstList</span><span class="w"> </span><span class="n">papszArgs</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ii</span><span class="p">,</span><span class="w"> </span><span class="n">iLine</span><span class="p">,</span><span class="w"> </span><span class="n">iCol</span><span class="p">;</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">pix_val</span><span class="p">;</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">x0</span><span class="p">,</span><span class="w"> </span><span class="n">x3</span><span class="p">,</span><span class="w"> </span><span class="n">x4</span><span class="p">,</span><span class="w"> </span><span class="n">x8</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// ---- Init ----</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nSources</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">CE_Failure</span><span class="p">;</span>

<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">pszY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CSLFetchNameValue</span><span class="p">(</span><span class="n">papszArgs</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;y&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pszY</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">CE_Failure</span><span class="p">;</span>

<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">NoData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NAN</span><span class="p">;</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">pszNoData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CSLFetchNameValue</span><span class="p">(</span><span class="n">papszArgs</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NoData&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pszNoData</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">NoData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">strtod</span><span class="p">(</span><span class="n">pszNoData</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">end</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">end</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">pszNoData</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">CE_Failure</span><span class="p">;</span><span class="w"> </span><span class="c1">// Could not parse</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">strtod</span><span class="p">(</span><span class="n">pszY</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">end</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">end</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">pszY</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">CE_Failure</span><span class="p">;</span><span class="w"> </span><span class="c1">// Could not parse</span>

<span class="w">    </span><span class="c1">// ---- Set pixels ----</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="w"> </span><span class="n">iLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iLine</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nYSize</span><span class="p">;</span><span class="w"> </span><span class="n">iLine</span><span class="o">++</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="w"> </span><span class="n">iCol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iCol</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nXSize</span><span class="p">;</span><span class="w"> </span><span class="n">iCol</span><span class="o">++</span><span class="w"> </span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iLine</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nXSize</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">iCol</span><span class="p">;</span>
<span class="w">            </span><span class="cm">/* Source raster pixels may be obtained with SRCVAL macro */</span>
<span class="w">            </span><span class="n">x0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SRCVAL</span><span class="p">(</span><span class="n">papoSources</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">eSrcType</span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="p">);</span>
<span class="w">            </span><span class="n">x3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SRCVAL</span><span class="p">(</span><span class="n">papoSources</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">eSrcType</span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="p">);</span>
<span class="w">            </span><span class="n">x4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SRCVAL</span><span class="p">(</span><span class="n">papoSources</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">eSrcType</span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="p">);</span>
<span class="w">            </span><span class="n">x8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SRCVAL</span><span class="p">(</span><span class="n">papoSources</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="n">eSrcType</span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="p">);</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x0</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NoData</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">x3</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NoData</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">x4</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NoData</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">x8</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NoData</span><span class="p">)</span>
<span class="w">                </span><span class="n">pix_val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NAN</span><span class="p">;</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="n">pix_val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">((</span><span class="n">x3</span><span class="o">*</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="o">*</span><span class="n">x4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x0</span><span class="o">*</span><span class="n">x8</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>

<span class="w">            </span><span class="n">GDALCopyWords</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pix_val</span><span class="p">,</span><span class="w"> </span><span class="n">GDT_Float64</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">                        </span><span class="p">((</span><span class="n">GByte</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">pData</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nLineSpace</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">iLine</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">iCol</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nPixelSpace</span><span class="p">,</span>
<span class="w">                        </span><span class="n">eBufType</span><span class="p">,</span><span class="w"> </span><span class="n">nPixelSpace</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// ---- Return success ----</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">CE_None</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="using-derived-bands-with-pixel-functions-in-python">
<h2>Using Derived Bands (with pixel functions in Python)<a class="headerlink" href="#using-derived-bands-with-pixel-functions-in-python" title="Link to this heading"></a></h2>
<p>Starting with GDAL 2.2, in addition to pixel functions written in C/C++ as
documented in the <a class="reference internal" href="#vrt-derived-bands"><span class="std std-ref">Using Derived Bands (with pixel functions in C/C++)</span></a> section, it is possible to use
pixel functions written in Python. Both <a class="reference external" href="https://www.python.org/">CPython</a>
and <a class="reference external" href="http://www.numpy.org/">NumPy</a> are requirements at run-time.</p>
<p>The subelements for VRTRasterBand (whose subclass specification must be
set to VRTDerivedRasterBand) are :</p>
<ul class="simple">
<li><p><strong>PixelFunctionType</strong> (required): Must be set to a function name that will be defined as a inline Python module in PixelFunctionCode element or as the form &quot;module_name.function_name&quot; to refer to a function in an external Python module</p></li>
<li><p><strong>PixelFunctionLanguage</strong> (required): Must be set to Python.</p></li>
<li><p><strong>PixelFunctionCode</strong> (required if PixelFunctionType is of the form &quot;function_name&quot;, ignored otherwise). The in-lined code of a Python module, that must be at least have a function whose name is given by PixelFunctionType.</p></li>
<li><p><strong>BufferRadius</strong> (optional, defaults to 0): Amount of extra pixels, with respect to the original RasterIO() request to satisfy, that are fetched at the left, right, bottom and top of the input and output buffers passed to the pixel function. Note that the values of the output buffer in this buffer zone willbe ignored.</p></li>
<li><p><strong>SkipNonContributingSources</strong> (optional, added in GDAL 3.7, defaults to false) = true/false: Whether sources that do not intersect the VRTRasterBand RasterIO() requested region should be omitted. By default, data for all sources, including ones that do not intersect it, are passed to the pixel function. By setting this parameter to false, only sources that intersect the requested region will be passed.</p></li>
</ul>
<p>The signature of the Python pixel function must have the following arguments:</p>
<ul class="simple">
<li><p><strong>in_ar</strong>: list of input NumPy arrays. One NumPy array for each source. If SkipNonContributingSources=true, only contributing sources will be passed.</p></li>
<li><p><strong>out_ar</strong>: output NumPy array to fill. The array is initialized at the right dimensions and with the VRTRasterBand.dataType.</p></li>
<li><p><strong>xoff</strong>: pixel offset to the top left corner of the accessed region of the band. Generally not needed except if the processing depends on the pixel position in the raster.</p></li>
<li><p><strong>yoff</strong> line offset to the top left corner of the accessed region of the band. Generally not needed.</p></li>
<li><p><strong>xsize</strong>: width of the region of the accessed region of the band. Can be used together with out_ar.shape[1] to determine the horizontal resampling ratio of the request.</p></li>
<li><p><strong>ysize</strong>: height of the region of the accessed region of the band. Can be used together with out_ar.shape[0] to determine the vertical resampling ratio of the request.</p></li>
<li><p><strong>raster_xsize</strong>: total width of the raster band. Generally not needed.</p></li>
<li><p><strong>raster_ysize</strong>: total height of the raster band. Generally not needed.</p></li>
<li><p><strong>buf_radius</strong>: radius of the buffer (in pixels) added to the left, right, top and bottom of in_ar / out_ar. This is the value of the optional BufferRadius element that can be set so that the original pixel request is extended by a given amount of pixels.</p></li>
<li><p><strong>gt</strong>: geotransform. Array of 6 double values.</p></li>
<li><p><strong>kwargs</strong>: dictionary with user arguments defined in PixelFunctionArguments</p></li>
</ul>
<p>The provided <code class="docutils literal notranslate"><span class="pre">out_ar</span></code> array must be modified in-place. Any value currently
returned by the pixel function is ignored.</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>If wanting to fill <code class="docutils literal notranslate"><span class="pre">out_ar</span></code> from another array, use the <code class="docutils literal notranslate"><span class="pre">out_ar[:]</span> <span class="pre">=</span> <span class="pre">...</span></code>
syntax.</p>
</div>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h3>
<section id="vrt-that-multiplies-the-values-of-the-source-file-by-a-factor-of-1-5">
<h4>VRT that multiplies the values of the source file by a factor of 1.5<a class="headerlink" href="#vrt-that-multiplies-the-values-of-the-source-file-by-a-factor-of-1-5" title="Link to this heading"></a></h4>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VRTDataset</span><span class="w"> </span><span class="na">rasterXSize=</span><span class="s">&quot;20&quot;</span><span class="w"> </span><span class="na">rasterYSize=</span><span class="s">&quot;20&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;SRS&gt;</span>EPSG:26711<span class="nt">&lt;/SRS&gt;</span>
<span class="w">    </span><span class="nt">&lt;GeoTransform&gt;</span>440720,60,0,3751320,0,-60<span class="nt">&lt;/GeoTransform&gt;</span>
<span class="w">    </span><span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;Byte&quot;</span><span class="w"> </span><span class="na">band=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTDerivedRasterBand&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;PixelFunctionType&gt;</span>multiply<span class="nt">&lt;/PixelFunctionType&gt;</span>
<span class="w">        </span><span class="nt">&lt;PixelFunctionLanguage&gt;</span>Python<span class="nt">&lt;/PixelFunctionLanguage&gt;</span>
<span class="w">        </span><span class="nt">&lt;PixelFunctionArguments</span><span class="w"> </span><span class="na">factor=</span><span class="s">&quot;1.5&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;PixelFunctionCode&gt;</span><span class="cp">&lt;![CDATA[</span>
<span class="cp">            import numpy as np</span>
<span class="cp">            def multiply(in_ar, out_ar, xoff, yoff, xsize, ysize, raster_xsize,</span>
<span class="cp">                            raster_ysize, buf_radius, gt, **kwargs):</span>
<span class="cp">                factor = float(kwargs[&#39;factor&#39;])</span>
<span class="cp">                out_ar[:] = np.round_(np.clip(in_ar[0] * factor,0,255))</span>
<span class="cp">            ]]&gt;</span>
<span class="w">        </span><span class="nt">&lt;/PixelFunctionCode&gt;</span>
<span class="w">        </span><span class="nt">&lt;SimpleSource&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>byte.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SimpleSource&gt;</span>
<span class="w">    </span><span class="nt">&lt;/VRTRasterBand&gt;</span>
<span class="nt">&lt;/VRTDataset&gt;</span>
</pre></div>
</div>
</section>
<section id="vrt-that-adds-2-or-more-rasters">
<h4>VRT that adds 2 (or more) rasters<a class="headerlink" href="#vrt-that-adds-2-or-more-rasters" title="Link to this heading"></a></h4>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VRTDataset</span><span class="w"> </span><span class="na">rasterXSize=</span><span class="s">&quot;20&quot;</span><span class="w"> </span><span class="na">rasterYSize=</span><span class="s">&quot;20&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;SRS&gt;</span>EPSG:26711<span class="nt">&lt;/SRS&gt;</span>
<span class="w">    </span><span class="nt">&lt;GeoTransform&gt;</span>440720,60,0,3751320,0,-60<span class="nt">&lt;/GeoTransform&gt;</span>
<span class="w">    </span><span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;Byte&quot;</span><span class="w"> </span><span class="na">band=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTDerivedRasterBand&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;PixelFunctionType&gt;</span>add<span class="nt">&lt;/PixelFunctionType&gt;</span>
<span class="w">        </span><span class="nt">&lt;PixelFunctionLanguage&gt;</span>Python<span class="nt">&lt;/PixelFunctionLanguage&gt;</span>
<span class="w">        </span><span class="nt">&lt;PixelFunctionCode&gt;</span><span class="cp">&lt;![CDATA[</span>
<span class="cp">            import numpy as np</span>
<span class="cp">            def add(in_ar, out_ar, xoff, yoff, xsize, ysize, raster_xsize,</span>
<span class="cp">                            raster_ysize, buf_radius, gt, **kwargs):</span>
<span class="cp">                np.round_(np.clip(np.sum(in_ar, axis = 0, dtype = &#39;uint16&#39;),0,255),</span>
<span class="cp">                        out = out_ar)</span>
<span class="cp">            ]]&gt;</span>
<span class="w">        </span><span class="nt">&lt;/PixelFunctionCode&gt;</span>
<span class="w">        </span><span class="nt">&lt;SimpleSource&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>byte.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SimpleSource&gt;</span>
<span class="w">        </span><span class="nt">&lt;SimpleSource&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>byte2.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SimpleSource&gt;</span>
<span class="w">    </span><span class="nt">&lt;/VRTRasterBand&gt;</span>
<span class="nt">&lt;/VRTDataset&gt;</span>
</pre></div>
</div>
</section>
<section id="vrt-that-computes-hillshading-using-an-external-library">
<h4>VRT that computes hillshading using an external library<a class="headerlink" href="#vrt-that-computes-hillshading-using-an-external-library" title="Link to this heading"></a></h4>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VRTDataset</span><span class="w"> </span><span class="na">rasterXSize=</span><span class="s">&quot;121&quot;</span><span class="w"> </span><span class="na">rasterYSize=</span><span class="s">&quot;121&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;SRS&gt;</span>EPSG:4326<span class="nt">&lt;/SRS&gt;</span>
<span class="w">    </span><span class="nt">&lt;GeoTransform&gt;</span>-80.004166666666663,0.008333333333333,0,
<span class="w">    </span>44.004166666666663,0,-0.008333333333333<span class="nt">&lt;/GeoTransform&gt;</span>
<span class="w">    </span><span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;Byte&quot;</span><span class="w"> </span><span class="na">band=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTDerivedRasterBand&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ColorInterp&gt;</span>Gray<span class="nt">&lt;/ColorInterp&gt;</span>
<span class="w">        </span><span class="nt">&lt;SimpleSource&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>n43.dt0<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SimpleSource&gt;</span>
<span class="w">        </span><span class="nt">&lt;PixelFunctionLanguage&gt;</span>Python<span class="nt">&lt;/PixelFunctionLanguage&gt;</span>
<span class="w">        </span><span class="nt">&lt;PixelFunctionType&gt;</span>hillshading.hillshade<span class="nt">&lt;/PixelFunctionType&gt;</span>
<span class="w">        </span><span class="nt">&lt;PixelFunctionArguments</span><span class="w"> </span><span class="na">scale=</span><span class="s">&quot;111120&quot;</span><span class="w"> </span><span class="na">z_factor=</span><span class="s">&quot;30&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;BufferRadius&gt;</span>1<span class="nt">&lt;/BufferRadius&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceTransferType&gt;</span>Int16<span class="nt">&lt;/SourceTransferType&gt;</span>
<span class="w">    </span><span class="nt">&lt;/VRTRasterBand&gt;</span>
<span class="nt">&lt;/VRTDataset&gt;</span>
</pre></div>
</div>
<p>with hillshading.py:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Licence: MIT</span>
<span class="c1"># Copyright 2016, Even Rouault</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="k">def</span> <span class="nf">hillshade_int</span><span class="p">(</span><span class="n">in_ar</span><span class="p">,</span> <span class="n">out_ar</span><span class="p">,</span> <span class="n">xoff</span><span class="p">,</span> <span class="n">yoff</span><span class="p">,</span> <span class="n">xsize</span><span class="p">,</span> <span class="n">ysize</span><span class="p">,</span> <span class="n">raster_xsize</span><span class="p">,</span>
                        <span class="n">raster_ysize</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">gt</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
    <span class="n">ovr_scale_x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">out_ar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">radius</span><span class="p">)</span> <span class="o">/</span> <span class="n">xsize</span>
    <span class="n">ovr_scale_y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">out_ar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">radius</span><span class="p">)</span> <span class="o">/</span> <span class="n">ysize</span>
    <span class="n">ewres</span> <span class="o">=</span> <span class="n">gt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">ovr_scale_x</span>
    <span class="n">nsres</span> <span class="o">=</span> <span class="n">gt</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">/</span> <span class="n">ovr_scale_y</span>
    <span class="n">inv_nsres</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">nsres</span>
    <span class="n">inv_ewres</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">ewres</span>

    <span class="n">az</span> <span class="o">=</span> <span class="mi">315</span>
    <span class="n">alt</span> <span class="o">=</span> <span class="mi">45</span>
    <span class="n">degreesToRadians</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>

    <span class="n">sin_alt</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alt</span> <span class="o">*</span> <span class="n">degreesToRadians</span><span class="p">)</span>
    <span class="n">azRadians</span> <span class="o">=</span> <span class="n">az</span> <span class="o">*</span> <span class="n">degreesToRadians</span>
    <span class="n">z_scale_factor</span> <span class="o">=</span> <span class="n">z</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span>
    <span class="n">cos_alt_mul_z_scale_factor</span> <span class="o">=</span> \
            <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alt</span> <span class="o">*</span> <span class="n">degreesToRadians</span><span class="p">)</span> <span class="o">*</span> <span class="n">z_scale_factor</span>
    <span class="n">cos_az_mul_cos_alt_mul_z_scale_factor_mul_254</span> <span class="o">=</span> \
                <span class="mi">254</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">azRadians</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos_alt_mul_z_scale_factor</span>
    <span class="n">sin_az_mul_cos_alt_mul_z_scale_factor_mul_254</span> <span class="o">=</span> \
                <span class="mi">254</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">azRadians</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos_alt_mul_z_scale_factor</span>
    <span class="n">square_z_scale_factor</span> <span class="o">=</span> <span class="n">z_scale_factor</span> <span class="o">*</span> <span class="n">z_scale_factor</span>
    <span class="n">sin_alt_mul_254</span> <span class="o">=</span> <span class="mf">254.0</span> <span class="o">*</span> <span class="n">sin_alt</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">out_ar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">radius</span><span class="p">):</span>
        <span class="n">win_line</span> <span class="o">=</span> <span class="n">in_ar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="n">radius</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="n">radius</span><span class="o">+</span><span class="mi">1</span><span class="p">,:]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">out_ar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">radius</span><span class="p">):</span>
            <span class="n">win</span> <span class="o">=</span> <span class="n">win_line</span><span class="p">[:,</span><span class="n">i</span><span class="o">-</span><span class="n">radius</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">radius</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">inv_ewres</span> <span class="o">*</span> <span class="p">((</span><span class="n">win</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">win</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">win</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">win</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span>\
                            <span class="p">(</span><span class="n">win</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">win</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">win</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">win</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">inv_nsres</span> <span class="o">*</span> <span class="p">((</span><span class="n">win</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">win</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">win</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">win</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">-</span>\
                            <span class="p">(</span><span class="n">win</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">win</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">win</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">win</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">xx_plus_yy</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span>
            <span class="n">cang_mul_254</span> <span class="o">=</span> <span class="p">(</span><span class="n">sin_alt_mul_254</span> <span class="o">-</span> \
                <span class="p">(</span><span class="n">y</span> <span class="o">*</span> <span class="n">cos_az_mul_cos_alt_mul_z_scale_factor_mul_254</span> <span class="o">-</span> \
                    <span class="n">x</span> <span class="o">*</span> <span class="n">sin_az_mul_cos_alt_mul_z_scale_factor_mul_254</span><span class="p">))</span> <span class="o">/</span> \
                <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">square_z_scale_factor</span> <span class="o">*</span> <span class="n">xx_plus_yy</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cang_mul_254</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">out_ar</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out_ar</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">round</span><span class="p">(</span><span class="n">cang_mul_254</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">hillshade</span><span class="p">(</span><span class="n">in_ar</span><span class="p">,</span> <span class="n">out_ar</span><span class="p">,</span> <span class="n">xoff</span><span class="p">,</span> <span class="n">yoff</span><span class="p">,</span> <span class="n">xsize</span><span class="p">,</span> <span class="n">ysize</span><span class="p">,</span> <span class="n">raster_xsize</span><span class="p">,</span>
            <span class="n">raster_ysize</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">gt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;z_factor&#39;</span><span class="p">])</span>
    <span class="n">scale</span><span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">])</span>
    <span class="n">hillshade_int</span><span class="p">(</span><span class="n">in_ar</span><span class="p">,</span> <span class="n">out_ar</span><span class="p">,</span> <span class="n">xoff</span><span class="p">,</span> <span class="n">yoff</span><span class="p">,</span> <span class="n">xsize</span><span class="p">,</span> <span class="n">ysize</span><span class="p">,</span> <span class="n">raster_xsize</span><span class="p">,</span>
                <span class="n">raster_ysize</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">gt</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="python-module-path">
<h3>Python module path<a class="headerlink" href="#python-module-path" title="Link to this heading"></a></h3>
<p>When importing modules from inline Python code or when relying on out-of-line
code (PixelFunctionType of the form &quot;module_name.function_name&quot;), you need
to make sure the modules are accessible through the python path. Note that
contrary to the Python interactive interpreter, the current path is not
automatically added when used from GDAL. So you may need to define the
<strong>PYTHONPATH</strong> environment variable if you get ModuleNotFoundError exceptions.</p>
<section id="security-implications">
<h4>Security implications<a class="headerlink" href="#security-implications" title="Link to this heading"></a></h4>
<p>The ability to run Python code potentially opens the door to many potential
vulnerabilities if the user of GDAL may process untrusted datasets. To avoid
such issues, by default, execution of Python pixel function will be disabled.
The execution policy can be controlled with the following
configuration options:</p>
<ul class="simple">
<li><p id="config-GDAL_VRT_ENABLE_PYTHON"><strong>GDAL_VRT_ENABLE_PYTHON=[YES/NO/TRUSTED_MODULES]: </strong> Defaults to <code class="docutils literal notranslate"><span class="pre">TRUSTED_MODULES</span></code>. Determine what Python code can be called from GDAL.<ul>
<li><p>YES: all VRT scripts are considered as trusted and their Python pixel functions will be run when pixel operations are involved.</p></li>
<li><p>NO: all VRT scripts are considered untrusted, and none Python pixelfunction will be run.</p></li>
<li><p>TRUSTED_MODULES (default setting): all VRT scripts with inline Python code in their PixelFunctionCode elements will be considered untrusted and will not be run. VRT scripts that use a PixelFunctionType of the form &quot;module_name.function_name&quot; will be considered as trusted, only if &quot;module_name&quot; is allowed in the <a class="reference internal" href="#config-GDAL_VRT_PYTHON_TRUSTED_MODULES"><code class="docutils literal notranslate"><span class="pre">GDAL_VRT_PYTHON_TRUSTED_MODULES</span></code></a> configuration option.</p></li>
</ul>
</p>
</li>
<li><p id="config-GDAL_VRT_PYTHON_TRUSTED_MODULES"><strong>GDAL_VRT_PYTHON_TRUSTED_MODULES=value: </strong>The value of this configuration option is a comma separated listed of trusted module names. The '*' wildcard can be used at the name of a string to match all strings beginning with the substring before the '*' character. For example 'every*' will make 'every.thing' or 'everything' module trusted. '*' can also be used to make all modules to be trusted. The &quot;.*&quot; wildcard can also be used to match exact modules or submodules names. For example 'every.*' will make 'every' and 'every.thing' modules trusted, but not 'everything'.</p>
</li>
</ul>
</section>
<section id="linking-mechanism-to-a-python-interpreter">
<span id="linking-mechanism-to-python-interpreter"></span><h4>Linking mechanism to a Python interpreter<a class="headerlink" href="#linking-mechanism-to-a-python-interpreter" title="Link to this heading"></a></h4>
<p>Currently only CPython 2 and 3 is supported. The GDAL shared object
is not explicitly linked at build time to any of the CPython library. When GDAL
will need to run Python code, it will first determine if the Python interpreter
is loaded in the current process (which is the case if the program is a Python
interpreter itself, or if another program, e.g. QGIS, has already loaded the
CPython library). Otherwise it will look if the <a class="reference internal" href="../../user/configoptions.html#config-PYTHONSO"><code class="docutils literal notranslate"><span class="pre">PYTHONSO</span></code></a> configuration option is
defined. This option can be set to point to the name of the Python library to
use, either as a shortname like &quot;libpython3.10.so&quot; if it is accessible through
the Linux dynamic loader (so typically in one of the paths in /etc/ld.so.conf or
LD_LIBRARY_PATH) or as a full path name like &quot;/usr/lib/x86_64-linux-gnu/libpython3.10.so&quot;.
The same holds on Windows will shortnames like &quot;python310.dll&quot; if accessible through
the PATH or full path names like &quot;c:\python310\python310.dll&quot;. If the <a class="reference internal" href="../../user/configoptions.html#config-PYTHONSO"><code class="docutils literal notranslate"><span class="pre">PYTHONSO</span></code></a>
configuration option is not defined, it will look for a &quot;python&quot; binary in the
directories of the PATH and will try to determine the related shared object
(it will retry with &quot;python3&quot; if no &quot;python&quot; has been found). If the above
was not successful, then a predefined list of shared objects names
will be tried. At the time of writing, the order of versions searched is
3.8, 3.9, 3.10, 3.11, 3.12, 3.7, 3.6, 3.5, 3.4, 3.3, 3.2. Enabling debug information (<a class="reference internal" href="../../user/configoptions.html#config-CPL_DEBUG"><code class="docutils literal notranslate"><span class="pre">CPL_DEBUG=ON</span></code></a>) will
show which Python version is used.</p>
</section>
</section>
<section id="just-in-time-compilation">
<h3>Just-in-time compilation<a class="headerlink" href="#just-in-time-compilation" title="Link to this heading"></a></h3>
<p>The use of a just-in-time compiler may significantly speed up execution times.
<a class="reference external" href="http://numba.pydata.org/">Numba</a> has been successfully tested. For
better performance, it is recommended to use a offline pixel function so that
the just-in-time compiler may cache its compilation.</p>
<p>Given the following <code class="file docutils literal notranslate"><span class="pre">mandelbrot.py</span></code> file :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Trick for compatibility with and without numba</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span>
    <span class="c1">#print(&#39;Using numba&#39;)</span>
    <span class="n">g_max_iterations</span> <span class="o">=</span> <span class="mi">100</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="k">class</span> <span class="nc">jit</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nopython</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nogil</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">f</span>

    <span class="c1">#print(&#39;Using non-JIT version&#39;)</span>
    <span class="n">g_max_iterations</span> <span class="o">=</span> <span class="mi">25</span>

<span class="c1"># Use a wrapper for the entry point regarding GDAL, since GDAL cannot access</span>
<span class="c1"># the jit decorated function with the expected signature.</span>
<span class="k">def</span> <span class="nf">mandelbrot</span><span class="p">(</span><span class="n">in_ar</span><span class="p">,</span> <span class="n">out_ar</span><span class="p">,</span> <span class="n">xoff</span><span class="p">,</span> <span class="n">yoff</span><span class="p">,</span> <span class="n">xsize</span><span class="p">,</span> <span class="n">ysize</span><span class="p">,</span> <span class="n">raster_xsize</span><span class="p">,</span>
                        <span class="n">raster_ysize</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">gt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">mandelbrot_jit</span><span class="p">(</span><span class="n">out_ar</span><span class="p">,</span> <span class="n">xoff</span><span class="p">,</span> <span class="n">yoff</span><span class="p">,</span> <span class="n">xsize</span><span class="p">,</span> <span class="n">ysize</span><span class="p">,</span> <span class="n">raster_xsize</span><span class="p">,</span> <span class="n">raster_ysize</span><span class="p">,</span>
<span class="n">g_max_iterations</span><span class="p">)</span>

<span class="c1"># Will make sure that the code is compiled to pure native code without Python</span>
<span class="c1"># fallback.</span>
<span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">mandelbrot_jit</span><span class="p">(</span><span class="n">out_ar</span><span class="p">,</span> <span class="n">xoff</span><span class="p">,</span> <span class="n">yoff</span><span class="p">,</span> <span class="n">xsize</span><span class="p">,</span> <span class="n">ysize</span><span class="p">,</span> <span class="n">raster_xsize</span><span class="p">,</span>
                        <span class="n">raster_ysize</span><span class="p">,</span> <span class="n">max_iterations</span><span class="p">):</span>
    <span class="n">ovr_factor_y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">out_ar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">ysize</span>
    <span class="n">ovr_factor_x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">out_ar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">xsize</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">out_ar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">yoff</span> <span class="o">+</span> <span class="n">j</span> <span class="o">/</span> <span class="n">ovr_factor_y</span><span class="p">)</span> <span class="o">/</span> <span class="n">raster_ysize</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">out_ar</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">xoff</span> <span class="o">+</span> <span class="n">i</span> <span class="o">/</span> <span class="n">ovr_factor_x</span><span class="p">)</span> <span class="o">/</span> <span class="n">raster_xsize</span> <span class="o">-</span> <span class="mf">2.5</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">y2</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">&lt;</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">iteration</span> <span class="o">&lt;</span> <span class="n">max_iterations</span><span class="p">:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">y0</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">x0</span>
                <span class="n">x2</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
                <span class="n">y2</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span>
                <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">out_ar</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">iteration</span> <span class="o">*</span> <span class="mi">255</span> <span class="o">/</span> <span class="n">max_iterations</span>
</pre></div>
</div>
<p>The following VRT file can be used (to be opened with QGIS for example)</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VRTDataset</span><span class="w"> </span><span class="na">rasterXSize=</span><span class="s">&quot;100000000&quot;</span><span class="w"> </span><span class="na">rasterYSize=</span><span class="s">&quot;100000000&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;Byte&quot;</span><span class="w"> </span><span class="na">band=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTDerivedRasterBand&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;PixelFunctionLanguage&gt;</span>Python<span class="nt">&lt;/PixelFunctionLanguage&gt;</span>
<span class="w">        </span><span class="nt">&lt;PixelFunctionType&gt;</span>mandelbrot.mandelbrot<span class="nt">&lt;/PixelFunctionType&gt;</span>
<span class="w">        </span><span class="nt">&lt;Metadata&gt;</span>
<span class="w">        </span><span class="nt">&lt;MDI</span><span class="w"> </span><span class="na">key=</span><span class="s">&quot;STATISTICS_MAXIMUM&quot;</span><span class="nt">&gt;</span>255<span class="nt">&lt;/MDI&gt;</span>
<span class="w">        </span><span class="nt">&lt;MDI</span><span class="w"> </span><span class="na">key=</span><span class="s">&quot;STATISTICS_MEAN&quot;</span><span class="nt">&gt;</span>127<span class="nt">&lt;/MDI&gt;</span>
<span class="w">        </span><span class="nt">&lt;MDI</span><span class="w"> </span><span class="na">key=</span><span class="s">&quot;STATISTICS_MINIMUM&quot;</span><span class="nt">&gt;</span>0<span class="nt">&lt;/MDI&gt;</span>
<span class="w">        </span><span class="nt">&lt;MDI</span><span class="w"> </span><span class="na">key=</span><span class="s">&quot;STATISTICS_STDDEV&quot;</span><span class="nt">&gt;</span>127<span class="nt">&lt;/MDI&gt;</span>
<span class="w">        </span><span class="nt">&lt;/Metadata&gt;</span>
<span class="w">        </span><span class="nt">&lt;ColorInterp&gt;</span>Gray<span class="nt">&lt;/ColorInterp&gt;</span>
<span class="w">        </span><span class="nt">&lt;Histograms&gt;</span>
<span class="w">        </span><span class="nt">&lt;HistItem&gt;</span>
<span class="w">            </span><span class="nt">&lt;HistMin&gt;</span>-0.5<span class="nt">&lt;/HistMin&gt;</span>
<span class="w">            </span><span class="nt">&lt;HistMax&gt;</span>255.5<span class="nt">&lt;/HistMax&gt;</span>
<span class="w">            </span><span class="nt">&lt;BucketCount&gt;</span>256<span class="nt">&lt;/BucketCount&gt;</span>
<span class="w">            </span><span class="nt">&lt;IncludeOutOfRange&gt;</span>0<span class="nt">&lt;/IncludeOutOfRange&gt;</span>
<span class="w">            </span><span class="nt">&lt;Approximate&gt;</span>1<span class="nt">&lt;/Approximate&gt;</span>
<span class="w">            </span><span class="nt">&lt;HistCounts&gt;</span>0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|
<span class="w">    </span>0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|
<span class="w">    </span>0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|
<span class="w">    </span>0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|
<span class="w">    </span>0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|
<span class="w">    </span>0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|
<span class="w">    </span>0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0<span class="nt">&lt;/HistCounts&gt;</span>
<span class="w">        </span><span class="nt">&lt;/HistItem&gt;</span>
<span class="w">        </span><span class="nt">&lt;/Histograms&gt;</span>
<span class="w">    </span><span class="nt">&lt;/VRTRasterBand&gt;</span>
<span class="nt">&lt;/VRTDataset&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="warped-vrt">
<span id="gdal-vrttut-warped"></span><h2>Warped VRT<a class="headerlink" href="#warped-vrt" title="Link to this heading"></a></h2>
<p>A warped VRT is a VRTDataset with subClass=&quot;VRTWarpedDataset&quot;. It has a
GDALWarpOptions element which describe the warping options.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VRTDataset</span><span class="w"> </span><span class="na">rasterXSize=</span><span class="s">&quot;20&quot;</span><span class="w"> </span><span class="na">rasterYSize=</span><span class="s">&quot;20&quot;</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTWarpedDataset&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;SRS&gt;</span>PROJCS[&quot;NAD27<span class="w"> </span>/<span class="w"> </span>UTM<span class="w"> </span>zone<span class="w"> </span>11N&quot;,GEOGCS[&quot;NAD27&quot;,DATUM[&quot;North_American_Datum_1927&quot;,SPHEROID[&quot;Clarke<span class="w"> </span>1866&quot;,6378206.4,294.9786982138982,AUTHORITY[&quot;EPSG&quot;,&quot;7008&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6267&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4267&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,-117],PARAMETER[&quot;scale_factor&quot;,0.9996],PARAMETER[&quot;false_easting&quot;,500000],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;26711&quot;]]<span class="nt">&lt;/SRS&gt;</span>
<span class="w">    </span><span class="nt">&lt;GeoTransform&gt;</span><span class="w">  </span>4.4072000000000000e+05,<span class="w">  </span>6.0000000000000000e+01,<span class="w">  </span>0.0000000000000000e+00,<span class="w">  </span>3.7513200000000000e+06,<span class="w">  </span>0.0000000000000000e+00,<span class="w"> </span>-6.0000000000000000e+01<span class="nt">&lt;/GeoTransform&gt;</span>
<span class="w">    </span><span class="nt">&lt;Metadata&gt;</span>
<span class="w">        </span><span class="nt">&lt;MDI</span><span class="w"> </span><span class="na">key=</span><span class="s">&quot;AREA_OR_POINT&quot;</span><span class="nt">&gt;</span>Area<span class="nt">&lt;/MDI&gt;</span>
<span class="w">    </span><span class="nt">&lt;/Metadata&gt;</span>
<span class="w">    </span><span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;Byte&quot;</span><span class="w"> </span><span class="na">band=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTWarpedRasterBand&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ColorInterp&gt;</span>Gray<span class="nt">&lt;/ColorInterp&gt;</span>
<span class="w">    </span><span class="nt">&lt;/VRTRasterBand&gt;</span>
<span class="w">    </span><span class="nt">&lt;BlockXSize&gt;</span>20<span class="nt">&lt;/BlockXSize&gt;</span>
<span class="w">    </span><span class="nt">&lt;BlockYSize&gt;</span>20<span class="nt">&lt;/BlockYSize&gt;</span>
<span class="w">    </span><span class="nt">&lt;GDALWarpOptions&gt;</span>
<span class="w">        </span><span class="nt">&lt;WarpMemoryLimit&gt;</span>6.71089e+07<span class="nt">&lt;/WarpMemoryLimit&gt;</span>
<span class="w">        </span><span class="nt">&lt;ResampleAlg&gt;</span>NearestNeighbour<span class="nt">&lt;/ResampleAlg&gt;</span>
<span class="w">        </span><span class="nt">&lt;WorkingDataType&gt;</span>Byte<span class="nt">&lt;/WorkingDataType&gt;</span>
<span class="w">        </span><span class="nt">&lt;Option</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;INIT_DEST&quot;</span><span class="nt">&gt;</span>0<span class="nt">&lt;/Option&gt;</span>
<span class="w">        </span><span class="nt">&lt;SourceDataset</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>byte.vrt<span class="nt">&lt;/SourceDataset&gt;</span>
<span class="w">        </span><span class="nt">&lt;Transformer&gt;</span>
<span class="w">        </span><span class="nt">&lt;ApproxTransformer&gt;</span>
<span class="w">            </span><span class="nt">&lt;MaxError&gt;</span>0.125<span class="nt">&lt;/MaxError&gt;</span>
<span class="w">            </span><span class="nt">&lt;BaseTransformer&gt;</span>
<span class="w">            </span><span class="nt">&lt;GenImgProjTransformer&gt;</span>
<span class="w">                </span><span class="nt">&lt;SrcGeoTransform&gt;</span>440720,60,0,3751320,0,-60<span class="nt">&lt;/SrcGeoTransform&gt;</span>
<span class="w">                </span><span class="nt">&lt;SrcInvGeoTransform&gt;</span>-7345.33333333333303,0.0166666666666666664,0,62522,0,-0.0166666666666666664<span class="nt">&lt;/SrcInvGeoTransform&gt;</span>
<span class="w">                </span><span class="nt">&lt;DstGeoTransform&gt;</span>440720,60,0,3751320,0,-60<span class="nt">&lt;/DstGeoTransform&gt;</span>
<span class="w">                </span><span class="nt">&lt;DstInvGeoTransform&gt;</span>-7345.33333333333303,0.0166666666666666664,0,62522,0,-0.0166666666666666664<span class="nt">&lt;/DstInvGeoTransform&gt;</span>
<span class="w">            </span><span class="nt">&lt;/GenImgProjTransformer&gt;</span>
<span class="w">            </span><span class="nt">&lt;/BaseTransformer&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ApproxTransformer&gt;</span>
<span class="w">        </span><span class="nt">&lt;/Transformer&gt;</span>
<span class="w">        </span><span class="nt">&lt;BandList&gt;</span>
<span class="w">        </span><span class="nt">&lt;BandMapping</span><span class="w"> </span><span class="na">src=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">dst=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/BandList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/GDALWarpOptions&gt;</span>
<span class="nt">&lt;/VRTDataset&gt;</span>
</pre></div>
</div>
</section>
<section id="pansharpened-vrt">
<span id="gdal-vrttut-pansharpen"></span><h2>Pansharpened VRT<a class="headerlink" href="#pansharpened-vrt" title="Link to this heading"></a></h2>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.1.</span></p>
</div>
<p>A VRT can describe a dataset resulting from a
<a class="reference external" href="https://en.wikipedia.org/wiki/Pansharpened_image">pansharpening operation</a>
The pansharpening VRT combines a panchromatic band with several spectral bands
of lower resolution to generate output spectral bands of the same resolution as
the panchromatic band.</p>
<p>VRT pansharpening assumes that the panchromatic and spectral bands have the same
projection (or no projection). If that is not the case, reprojection must be done in a prior step.
Bands might have different geotransform matrices, in which case, by default, the
resulting dataset will have as extent the union of all extents.</p>
<p>Currently the only supported pansharpening algorithm is a &quot;weighted&quot; Brovey algorithm.
The general principle of this algorithm is that, after resampling the spectral bands
to the resolution of the panchromatic band, a pseudo panchromatic intensity is computed
from a weighted average of the spectral bands. Then the output value of the spectral
band is its input value multiplied by the ratio of the real panchromatic intensity
over the pseudo panchromatic intensity.</p>
<p>Corresponding pseudo code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pseudo_panchro</span><span class="p">[</span><span class="n">pixel</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">weight</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">spectral</span><span class="p">[</span><span class="n">pixel</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span> <span class="n">to</span> <span class="n">nb_spectral_bands</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ratio</span> <span class="o">=</span> <span class="n">panchro</span><span class="p">[</span><span class="n">pixel</span><span class="p">]</span> <span class="o">/</span> <span class="n">pseudo_panchro</span><span class="p">[</span><span class="n">pixel</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span> <span class="n">to</span> <span class="n">nb_spectral_bands</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
    <span class="n">output_value</span><span class="p">[</span><span class="n">pixel</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_value</span><span class="p">[</span><span class="n">pixel</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">ratio</span>
</pre></div>
</div>
<p>A valid pansharpened VRT must declare subClass=&quot;VRTPansharpenedDataset&quot; as an
attribute of the VRTDataset top element. The VRTDataset element must have a
child <strong>PansharpeningOptions</strong> element. This PansharpeningOptions element must have
a <strong>PanchroBand</strong> child element and one of several <strong>SpectralBand</strong> elements.
PanchroBand and SpectralBand elements must have at least a <strong>SourceFilename</strong> child
element to specify the name of the dataset. They may also have a <strong>SourceBand</strong> child
element to specify the number of the band in the dataset (starting with 1). If not
specify, the first band will be assumed.
<strong>OpenOptions</strong> can also be specified</p>
<p>The SpectralBand element must generally have a <strong>dstBand</strong> attribute to specify the
number of the output band (starting with 1) to which the input spectral band must be mapped.
If the attribute is not specified, the spectral band will be taken into account
in the computation of the pansharpening, but not exposed as an output band.</p>
<p>Panchromatic and spectral bands should generally come from different datasets,
since bands of a GDAL dataset are assumed to have all the same dimensions.
Spectral bands themselves can come from one or several datasets. The only
constraint is that they have all the same dimensions and geotransform.</p>
<p>An example of a minimalist working VRT is the following. It will generates a dataset with 3 output
bands corresponding to the 3 input spectral bands of multispectral.tif, pansharpened
with panchromatic.tif.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VRTDataset</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTPansharpenedDataset&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;PansharpeningOptions&gt;</span>
<span class="w">        </span><span class="nt">&lt;PanchroBand&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>panchromatic.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">            </span><span class="nt">&lt;OpenOptions&gt;</span>
<span class="w">                </span><span class="nt">&lt;OOI</span><span class="w"> </span><span class="na">key=</span><span class="s">&quot;NUM_THREADS&quot;</span><span class="nt">&gt;</span>ALL_CPUS<span class="nt">&lt;/OOI&gt;</span>
<span class="w">            </span><span class="nt">&lt;/OpenOptions&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceBand&gt;</span>1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;/PanchroBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;SpectralBand</span><span class="w"> </span><span class="na">dstBand=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>multispectral.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">            </span><span class="nt">&lt;OpenOptions&gt;</span>
<span class="w">                </span><span class="nt">&lt;OOI</span><span class="w"> </span><span class="na">key=</span><span class="s">&quot;NUM_THREADS&quot;</span><span class="nt">&gt;</span>ALL_CPUS<span class="nt">&lt;/OOI&gt;</span>
<span class="w">            </span><span class="nt">&lt;/OpenOptions&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceBand&gt;</span>1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SpectralBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;SpectralBand</span><span class="w"> </span><span class="na">dstBand=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>multispectral.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">            </span><span class="nt">&lt;OpenOptions&gt;</span>
<span class="w">                </span><span class="nt">&lt;OOI</span><span class="w"> </span><span class="na">key=</span><span class="s">&quot;NUM_THREADS&quot;</span><span class="nt">&gt;</span>ALL_CPUS<span class="nt">&lt;/OOI&gt;</span>
<span class="w">            </span><span class="nt">&lt;/OpenOptions&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceBand&gt;</span>2<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SpectralBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;SpectralBand</span><span class="w"> </span><span class="na">dstBand=</span><span class="s">&quot;3&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>multispectral.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">            </span><span class="nt">&lt;OpenOptions&gt;</span>
<span class="w">                </span><span class="nt">&lt;OOI</span><span class="w"> </span><span class="na">key=</span><span class="s">&quot;NUM_THREADS&quot;</span><span class="nt">&gt;</span>ALL_CPUS<span class="nt">&lt;/OOI&gt;</span>
<span class="w">            </span><span class="nt">&lt;/OpenOptions&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceBand&gt;</span>3<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SpectralBand&gt;</span>
<span class="w">    </span><span class="nt">&lt;/PansharpeningOptions&gt;</span>
<span class="nt">&lt;/VRTDataset&gt;</span>
</pre></div>
</div>
<p>In the above example, 3 output pansharpend bands will be created from the 3 declared
input spectral bands. The weights will be 1/3. Cubic resampling will be used. The
projection and geotransform from the panchromatic band will be reused for the VRT
dataset.</p>
<p>It is possible to create more explicit and declarative pansharpened VRT, allowing
for example to only output part of the input spectral bands (e.g. only RGB when
the input multispectral dataset is RGBNir). It is also possible to add &quot;classic&quot;
VRTRasterBands, in addition to the pansharpened bands.</p>
<p>In addition to the above mentioned required PanchroBand and SpectralBand elements,
the PansharpeningOptions element may have the following children elements :</p>
<ul class="simple">
<li><p><strong>Algorithm</strong>: to specify the pansharpening algorithm. Currently, only WeightedBrovey is supported.</p></li>
<li><p><strong>AlgorithmOptions</strong>: to specify the options of the pansharpening algorithm. With WeightedBrovey algorithm, the only supported option is a <strong>Weights</strong> child element whose content must be a comma separated list of real values assigning the weight of each of the declared input spectral bands. There must be as many values as declared input spectral bands.</p></li>
<li><p><strong>Resampling</strong>: the resampling kernel used to resample the spectral bands to the resolution of the panchromatic band. Can be one of Cubic (default), Average, Near, CubicSpline, Bilinear, Lanczos.</p></li>
<li><p><strong>NumThreads</strong>: Number of worker threads. Integer number or ALL_CPUS. If this option is not set, the <a class="reference internal" href="../../user/configoptions.html#config-GDAL_NUM_THREADS"><code class="docutils literal notranslate"><span class="pre">GDAL_NUM_THREADS</span></code></a> configuration option will be queried (its value can also be set to an integer or ALL_CPUS)</p></li>
<li><p><strong>BitDepth</strong>: Can be used to specify the bit depth of the panchromatic and spectral bands (e.g. 12). If not specified, the NBITS metadata item from the panchromatic band will be used if it exists.</p></li>
<li><p><strong>NoData</strong>: Nodata value to take into account for panchromatic and spectral bands. It will be also used as the output nodata value. If not specified and all input bands have the same nodata value, it will be implicitly used (unless the special None value is put in NoData to prevent that).</p></li>
<li><p><strong>SpatialExtentAdjustment</strong>: Can be one of <strong>Union</strong> (default), <strong>Intersection</strong>, <strong>None</strong> or <strong>NoneWithoutWarning</strong>. Controls the behavior when panchromatic and spectral bands have not the same geospatial extent. By default, Union will take the union of all spatial extents. Intersection the intersection of all spatial extents. None will not proceed to any adjustment at all, but will emit a warning. NoneWithoutWarning is the same as None, but in a silent way.</p></li>
</ul>
<p>The below examples creates a VRT dataset with 4 bands. The first band is the
panchromatic band. The 3 following bands are than red, green, blue pansharpened
bands computed from a multispectral raster with red, green, blue and near-infrared
bands. The near-infrared bands is taken into account for the computation of the
pseudo panchromatic intensity, but not bound to an output band.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VRTDataset</span><span class="w"> </span><span class="na">rasterXSize=</span><span class="s">&quot;800&quot;</span><span class="w"> </span><span class="na">rasterYSize=</span><span class="s">&quot;400&quot;</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTPansharpenedDataset&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;SRS&gt;</span>WGS84<span class="nt">&lt;/SRS&gt;</span>
<span class="w">    </span><span class="nt">&lt;GeoTransform&gt;</span>-180,<span class="w"> </span>0.45,<span class="w"> </span>0,<span class="w"> </span>90,<span class="w"> </span>0,<span class="w"> </span>-0.45<span class="nt">&lt;/GeoTransform&gt;</span>
<span class="w">    </span><span class="nt">&lt;Metadata&gt;</span>
<span class="w">        </span><span class="nt">&lt;MDI</span><span class="w"> </span><span class="na">key=</span><span class="s">&quot;DESCRIPTION&quot;</span><span class="nt">&gt;</span>Panchromatic<span class="w"> </span>band<span class="w"> </span>+<span class="w"> </span>pan-sharpened<span class="w"> </span>red,<span class="w"> </span>green<span class="w"> </span>and<span class="w"> </span>blue<span class="w"> </span>bands<span class="nt">&lt;/MDI&gt;</span>
<span class="w">    </span><span class="nt">&lt;/Metadata&gt;</span>
<span class="w">    </span><span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;Byte&quot;</span><span class="w"> </span><span class="na">band=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;SimpleSource&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>world_pan.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceBand&gt;</span>1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SimpleSource&gt;</span>
<span class="w">    </span><span class="nt">&lt;/VRTRasterBand&gt;</span>
<span class="w">    </span><span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;Byte&quot;</span><span class="w"> </span><span class="na">band=</span><span class="s">&quot;2&quot;</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTPansharpenedRasterBand&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ColorInterp&gt;</span>Red<span class="nt">&lt;/ColorInterp&gt;</span>
<span class="w">    </span><span class="nt">&lt;/VRTRasterBand&gt;</span>
<span class="w">    </span><span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;Byte&quot;</span><span class="w"> </span><span class="na">band=</span><span class="s">&quot;3&quot;</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTPansharpenedRasterBand&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ColorInterp&gt;</span>Green<span class="nt">&lt;/ColorInterp&gt;</span>
<span class="w">    </span><span class="nt">&lt;/VRTRasterBand&gt;</span>
<span class="w">    </span><span class="nt">&lt;VRTRasterBand</span><span class="w"> </span><span class="na">dataType=</span><span class="s">&quot;Byte&quot;</span><span class="w"> </span><span class="na">band=</span><span class="s">&quot;4&quot;</span><span class="w"> </span><span class="na">subClass=</span><span class="s">&quot;VRTPansharpenedRasterBand&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ColorInterp&gt;</span>Blue<span class="nt">&lt;/ColorInterp&gt;</span>
<span class="w">    </span><span class="nt">&lt;/VRTRasterBand&gt;</span>
<span class="w">    </span><span class="nt">&lt;BlockXSize&gt;</span>256<span class="nt">&lt;/BlockXSize&gt;</span>
<span class="w">    </span><span class="nt">&lt;BlockYSize&gt;</span>256<span class="nt">&lt;/BlockYSize&gt;</span>
<span class="w">    </span><span class="nt">&lt;PansharpeningOptions&gt;</span>
<span class="w">        </span><span class="nt">&lt;Algorithm&gt;</span>WeightedBrovey<span class="nt">&lt;/Algorithm&gt;</span>
<span class="w">        </span><span class="nt">&lt;AlgorithmOptions&gt;</span>
<span class="w">            </span><span class="nt">&lt;Weights&gt;</span>0.25,0.25,0.25,0.25<span class="nt">&lt;/Weights&gt;</span>
<span class="w">        </span><span class="nt">&lt;/AlgorithmOptions&gt;</span>
<span class="w">        </span><span class="nt">&lt;Resampling&gt;</span>Cubic<span class="nt">&lt;/Resampling&gt;</span>
<span class="w">        </span><span class="nt">&lt;NumThreads&gt;</span>ALL_CPUS<span class="nt">&lt;/NumThreads&gt;</span>
<span class="w">        </span><span class="nt">&lt;BitDepth&gt;</span>8<span class="nt">&lt;/BitDepth&gt;</span>
<span class="w">        </span><span class="nt">&lt;NoData&gt;</span>0<span class="nt">&lt;/NoData&gt;</span>
<span class="w">        </span><span class="nt">&lt;SpatialExtentAdjustment&gt;</span>Union<span class="nt">&lt;/SpatialExtentAdjustment&gt;</span>
<span class="w">        </span><span class="nt">&lt;PanchroBand&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>world_pan.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceBand&gt;</span>1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;/PanchroBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;SpectralBand</span><span class="w"> </span><span class="na">dstBand=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>world_rgbnir.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceBand&gt;</span>1<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SpectralBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;SpectralBand</span><span class="w"> </span><span class="na">dstBand=</span><span class="s">&quot;3&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>world_rgbnir.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceBand&gt;</span>2<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SpectralBand&gt;</span>
<span class="w">            </span><span class="nt">&lt;SpectralBand</span><span class="w"> </span><span class="na">dstBand=</span><span class="s">&quot;4&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>world_rgbnir.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceBand&gt;</span>3<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SpectralBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;SpectralBand&gt;</span><span class="w"> </span><span class="cm">&lt;!-- note the absence of the dstBand attribute, to indicate</span>
<span class="cm">                            that the NIR band is not bound to any output band --&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceFilename</span><span class="w"> </span><span class="na">relativeToVRT=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>world_rgbnir.tif<span class="nt">&lt;/SourceFilename&gt;</span>
<span class="w">            </span><span class="nt">&lt;SourceBand&gt;</span>4<span class="nt">&lt;/SourceBand&gt;</span>
<span class="w">        </span><span class="nt">&lt;/SpectralBand&gt;</span>
<span class="w">    </span><span class="nt">&lt;/PansharpeningOptions&gt;</span>
<span class="nt">&lt;/VRTDataset&gt;</span>
</pre></div>
</div>
</section>
<section id="multidimensional-vrt">
<h2>Multidimensional VRT<a class="headerlink" href="#multidimensional-vrt" title="Link to this heading"></a></h2>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.1.</span></p>
</div>
<p>See the dedicated <a class="reference internal" href="vrt_multidimensional.html#vrt-multidimensional"><span class="std std-ref">Multidimensional VRT</span></a> page.</p>
<div class="toctree-wrapper compound">
</div>
</section>
<section id="processed-dataset-vrt">
<h2>Processed dataset VRT<a class="headerlink" href="#processed-dataset-vrt" title="Link to this heading"></a></h2>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.9.</span></p>
</div>
<p>A VRT processed dataset is a specific variant of the <a class="reference internal" href="#raster-vrt"><span class="std std-ref">VRT -- GDAL Virtual Format</span></a> format,
to apply chained processing steps that may apply to several bands at the same time.</p>
<p>See the dedicated <a class="reference internal" href="vrt_processed_dataset.html#vrt-processed-dataset"><span class="std std-ref">VRT processed dataset</span></a> page.</p>
<div class="toctree-wrapper compound">
</div>
</section>
<section id="vrt-connection-string">
<h2>vrt:// connection string<a class="headerlink" href="#vrt-connection-string" title="Link to this heading"></a></h2>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.1.</span></p>
</div>
<p>In some contexts, it might be useful to benefit from features of VRT without
having to create a file or to provide the rather verbose VRT XML content as
the connection string. For that purpose, the following URI syntax is supported for
the dataset name since GDAL 3.1</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>vrt://{path_to_gdal_dataset}?[bands=num1,...,numN]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>vrt://{path_to_gdal_dataset}?[a_srs=srs_def]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>vrt://{path_to_gdal_dataset}?[a_ullr=ulx,uly,lrx,lry]
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>vrt://my.tif?bands=3,2,1
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>vrt://my.tif?a_srs=OGC:CRS84
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>vrt://my.tif?a_ullr=0,1,1,-1
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>vrt://my.tif?bands=2&amp;ovr=4
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>vrt://my.nc?sd_name=sds
</pre></div>
</div>
<p>The supported options currently are <code class="docutils literal notranslate"><span class="pre">bands</span></code>, <code class="docutils literal notranslate"><span class="pre">a_nodata</span></code>, <code class="docutils literal notranslate"><span class="pre">a_srs</span></code>, <code class="docutils literal notranslate"><span class="pre">a_ullr</span></code>, <code class="docutils literal notranslate"><span class="pre">ovr</span></code>, <code class="docutils literal notranslate"><span class="pre">expand</span></code>,
<code class="docutils literal notranslate"><span class="pre">a_scale</span></code>, <code class="docutils literal notranslate"><span class="pre">a_offset</span></code>, <code class="docutils literal notranslate"><span class="pre">ot</span></code>, <code class="docutils literal notranslate"><span class="pre">gcp</span></code>, <code class="docutils literal notranslate"><span class="pre">if</span></code>, <code class="docutils literal notranslate"><span class="pre">scale</span></code>, <code class="docutils literal notranslate"><span class="pre">exponent</span></code>, <code class="docutils literal notranslate"><span class="pre">outsize</span></code>, <code class="docutils literal notranslate"><span class="pre">projwin</span></code>,
<code class="docutils literal notranslate"><span class="pre">projwin_srs</span></code>, <code class="docutils literal notranslate"><span class="pre">tr</span></code>, <code class="docutils literal notranslate"><span class="pre">r</span></code>, <code class="docutils literal notranslate"><span class="pre">srcwin</span></code>, <code class="docutils literal notranslate"><span class="pre">a_gt</span></code>, <code class="docutils literal notranslate"><span class="pre">oo</span></code>, <code class="docutils literal notranslate"><span class="pre">unscale</span></code>, <code class="docutils literal notranslate"><span class="pre">a_coord_epoch</span></code>, <code class="docutils literal notranslate"><span class="pre">nogcp</span></code>, <code class="docutils literal notranslate"><span class="pre">epo</span></code>, <code class="docutils literal notranslate"><span class="pre">eco</span></code>, <code class="docutils literal notranslate"><span class="pre">sd_name</span></code>, and <code class="docutils literal notranslate"><span class="pre">sd</span></code>.</p>
<p>Other options may be added in the future.</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">bands</span></code> option is to change the band composition. The values specified
are the source band numbers (between 1 and N), possibly out-of-order or with repetitions.
The <code class="docutils literal notranslate"><span class="pre">mask</span></code> value can be used to specify the global mask band. This can also
be seen as an equivalent of running <cite>gdal_translate -of VRT -b num1 ... -b numN</cite>.</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">a_nodata</span></code> option (added in GDAL 3.9) is to assign (override) the nodata
value of the source in the same way as (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>).</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">a_srs</span></code> option (added in GDAL 3.7) is to assign (override) the coordinate
reference system of the source in the same way as (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>), it may be missing,
or incorrect. The value provided for <code class="docutils literal notranslate"><span class="pre">a_srs</span></code> may be a string or a file containing a srs
definition.</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">a_ullr</span></code> option (added in GDAL 3.7) is to assign (override) the georeferenced
bounds of the source in the same way as (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>). The value consists of four numeric
values separated by commas, in the order 'xmin,ymax,xmax,ymin' (upper left x,y, lower right x,y).</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">ovr</span></code> option (added in GDAL 3.7) is to specify which overview
level of source file must be used, with the first overview level being 0 (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>).</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">expand</span></code> option (added in GDAL 3.7) is to expose a dataset with 1 band with
a color table as a dataset with 3 (RGB) or 4 (RGBA) bands, as with (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>).</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">a_scale</span></code> option (added in GDAL 3.7) is to set band scaling value (no
modification of pixel values is done), as with (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>).</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">a_offset</span></code> option (added in GDAL 3.7) is to set band offset value (no
modification of pixel values is done), as with (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>).</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">ot</span></code> option (added in GDAL 3.7) is to force the output image bands to have a
specific data type supported by the driver as with (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>).</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">gcp</span></code> option (added in GDAL 3.7) is to add the indicated ground control point
to the output dataset. Values are a set of numbers as per (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>) <code class="docutils literal notranslate"><span class="pre">pixel,line,easting,northing[,elevation]</span></code>.
Multiple entries may be included. This can also be seen as an equivalent of running
<cite>gdal_translate -of VRT -gcp pixel1 line1 easting1 northing1 [elevation1] -gcp pixel2 line2 easting2 northing2 [elevation2] ... -gcp pixelN lineN eastingN northingN [elevationN]</cite>.</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">if</span></code> option (added in GDAL 3.7) is to specify the format/driver name/s
to be attempted to open the input file (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>). Values may be repeated separated by comma
This can also be seen as an equivalent of running <cite>gdal_translate -of VRT -if DRV1 -if DRV2 ... -if DRVN</cite>.</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">scale</span></code> option (added in GDAL 3.7) is to rescale the input pixel values from the
range <strong>src_min</strong> to <strong>src_max</strong> to the range <strong>dst_min</strong> to <strong>dst_max</strong>  <code class="docutils literal notranslate"><span class="pre">src_min,src_max[,dst_min,dst_max]</span></code>
either 2 or 4 comma separated values. The same rules apply for the source and destination ranges, and <code class="docutils literal notranslate"><span class="pre">scale_bn</span></code> syntax may be used as it is with (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>).  The option <code class="docutils literal notranslate"><span class="pre">scale=true</span></code> (default if unspecified is <code class="docutils literal notranslate"><span class="pre">scale=false</span></code>) may also be used without value arguments (added in GDAL 3.8), where it results in the output range 0,255 from whatever the source range is. Do consider the need for also using <code class="docutils literal notranslate"><span class="pre">ot</span></code> option in order to accommodate the intended output range.</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">exponent</span></code> option (added in GDAL 3.7) is to apply non-linear scaling with a power function,
a single value to be used with the <code class="docutils literal notranslate"><span class="pre">scale</span></code> option. The same <code class="docutils literal notranslate"><span class="pre">exponent_bn</span></code> syntax may be used in combination with <code class="docutils literal notranslate"><span class="pre">scale_bn</span></code> to
target specific band/s as per (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>).</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">outsize</span></code> option (added in GDAL 3.7) is to set the size of the output, in numbers <cite>pixel,line</cite> or in fraction <cite>pixel%,line%</cite> as per (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>).</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">projwin</span></code> option (added in GDAL 3.8) is to select a subwindow from the source image in georeferenced
coordinates in the same way as (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>). The value consists of four numeric values separated by commas, in
the order 'xmin,ymax,xmax,ymin', these are in the native georeferenced coordinates of the source unless <code class="docutils literal notranslate"><span class="pre">projwin_srs</span></code> is also
provided.</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">projwin_srs</span></code> option (added in GDAL 3.8) is to specify the SRS in which to interpret the coordinates given with <code class="docutils literal notranslate"><span class="pre">projwin</span></code> in the same way as (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>). This option only applies if <code class="docutils literal notranslate"><span class="pre">projwin</span></code> is also supplied.</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">tr</span></code> option (added in GDAL 3.8) is to set the target resolution, two positive values in georeferenced coordinates, applied in the same way as (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>). The value consists of two numeric values separated by commas in the order 'xres,yres'.</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">r</span></code> option (added in GDAL 3.8) is to set the resampling algorithm used, with 'nearest' as the default. This is applied in the same way as (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>).</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">srcwin</span></code> option (added in GDAL 3.8) is to select a subwindow from the source image based on pixel/line location as with (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>). The value consists of four integer values separated by commas, in
the order 'xoff,yoff,xsize,ysize'.</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">a_gt</span></code> option (added in GDAL 3.8) is to override/assign the geotransform of the output as with (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>). The value consists of six numeric values separated by commas, in
the order 'gt(0),gt(1),gt(2),gt(3),gt(4),gt(5)'.</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">oo</span></code> option (added in GDAL 3.8) is to set driver-specific dataset open options, multiple values are allowed. The value
consists of string key value pairs with multiple pairs separated by commas e.g. <code class="docutils literal notranslate"><span class="pre">oo=&lt;key&gt;=&lt;val&gt;</span></code> or . <code class="docutils literal notranslate"><span class="pre">oo=&lt;key1&gt;=&lt;val1&gt;,&lt;key2&gt;=&lt;val2&gt;,...</span></code>. This is applied in the same way as (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>).</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">unscale</span></code> option (added in GDAL 3.8) is to apply the scale/offset metadata for the bands to convert scaled values to unscaled values. To apply this use syntax <code class="docutils literal notranslate"><span class="pre">unscale=true</span></code>, or <code class="docutils literal notranslate"><span class="pre">unscale=false</span></code> (which is the default if not specified). Do consider the need for also using <code class="docutils literal notranslate"><span class="pre">ot</span></code> option in order to accommodate the intended output range, see more details for the same argument as with (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>).</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">a_coord_epoch</span></code> option (added in GDAL 3.8) is to assign a coordinate epoch, linked with the output SRS as
with (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>).</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">nogcp</span></code> option (added in GDAL 3.8) is to not copy the GCPs in the source dataset to the output dataset (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>). To apply this
use syntax <code class="docutils literal notranslate"><span class="pre">nogcp=true</span></code>, or <code class="docutils literal notranslate"><span class="pre">nogcp=false</span></code> (which is the default if not specified).</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">epo</span></code> option (added in GDAL 3.8) is that <code class="docutils literal notranslate"><span class="pre">srcwin</span></code> or <code class="docutils literal notranslate"><span class="pre">projwin</span></code> values that fall partially outside the source raster extent will be considered as an error as per (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>). To apply this use syntax <code class="docutils literal notranslate"><span class="pre">epo=true</span></code>, or <code class="docutils literal notranslate"><span class="pre">epo=false</span></code> (which is the default if not specified).</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">eco</span></code> option (added in GDAL 3.8) is that <code class="docutils literal notranslate"><span class="pre">srcwin</span></code> or <code class="docutils literal notranslate"><span class="pre">projwin</span></code> values that fall completely outside the source raster extent will be considered as an error as per (<a class="reference internal" href="../../programs/gdal_translate.html#gdal-translate"><span class="std std-ref">gdal_translate</span></a>). To apply this use syntax <code class="docutils literal notranslate"><span class="pre">eco=true</span></code>, or <code class="docutils literal notranslate"><span class="pre">eco=false</span></code> (which is the default if not specified).</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">sd_name</span></code> option (added in GDAL 3.9) is to choose an individual subdataset by
name for sources that have multiple subdatasets. This means that rather than a fully-qualified description
such as &quot;NETCDF:myfile.nc:somearray&quot; we may use &quot;vrt://myfile.nc?sd_name=somearray&quot;. This option
is mutually exclusive with <code class="docutils literal notranslate"><span class="pre">sd</span></code>.</p>
<p>The effect of the <code class="docutils literal notranslate"><span class="pre">sd</span></code> option (added in GDAL 3.9) is to choose an individual subdataset by
number for sources that have multiple subdatasets. This means that rather than a fully-qualified
description such as &quot;NETCDF:myfile.nc:somearray&quot; we may use &quot;vrt://myfile.nc?sd=&lt;n&gt;&quot; where &quot;&lt;n&gt;&quot;
is between 1 and the number of subdatasets. Note that there is no guarantee of the order of the
subdatasets within a source between GDAL versions (or in some cases between file series in datasets). This
mode is for convenience only, please use <code class="docutils literal notranslate"><span class="pre">sd_name</span></code> to choose a subdataset by name explicitly.
This option is mutually exclusive with <code class="docutils literal notranslate"><span class="pre">sd_name</span></code>.</p>
<p>The options may be chained together separated by '&amp;'. (Beware the need for quoting to protect
the ampersand).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;vrt://my.tif?a_srs=OGC:CRS84&amp;bands=2,1&amp;a_ullr=-180,90,180,-90&quot;</span>
</pre></div>
</div>
</section>
<section id="multi-threading-optimizations">
<h2>Multi-threading optimizations<a class="headerlink" href="#multi-threading-optimizations" title="Link to this heading"></a></h2>
<p>Starting with GDAL 3.6, the ComputeStatistics() implementation can benefit from
multi-threading if the sources are not overlapping and belong to different
datasets. This can be enabled by setting the <a class="reference internal" href="../../user/configoptions.html#config-GDAL_NUM_THREADS"><code class="docutils literal notranslate"><span class="pre">GDAL_NUM_THREADS</span></code></a>
configuration option to an integer or <code class="docutils literal notranslate"><span class="pre">ALL_CPUS</span></code>.</p>
</section>
<section id="multi-threading-issues">
<h2>Multi-threading issues<a class="headerlink" href="#multi-threading-issues" title="Link to this heading"></a></h2>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>The below section applies to GDAL &lt;= 2.2. Starting with GDAL 2.3, the use
of VRT datasets is subject to the standard GDAL dataset multi-threaded rules
(that is a VRT dataset handle may only be used by a same thread at a time,
but you may open several dataset handles on the same VRT file and use them
in different threads)</p>
</div>
<p>When using VRT datasets in a multi-threading environment, you should be
careful to open the VRT dataset by the thread that will use it afterwards. The
reason for that is that the VRT dataset uses <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALOpenShared()</span></code> when opening the
underlying datasets. So, if you open twice the same VRT dataset by the same
thread, both VRT datasets will share the same handles to the underlying
datasets.</p>
<p>The shared attribute, on the SourceFilename indicates whether the
dataset should be shared (value is 1) or not (value is 0). The default is 1.
If several VRT datasets referring to the same underlying sources are used in a multithreaded context,
shared should be set to 0. Alternatively, the <a class="reference internal" href="#config-VRT_SHARED_SOURCE"><code class="docutils literal notranslate"><span class="pre">VRT_SHARED_SOURCE</span></code></a> configuration
option can be set to <code class="docutils literal notranslate"><span class="pre">NO</span></code> to force non-shared mode:</p>
<ul class="simple">
<li><p id="config-VRT_SHARED_SOURCE"><strong>VRT_SHARED_SOURCE=[YES/NO]: </strong> Defaults to <code class="docutils literal notranslate"><span class="pre">YES</span></code>. Determines whether a VRT dataset should open its underlying sources in
shared mode, for <code class="docutils literal notranslate"><span class="pre">SourceFilename</span></code> elements that do not specify a
<code class="docutils literal notranslate"><span class="pre">shared</span></code> attribute. When the <code class="docutils literal notranslate"><span class="pre">shared</span></code> attribute is present this
configuration option is ignored.</p>
</li>
</ul>
</section>
<section id="performance-considerations">
<h2>Performance considerations<a class="headerlink" href="#performance-considerations" title="Link to this heading"></a></h2>
<p>A VRT can reference many (hundreds, thousands, or more) datasets. Due to
operating system limitations, and for performance at opening time, it is
not reasonable/possible to open them all at the same time. GDAL has a &quot;pool&quot;
of datasets opened by VRT files whose maximum limit is 100 by default. When it
needs to access a dataset referenced by a VRT, it checks if it is already in
the pool of open datasets. If not, when the pool has reached its limit, it closes
the least recently used dataset to be able to open the new one. This maximum
limit of the pool can be increased by setting the <a class="reference internal" href="../../user/configoptions.html#config-GDAL_MAX_DATASET_POOL_SIZE"><code class="docutils literal notranslate"><span class="pre">GDAL_MAX_DATASET_POOL_SIZE</span></code></a>
configuration option to a bigger value. Note that a typical user process on
Linux is limited to 1024 simultaneously opened files, and you should let some
margin for shared libraries, etc...
gdal_translate and gdalwarp, by default, increase the pool size to 450.</p>
<p>Starting with GDAL 3.7, the <a class="reference internal" href="../../user/configoptions.html#config-GDAL_MAX_DATASET_POOL_RAM_USAGE"><code class="docutils literal notranslate"><span class="pre">GDAL_MAX_DATASET_POOL_RAM_USAGE</span></code></a>
configuration option to a number of bytes, to limit the RAM usage of opened
datasets in the pool.</p>
</section>
<section id="driver-capabilities">
<h2>Driver capabilities<a class="headerlink" href="#driver-capabilities" title="Link to this heading"></a></h2>
<div class="admonition supports_createcopy" id="supports_createcopy-0">
<p class="admonition-title">Supports CreateCopy()</p>
<p>This driver supports the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALDriver::CreateCopy()</span></code> operation</p>
</div>
<div class="admonition supports_create" id="supports_create-0">
<p class="admonition-title">Supports Create()</p>
<p>This driver supports the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALDriver::Create()</span></code> operation</p>
</div>
<div class="admonition supports_georeferencing" id="supports_georeferencing-0">
<p class="admonition-title">Supports Georeferencing</p>
<p>This driver supports georeferencing</p>
</div>
<div class="admonition supports_virtualio" id="supports_virtualio-0">
<p class="admonition-title">Supports VirtualIO</p>
<p>This driver supports <a class="reference internal" href="../../user/virtual_file_systems.html#virtual-file-systems"><span class="std std-ref">virtual I/O operations (/vsimem/, etc.)</span></a></p>
</div>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="vrt_multidimensional.html" class="btn btn-neutral float-right" title="Multidimensional VRT" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="vicar.html" class="btn btn-neutral float-left" title="VICAR -- VICAR" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <div class="info">
      <a class="logo-link" href="https://osgeo.org">
        <div class="osgeo-logo"></div>
      </a>
      <div class="copyright">
      

      &copy; 1998-2024 <a href="https://github.com/warmerdam">Frank Warmerdam</a>,
      <a href="https://github.com/rouault">Even Rouault</a>, and
      <a href="https://github.com/OSGeo/gdal/graphs/contributors">others</a>


      
      </div>
    </div>
  </div>
</footer>
        </div>
      </div>
    </section>
  </div>
  
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>