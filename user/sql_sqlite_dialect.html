<!DOCTYPE html>
<html class="writer-html5" lang="ja" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SQL SQLite方言 &mdash; GDAL  ドキュメント</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d10597a4" />
      <link rel="stylesheet" type="text/css" href="../_static/css/gdal.css?v=e152ac3b" />

  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="canonical" href="https://gdal.org/user/sql_sqlite_dialect.html"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=c033477b"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/translations.js?v=91613774"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="このドキュメントについて" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="GDAL Virtual File Systems (compressed, network hosted, etc...): /vsimem, /vsizip, /vsitar, /vsicurl, ..." href="virtual_file_systems.html" />
    <link rel="prev" title="OGR SQL 方言" href="ogr_sql_dialect.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../index.html">
            
              <img src="../_static/gdalicon.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../download.html">ダウンロード</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programs/index.html">プログラム</a></li>
<li class="toctree-l1"><a class="reference internal" href="../drivers/raster/index.html">ラスタードライバー</a></li>
<li class="toctree-l1"><a class="reference internal" href="../drivers/vector/index.html">ベクタードライバー</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ユーザー</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="raster_data_model.html">ラスターデータモデル</a></li>
<li class="toctree-l2"><a class="reference internal" href="multidim_raster_data_model.html">多次元ラスターデータモデル</a></li>
<li class="toctree-l2"><a class="reference internal" href="vector_data_model.html">ベクターデーターモデル</a></li>
<li class="toctree-l2"><a class="reference internal" href="gnm_data_model.html">地理ネットワークデータモデル</a></li>
<li class="toctree-l2"><a class="reference internal" href="multithreading.html">マルチスレッディング</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="ogr_sql_sqlite_dialect.html">OGR SQL方言とSQLITE SQL方言</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="ogr_sql_sqlite_dialect.html#dialects">方言</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="ogr_sql_dialect.html">OGR SQL 方言</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">SQL SQLite方言</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ogr_sql_sqlite_dialect.html#executesql">ExecuteSQL()</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="virtual_file_systems.html">GDAL仮想ファイルシステム</a></li>
<li class="toctree-l2"><a class="reference internal" href="ogr_feature_style.html">Feature Style Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="coordinate_epoch.html">Coordinate epoch support</a></li>
<li class="toctree-l2"><a class="reference internal" href="configoptions.html">Configuration options</a></li>
<li class="toctree-l2"><a class="reference internal" href="gdal_python_utilities.html">GDAL Python Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">チュートリアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">開発</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community/index.html">コミュニティ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sponsors/index.html">スポンサー</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">どのように貢献できますか?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">ライセンス</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GDAL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html"> GDAL  ドキュメント </a> &raquo;</li>
      
          <li><a href="index.html">ユーザー向けドキュメント</a> &raquo;</li>
      
          <li><a href="ogr_sql_sqlite_dialect.html">OGR SQL方言とSQLITE SQL方言</a> &raquo;</li>
      
      <li>SQL SQLite方言</li>
    

    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/OSGeo/gdal/edit/master/doc/source/user/sql_sqlite_dialect.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="virtual_file_systems.html" class="btn btn-neutral float-right" title="GDAL Virtual File Systems (compressed, network hosted, etc...): /vsimem, /vsizip, /vsitar, /vsicurl, ..." accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ogr_sql_dialect.html" class="btn btn-neutral float-left" title="OGR SQL 方言" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sql-sqlite-dialect">
<span id="id1"></span><h1>SQL SQLite方言<a class="headerlink" href="#sql-sqlite-dialect" title="Link to this heading"></a></h1>
<p><code class="docutils literal notranslate"><span class="pre">SQLite</span></code> 方言は <a class="reference internal" href="ogr_sql_dialect.html#ogr-sql-dialect"><span class="std std-ref">OGR SQL 方言</span></a> の代替SQL方言として使用できます. これは, GDAL/OGRがSQLiteのサポートをビルドされていることを前提としています. 空間関数を利用するためには, <a class="reference external" href="https://www.gaia-gis.it/fossil/libspatialite/index">Spatialite</a> のサポートも望ましいです.</p>
<p>SQLite方言はOGR SQL方言と同様に, 任意のOGRデータソースで使用できます. <code class="docutils literal notranslate"><span class="pre">SQLite</span></code> 方言は, <a class="reference internal" href="../api/gdaldataset_cpp.html#_CPPv4N11GDALDataset10ExecuteSQLEPKcP11OGRGeometryPKc" title="GDALDataset::ExecuteSQL"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALDataset::ExecuteSQL()</span></code></a> の方言パラメータとして <code class="docutils literal notranslate"><span class="pre">SQLite</span></code> 文字列を渡すか, <a class="reference internal" href="../programs/ogrinfo.html#ogrinfo"><span class="std std-ref">ogrinfo</span></a> や <a class="reference internal" href="../programs/ogr2ogr.html#ogr2ogr"><span class="std std-ref">ogr2ogr</span></a> ユーティリティの <cite>-dialect</cite> オプションでリクエストできます.</p>
<p>これは主にSELECT文を実行するために使用されますが, 更新をサポートするデータソースの場合, INSERT/UPDATE/DELETE文も実行できます. GDALは内部的に <a class="reference external" href="https://sqlite.org/vtab.html">SQLiteの仮想テーブルメカニズム</a> を使用しているため, ALTER TABLEのような操作はサポートされていません. ALTER TABLEやDROP TABLEを実行するには, <a class="reference internal" href="ogr_sql_dialect.html#ogr-sql-dialect"><span class="std std-ref">OGR SQL 方言</span></a> を使用してください.</p>
<p>データソースがSQLiteデータベース(GeoPackage, SpatiaLite)の場合, SQLite方言はネイティブSQL方言として機能し, 仮想テーブルメカニズムは使用されません. この場合でも, &quot;-dialect INDIRECT_SQLITE&quot; を指定することでGDALに仮想テーブルを使用させることができます. これは必要な場合にのみ使用するべきです. 仮想テーブルメカニズムを経由するとパフォーマンスに影響する可能性があるためです.</p>
<p>SQLステートメントの構文は完全にSQLite SQLエンジンのものです. 以下のページを参照してください:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.sqlite.org/lang_select.html">SELECT</a></p></li>
<li><p><a class="reference external" href="http://www.sqlite.org/lang_insert.html">INSERT</a></p></li>
<li><p><a class="reference external" href="http://www.sqlite.org/lang_update.html">UPDATE</a></p></li>
<li><p><a class="reference external" href="http://www.sqlite.org/lang_delete.html">DELETE</a></p></li>
</ul>
<section id="select-statement">
<h2>SELECT文<a class="headerlink" href="#select-statement" title="Link to this heading"></a></h2>
<p>SELECT文は, レイヤーの地物(データベースのテーブル行に類似)を取得するために使用されます. クエリの結果は地物の一時レイヤーとして表されます. データソースのレイヤーはデータベースのテーブルに類似し, 地物の属性は列の値に類似します. OGR SQLITE SELECT文の最も単純な形式は次のようになります:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">polylayer</span>
</pre></div>
</div>
<p>WHERE, JOIN, USING, GROUP BY, ORDER BY, sub SELECTなどを含むより複雑なステートメントを使用することもできます.</p>
<p>使用できるテーブル名は, ExecuteSQL()メソッドが呼び出されるデータソースで利用可能なレイヤー名です.</p>
<p>OGRSQLと同様に, 他のデータソースのレイヤーを参照することも可能です. 次の構文を使用します: &quot;other_datasource_name&quot;.&quot;layer_name&quot;.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">NAME</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">poly</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="ss">&quot;idlink.dbf&quot;</span><span class="p">.</span><span class="ss">&quot;idlink&quot;</span><span class="w"> </span><span class="n">il</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="p">(</span><span class="n">eas_id</span><span class="p">)</span>
</pre></div>
</div>
<p>マスターデータソースがSQLiteデータベース(GeoPackage, SpatiaLite)の場合, 間接的なSQLite方言を使用する必要があります. そうでない場合, 追加のデータソースは決して開かれませんが, 結合に使用されるテーブルはマスターデータベースから検索されます.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ogrinfo<span class="w"> </span>jointest.gpkg<span class="w"> </span>-dialect<span class="w"> </span>INDIRECT_SQLITE<span class="w"> </span>-sql<span class="w"> </span><span class="se">\</span>
<span class="s2">&quot;SELECT a.ID,b.ID FROM jointest a JOIN \&quot;jointest2.shp\&quot;.\&quot;jointest2\&quot; b ON a.ID=b.ID&quot;</span>
</pre></div>
</div>
<p>結果の列リスト, WHERE, JOINなどの句で使用できる列名は, レイヤーのフィールド名です. 式, SQLite関数, 空間関数なども使用できます.</p>
<p>WHERE句やJOIN句でフィールドに対する条件が表現されると, できる限り, それらは基になるOGRレイヤーに適用される属性フィルタとして変換されます. キーフィールドにインデックスがない場合, JOINは非常に重い操作になる可能性があります.</p>
<section id="like-operator">
<h3>LIKE演算子<a class="headerlink" href="#like-operator" title="Link to this heading"></a></h3>
<p>SQLiteでは, LIKE演算子は大文字小文字を区別しません. <code class="docutils literal notranslate"><span class="pre">PRAGMA</span> <span class="pre">case_sensitive_like</span> <span class="pre">=</span> <span class="pre">1</span></code> が発行されていない限りです.</p>
<p>GDAL 3.9以降, GDALはUTF-8文字を <code class="docutils literal notranslate"><span class="pre">LIKE</span></code> および <code class="docutils literal notranslate"><span class="pre">ILIKE</span></code> 演算子で考慮するカスタムLIKE比較をインストールします. ILIKEの大文字小文字を区別しない比較の場合, これは <a class="reference external" href="https://en.wikipedia.org/wiki/Basic_Latin_(Unicode_block)">ASCII</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Latin-1_Supplement_(Unicode_block)">Latin-1 Supplement</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Latin_Extended-A">Latin Extended-A</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Latin_Extended-B">Latin Extended-B</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Greek_and_Coptic">Greek and Coptic</a> および <a class="reference external" href="https://en.wikipedia.org/wiki/Greek_and_Coptic">Cyrillic</a> Unicodeカテゴリに制限されます.</p>
</section>
<section id="delimited-identifiers">
<h3>デリミテッド識別子<a class="headerlink" href="#delimited-identifiers" title="Link to this heading"></a></h3>
<p>レイヤーや属性の名前がSQLの予約キーワードである場合(例: 'FROM')や, 数字やアンダースコアで始まる場合, クエリで &quot;デリミテッド識別子&quot; として扱われ, ダブルクォーテーションで囲まれます. ダブルクォーテーションは, 厳密に必要でない場合でも使用できます.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="ss">&quot;p&quot;</span><span class="p">.</span><span class="ss">&quot;geometry&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;p&quot;</span><span class="p">.</span><span class="ss">&quot;FROM&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;p&quot;</span><span class="p">.</span><span class="ss">&quot;3D&quot;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;poly&quot;</span><span class="w"> </span><span class="n">p</span>
</pre></div>
</div>
<p>SQLステートメントがコマンドシェルで使用され, ステートメント自体がダブルクォーテーションで囲まれている場合, 内部のダブルクォーテーションは \ でエスケープする必要があります.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ogrinfo<span class="w"> </span>p.shp<span class="w"> </span>-sql<span class="w"> </span><span class="s2">&quot;SELECT geometry \&quot;FROM\&quot;, \&quot;3D\&quot; FROM p&quot;</span>
</pre></div>
</div>
</section>
<section id="geometry-field">
<h3>ジオメトリフィールド<a class="headerlink" href="#geometry-field" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">GEOMETRY</span></code> 特殊フィールドは, OGRFeature::GetGeometryRef() によって返される地物のジオメトリを表します. SELECTの結果列リストで明示的に指定することができ, * ワイルドカードが使用されると自動的に選択されます.</p>
<p>一般的にRDBMSデータソースの場合, OGRLayer::GetGeometryColumn() によって返されるジオメトリ列名が空でないOGRレイヤーに対して, SQLステートメントのジオメトリ特殊フィールドの名前は, 基になるOGRレイヤーのジオメトリ列の名前になります. ソースレイヤーのジオメトリ列の名前が空の場合, shapefileなどの場合, SQLステートメントで使用する名前は常に &quot;geometry&quot; です. ここでは, 大文字小文字を区別せずに使用します(すべてのフィールド名がSELECTステートメントであるため):</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">EAS_ID</span><span class="p">,</span><span class="w"> </span><span class="n">GEOMETRY</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">poly</span>
</pre></div>
</div>
<p>リターン:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">OGRFeature</span><span class="p">(</span><span class="k">SELECT</span><span class="p">):</span><span class="mi">0</span>
<span class="n">EAS_ID</span><span class="w"> </span><span class="p">(</span><span class="nb">Real</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">168</span>
<span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">479819</span><span class="p">.</span><span class="mi">84375</span><span class="w"> </span><span class="mi">4765180</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">479690</span><span class="p">.</span><span class="mi">1875</span><span class="w"> </span><span class="mi">4765259</span><span class="p">.</span><span class="mi">5</span><span class="p">,[...],</span><span class="mi">479819</span><span class="p">.</span><span class="mi">84375</span><span class="w"> </span><span class="mi">4765180</span><span class="p">.</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">poly</span>
</pre></div>
</div>
<p>リターン:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">OGRFeature</span><span class="p">(</span><span class="k">SELECT</span><span class="p">):</span><span class="mi">0</span>
<span class="n">AREA</span><span class="w"> </span><span class="p">(</span><span class="nb">Real</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">215229</span><span class="p">.</span><span class="mi">266</span>
<span class="n">EAS_ID</span><span class="w"> </span><span class="p">(</span><span class="nb">Real</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">168</span>
<span class="n">PRFEDEA</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">35043411</span>
<span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">479819</span><span class="p">.</span><span class="mi">84375</span><span class="w"> </span><span class="mi">4765180</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">479690</span><span class="p">.</span><span class="mi">1875</span><span class="w"> </span><span class="mi">4765259</span><span class="p">.</span><span class="mi">5</span><span class="p">,[...],</span><span class="mi">479819</span><span class="p">.</span><span class="mi">84375</span><span class="w"> </span><span class="mi">4765180</span><span class="p">.</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="feature-id-fid">
<h3>地物ID (FID)<a class="headerlink" href="#feature-id-fid" title="Link to this heading"></a></h3>
<p>地物IDは地物の特別なプロパティであり, 地物の属性として扱われません. 場合によっては, 地物IDをクエリや結果セットで通常のフィールドとして利用できると便利です. その場合は <code class="docutils literal notranslate"><span class="pre">rowid</span></code> という名前を使用します.</p>
<p>GDAL 3.8以降, レイヤーに名前付きFID列がある場合 (<a class="reference internal" href="../api/ogrlayer_cpp.html#_CPPv4N8OGRLayer12GetFIDColumnEv" title="OGRLayer::GetFIDColumn"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">OGRLayer::GetFIDColumn()</span></code></a> != &quot;&quot;), この名前も使用できます.</p>
<p>フィールドワイルドカードの展開には地物IDは含まれませんが, 次のような構文を使用して明示的に含めることができます:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">ROWID</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nation</span>
</pre></div>
</div>
<p>フィールドワイルドカードの展開には地物IDは含まれませんが, 次のような構文を使用して明示的に含めることができます:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rowid</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nation</span>
</pre></div>
</div>
<p>これの名前を変更することも可能です:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rowid</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">fid</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nation</span>
</pre></div>
</div>
</section>
<section id="ogr-style-special-field">
<h3>OGR_STYLE特殊フィールド<a class="headerlink" href="#ogr-style-special-field" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">OGR_STYLE</span></code> 特殊フィールドは, OGRFeature::GetStyleString() によって返される地物のスタイル文字列を表します. このフィールドと <code class="docutils literal notranslate"><span class="pre">LIKE</span></code> 演算子を使用することで, クエリの結果をスタイルでフィルタリングすることができます. 例えば, アノテーション地物を選択することができます:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nation</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">OGR_STYLE</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;LABEL%&#39;</span>
</pre></div>
</div>
</section>
<section id="statistics-functions">
<h3>統計関数<a class="headerlink" href="#statistics-functions" title="Link to this heading"></a></h3>
<p>標準の COUNT(), SUM(), AVG(), MIN(), MAX() に加えて, 次の集計関数が利用可能です:</p>
<ul class="simple">
<li><p>STDDEV_POP: (GDAL &gt;= 3.10) 数値の母集団標準偏差.</p></li>
<li><p>STDDEV_SAMP: (GDAL &gt;= 3.10) 数値の <a class="reference external" href="https://en.wikipedia.org/wiki/Standard_deviation#Sample_standard_deviation">標本標準偏差</a></p></li>
</ul>
</section>
<section id="spatialite-sql-functions">
<h3>Spatialite SQL関数<a class="headerlink" href="#spatialite-sql-functions" title="Link to this heading"></a></h3>
<p>GDAL/OGRが <a class="reference external" href="https://www.gaia-gis.it/fossil/libspatialite/index">Spatialite</a> ライブラリのサポートでビルドされている場合, 多くの <a class="reference external" href="http://www.gaia-gis.it/gaia-sins/spatialite-sql-latest.html">追加のSQL関数</a> が利用可能になります. 特に空間関数は, 結果の列フィールド, WHERE句などで使用できます.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">EAS_ID</span><span class="p">,</span><span class="w"> </span><span class="n">ST_Area</span><span class="p">(</span><span class="n">GEOMETRY</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">area</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">poly</span><span class="w"> </span><span class="k">WHERE</span>
<span class="w">    </span><span class="n">ST_Intersects</span><span class="p">(</span><span class="n">GEOMETRY</span><span class="p">,</span><span class="w"> </span><span class="n">BuildCircleMbr</span><span class="p">(</span><span class="mi">479750</span><span class="p">.</span><span class="mi">6875</span><span class="p">,</span><span class="mi">4764702</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
<p>リターン:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">OGRFeature</span><span class="p">(</span><span class="k">SELECT</span><span class="p">):</span><span class="mi">0</span>
<span class="n">EAS_ID</span><span class="w"> </span><span class="p">(</span><span class="nb">Real</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">169</span>
<span class="n">area</span><span class="w"> </span><span class="p">(</span><span class="nb">Real</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">101429</span><span class="p">.</span><span class="mi">9765625</span>

<span class="n">OGRFeature</span><span class="p">(</span><span class="k">SELECT</span><span class="p">):</span><span class="mi">1</span>
<span class="n">EAS_ID</span><span class="w"> </span><span class="p">(</span><span class="nb">Real</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">165</span>
<span class="n">area</span><span class="w"> </span><span class="p">(</span><span class="nb">Real</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">596610</span><span class="p">.</span><span class="mi">3359375</span>

<span class="n">OGRFeature</span><span class="p">(</span><span class="k">SELECT</span><span class="p">):</span><span class="mi">2</span>
<span class="n">EAS_ID</span><span class="w"> </span><span class="p">(</span><span class="nb">Real</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">170</span>
<span class="n">area</span><span class="w"> </span><span class="p">(</span><span class="nb">Real</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5268</span><span class="p">.</span><span class="mi">8125</span>
</pre></div>
</div>
<p>SQLiteの緩い型付けメカニズムのため, ジオメトリ式が最初の行でNULL値を返すと, 一般的にOGRはその列をジオメトリ列として認識しません. そのため, 非NULLジオメトリが最初に返されるように結果をソートすることが役立つ場合があります:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">ogrinfo</span><span class="w"> </span><span class="n">test</span><span class="p">.</span><span class="n">shp</span><span class="w"> </span><span class="o">-</span><span class="k">sql</span><span class="w"> </span><span class="ss">&quot;SELECT * FROM (SELECT ST_Buffer(geometry,5) AS geometry FROM test) ORDER BY geometry IS NULL ASC&quot;</span><span class="w"> </span><span class="o">-</span><span class="n">dialect</span><span class="w"> </span><span class="n">sqlite</span>
</pre></div>
</div>
</section>
<section id="ogr-datasource-sql-functions">
<h3>OGRデータソースSQL関数<a class="headerlink" href="#ogr-datasource-sql-functions" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ogr_datasource_load_layers(datasource_name[,</span> <span class="pre">update_mode[,</span> <span class="pre">prefix]])</span></code> 関数は, データソースのすべてのレイヤーを <a class="reference internal" href="../drivers/vector/sqlite.html#vector-sqlite"><span class="std std-ref">VirtualOGR tables</span></a> として自動的にロードするために使用できます.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">sqlite</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">load_extension</span><span class="p">(</span><span class="s1">&#39;libgdal.so&#39;</span><span class="p">);</span>

<span class="n">sqlite</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">load_extension</span><span class="p">(</span><span class="s1">&#39;mod_spatialite&#39;</span><span class="p">);</span>

<span class="n">sqlite</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">ogr_datasource_load_layers</span><span class="p">(</span><span class="s1">&#39;poly.shp&#39;</span><span class="p">);</span>
<span class="mi">1</span>
<span class="n">sqlite</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">sqlite_master</span><span class="p">;</span>
<span class="k">table</span><span class="o">|</span><span class="n">poly</span><span class="o">|</span><span class="n">poly</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="k">CREATE</span><span class="w"> </span><span class="n">VIRTUAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;poly&quot;</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">VirtualOGR</span><span class="p">(</span><span class="s1">&#39;poly.shp&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;poly&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="ogr-layer-sql-functions">
<h3>OGRレイヤーSQL関数<a class="headerlink" href="#ogr-layer-sql-functions" title="Link to this heading"></a></h3>
<p>次のSQL関数が利用可能で, レイヤー名に対して動作します: <code class="docutils literal notranslate"><span class="pre">ogr_layer_Extent()</span></code>, <code class="docutils literal notranslate"><span class="pre">ogr_layer_SRID()</span></code>, <code class="docutils literal notranslate"><span class="pre">ogr_layer_GeometryType()</span></code> および <code class="docutils literal notranslate"><span class="pre">ogr_layer_FeatureCount()</span></code></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">ogr_layer_Extent</span><span class="p">(</span><span class="s1">&#39;poly&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">ogr_layer_SRID</span><span class="p">(</span><span class="s1">&#39;poly&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">srid</span><span class="p">,</span>
<span class="w">    </span><span class="n">ogr_layer_GeometryType</span><span class="p">(</span><span class="s1">&#39;poly&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">geomtype</span><span class="p">,</span><span class="w"> </span><span class="n">ogr_layer_FeatureCount</span><span class="p">(</span><span class="s1">&#39;poly&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">count</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">OGRFeature</span><span class="p">(</span><span class="k">SELECT</span><span class="p">):</span><span class="mi">0</span>
<span class="n">srid</span><span class="w"> </span><span class="p">(</span><span class="nb">Integer</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">40004</span>
<span class="n">geomtype</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">POLYGON</span>
<span class="k">count</span><span class="w"> </span><span class="p">(</span><span class="nb">Integer</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
<span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">478315</span><span class="p">.</span><span class="mi">53125</span><span class="w"> </span><span class="mi">4762880</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">481645</span><span class="p">.</span><span class="mi">3125</span><span class="w"> </span><span class="mi">4762880</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">481645</span><span class="p">.</span><span class="mi">3125</span><span class="w"> </span><span class="mi">4765610</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">478315</span><span class="p">.</span><span class="mi">53125</span><span class="w"> </span><span class="mi">4765610</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">478315</span><span class="p">.</span><span class="mi">53125</span><span class="w"> </span><span class="mi">4762880</span><span class="p">.</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="ogr-compression-functions">
<h3>OGR圧縮関数<a class="headerlink" href="#ogr-compression-functions" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ogr_deflate(text_or_blob[,</span> <span class="pre">compression_level])</span></code> は, ZLib deflateアルゴリズムで圧縮されたバイナリblobを返します. <a class="reference internal" href="../api/cpl.html#_CPPv414CPLZLibDeflatePKv6size_tiPv6size_tP6size_t" title="CPLZLibDeflate"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">CPLZLibDeflate()</span></code></a> を参照してください.</p>
<p><code class="docutils literal notranslate"><span class="pre">ogr_inflate(compressed_blob)</span></code> は, ZLib deflateアルゴリズムで圧縮されたblobから解凍されたバイナリblobを返します. 解凍されたバイナリが文字列の場合, CAST(ogr_inflate(compressed_blob) AS VARCHAR) を使用してください. CPLZLibInflate() を参照してください.</p>
</section>
<section id="other-functions">
<h3>その他の関数<a class="headerlink" href="#other-functions" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">hstore_get_value()</span></code> 関数は, &quot;key=&gt;value,other_key=&gt;other_value,...&quot; のようにフォーマットされたHSTORE文字列からキーに関連付けられた値を抽出するために使用できます.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">hstore_get_value</span><span class="p">(</span><span class="s1">&#39;a =&gt; b, &quot;key with space&quot;=&gt; &quot;value with space&quot;&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;key with space&#39;</span><span class="p">)</span><span class="w"> </span><span class="c1">--&gt; &#39;value with space&#39;</span>
</pre></div>
</div>
</section>
<section id="raster-related-functions">
<span id="sql-sqlite-dialect-raster-functions"></span><h3>ラスタ関連関数<a class="headerlink" href="#raster-related-functions" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">gdal_get_pixel_value()</span></code> 関数 (GDAL 3.7で追加) は, GDALデータセットのピクセルの値を抽出するために使用できます. セキュリティ上の理由から, OGR_SQLITE_ALLOW_EXTERNAL_ACCESS設定オプションをYESに設定する必要があります.</p>
<p>5または6つの引数が必要です:</p>
<ul class="simple">
<li><p>データセット名の文字列</p></li>
<li><p>バンド番号 (1から始まる番号)</p></li>
<li><p>後続の値がジオリファレンス座標であることを示す &quot;georef&quot; または, 後続の値が列, 行ピクセル空間であることを示す &quot;pixel&quot; である文字列</p></li>
<li><p>ジオリファレンスされたX値または列番号</p></li>
<li><p>ジオリファレンスされたY値または行番号</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nearest</span></code> (デフォルト), <code class="docutils literal notranslate"><span class="pre">bilinear</span></code>, <code class="docutils literal notranslate"><span class="pre">cubic</span></code>, <code class="docutils literal notranslate"><span class="pre">cubicspline</span></code> の中からのリサンプリング方法. オプション指定, GDAL 3.10で追加</p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">gdal_get_pixel_value</span><span class="p">(</span><span class="s1">&#39;../gcore/data/byte.tif&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;georef&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">440720</span><span class="p">,</span><span class="w"> </span><span class="mi">3751320</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">gdal_get_pixel_value</span><span class="p">(</span><span class="s1">&#39;../gcore/data/byte.tif&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;pixel&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">gdal_get_pixel_value</span><span class="p">(</span><span class="s1">&#39;../gcore/data/byte.tif&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;pixel&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;bilinear&#39;</span><span class="p">)</span><span class="w">  </span><span class="c1">-- GDAL &gt;= 3.10</span>
</pre></div>
</div>
</section>
<section id="ogr-geocoding-functions">
<h3>OGRジオコーディング関数<a class="headerlink" href="#ogr-geocoding-functions" title="Link to this heading"></a></h3>
<p>次のSQL関数が利用可能です: <code class="docutils literal notranslate"><span class="pre">ogr_geocode(...)</span></code> および <code class="docutils literal notranslate"><span class="pre">ogr_geocode_reverse(...)</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">ogr_geocode(name_to_geocode</span> <span class="pre">[,</span> <span class="pre">field_to_return</span> <span class="pre">[,</span> <span class="pre">option1</span> <span class="pre">[,</span> <span class="pre">option2,</span> <span class="pre">...]]])</span></code> where
name_to_geocode is a literal or a column name that must be geocoded. field_to_return if specified can be &quot;geometry&quot; for
the geometry (default), or a field name of the layer returned by <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">OGRGeocode()</span></code>. The special field  &quot;raw&quot; can also be used
to return the raw response (XML string) of the geocoding service.
option1, option2, etc.. must be of the key=value format, and are options understood
by <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">OGRGeocodeCreateSession()</span></code> or OGRGeocode().</p>
<p>この関数は内部的にOGRGeocode() APIを使用しています. 詳細については, それを参照してください.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">ST_Centroid</span><span class="p">(</span><span class="n">ogr_geocode</span><span class="p">(</span><span class="s1">&#39;Paris&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>リターン:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">OGRFeature</span><span class="p">(</span><span class="k">SELECT</span><span class="p">):</span><span class="mi">0</span>
<span class="n">POINT</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">.</span><span class="mi">34287687375113</span><span class="w"> </span><span class="mi">48</span><span class="p">.</span><span class="mi">856622357411</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ogrinfo<span class="w"> </span>cities.csv<span class="w"> </span>-dialect<span class="w"> </span>sqlite<span class="w"> </span>-sql<span class="w"> </span><span class="s2">&quot;SELECT *, ogr_geocode(city, &#39;country_code&#39;) AS country_code, ST_Centroid(ogr_geocode(city)) FROM cities&quot;</span>
</pre></div>
</div>
<p>リターン:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OGRFeature(SELECT):0
  city (String) = Paris
  country_code (String) = fr
  POINT (2.34287687375113 48.856622357411)

OGRFeature(SELECT):1
  city (String) = London
  country_code (String) = gb
  POINT (-0.109415723431508 51.5004964757441)

OGRFeature(SELECT):2
  city (String) = Rennes
  country_code (String) = fr
  POINT (-1.68185479486048 48.1116771631195)

OGRFeature(SELECT):3
  city (String) = New York
  country_code (String) = us
  POINT (-73.9388908443975 40.6632061220125)

OGRFeature(SELECT):4
  city (String) = Beijing
  country_code (String) = cn
  POINT (116.3912972 39.9057136)
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ogr_geocode_reverse(longitude,</span> <span class="pre">latitude,</span> <span class="pre">field_to_return</span> <span class="pre">[,</span> <span class="pre">option1</span> <span class="pre">[,</span> <span class="pre">option2,</span> <span class="pre">...]])</span></code> は, longitude, latitude がクエリする座標です. field_to_return は, OGRGeocodeReverse() によって返されるレイヤーのフィールド名である必要があります (例: 'display_name'). ジオコーディングサービスの生の応答(XML文字列)を返すために, 特別なフィールド &quot;raw&quot; も使用できます. option1, option2などは, key=value形式である必要があり, OGRGeocodeCreateSession() または OGRGeocodeReverse() で理解されるオプションです.</p>
<p><code class="docutils literal notranslate"><span class="pre">ogr_geocode_reverse(geometry,</span> <span class="pre">field_to_return</span> <span class="pre">[,</span> <span class="pre">option1</span> <span class="pre">[,</span> <span class="pre">option2,</span> <span class="pre">...]])</span></code> は, geometryが(Spatialite)ポイントジオメトリである場合の代替構文としても受け入れられます.</p>
<p>この関数は内部的に <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">OGRGeocodeReverse()</span></code> API を使用しています. 詳細については, それを参照してください.</p>
</section>
<section id="spatialite-spatial-index">
<h3>Spatialite空間インデックス<a class="headerlink" href="#spatialite-spatial-index" title="Link to this heading"></a></h3>
<p>Spatialite空間インデックスメカニズムは, SQLに空間インデックス仮想テーブルが言及されていることを確認するか, より新しいVirtualSpatialIndex拡張機能を使用することでトリガーされます. この場合, 空間クエリの高速化に使用するために, メモリ内のRTreeが構築されます.</p>
<p>例えば, 1つのレイヤーに空間インデックスを使用して実際のジオメトリ交差計算の数を制限することで, 2つのレイヤー間の空間交差を行う:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">city_name</span><span class="p">,</span><span class="w"> </span><span class="n">region_name</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">cities</span><span class="p">,</span><span class="w"> </span><span class="n">regions</span><span class="w"> </span><span class="k">WHERE</span>
<span class="w">    </span><span class="n">ST_Area</span><span class="p">(</span><span class="n">ST_Intersection</span><span class="p">(</span><span class="n">cities</span><span class="p">.</span><span class="n">geometry</span><span class="p">,</span><span class="w"> </span><span class="n">regions</span><span class="p">.</span><span class="n">geometry</span><span class="p">))</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span>
<span class="w">    </span><span class="n">regions</span><span class="p">.</span><span class="n">rowid</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">pkid</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">idx_regions_geometry</span><span class="w"> </span><span class="k">WHERE</span>
<span class="w">            </span><span class="n">xmax</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">MbrMinX</span><span class="p">(</span><span class="n">cities</span><span class="p">.</span><span class="n">geometry</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">xmin</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">MbrMaxX</span><span class="p">(</span><span class="n">cities</span><span class="p">.</span><span class="n">geometry</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span>
<span class="w">            </span><span class="n">ymax</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">MbrMinY</span><span class="p">(</span><span class="n">cities</span><span class="p">.</span><span class="n">geometry</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">ymin</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">MbrMaxY</span><span class="p">(</span><span class="n">cities</span><span class="p">.</span><span class="n">geometry</span><span class="p">))</span>
</pre></div>
</div>
<p>またはよりエレガントな方法:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">city_name</span><span class="p">,</span><span class="w"> </span><span class="n">region_name</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">cities</span><span class="p">,</span><span class="w"> </span><span class="n">regions</span><span class="w"> </span><span class="k">WHERE</span>
<span class="w">    </span><span class="n">ST_Area</span><span class="p">(</span><span class="n">ST_Intersection</span><span class="p">(</span><span class="n">cities</span><span class="p">.</span><span class="n">geometry</span><span class="p">,</span><span class="w"> </span><span class="n">regions</span><span class="p">.</span><span class="n">geometry</span><span class="p">))</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span>
<span class="w">    </span><span class="n">regions</span><span class="p">.</span><span class="n">rowid</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rowid</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">SpatialIndex</span><span class="w"> </span><span class="k">WHERE</span>
<span class="w">            </span><span class="n">f_table_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;regions&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">search_frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cities</span><span class="p">.</span><span class="n">geometry</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="virtual_file_systems.html" class="btn btn-neutral float-right" title="GDAL Virtual File Systems (compressed, network hosted, etc...): /vsimem, /vsizip, /vsitar, /vsicurl, ..." accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ogr_sql_dialect.html" class="btn btn-neutral float-left" title="OGR SQL 方言" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <div class="info">
      <a class="logo-link" href="https://osgeo.org">
        <div class="osgeo-logo"></div>
      </a>
      <div class="copyright">
      

      &copy; 1998-2024 <a href="https://github.com/warmerdam">Frank Warmerdam</a>,
      <a href="https://github.com/rouault">Even Rouault</a>, and
      <a href="https://github.com/OSGeo/gdal/graphs/contributors">others</a>


      
      </div>
    </div>
  </div>
</footer>
        </div>
      </div>
    </section>
  </div>
  
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>